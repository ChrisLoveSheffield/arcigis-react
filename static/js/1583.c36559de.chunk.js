"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[1583],{42388:function(e,t,r){r.d(t,{j:function(){return y}});var n=r(15671),i=r(43144),a=r(60136),s=r(29388),o=r(27366),u=r(85015),c=r(41691),h=r(49861),l=(r(63780),r(93169),r(25243),r(69912)),f={visible:"visibleSublayers"},y=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).scale=0,i}return(0,i.Z)(r,[{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(f[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join(",")}},{key:"version",get:function(){this.commitProperty("layers");var e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this.layer,t=this.scale,r=null===e||void 0===e?void 0:e.sublayers,n=[];return null!==r&&void 0!==r&&r.forEach((function e(r){var i=r.minScale,a=r.maxScale,s=r.sublayers;r.visible&&(0===t||(0===i||t<=i)&&(0===a||t>=a))&&(s?s.forEach(e):n.unshift(r))})),n}},{key:"toJSON",value:function(){var e=this.layer,t=this.layers;return{format:e.imageFormat,request:"GetMap",service:"WMS",styles:"",transparent:e.imageTransparency?"TRUE":"FALSE",version:e.version,layers:t}}}]),r}((0,c.p)(u.Z));(0,o._)([(0,h.Cb)()],y.prototype,"layer",null),(0,o._)([(0,h.Cb)({readOnly:!0})],y.prototype,"layers",null),(0,o._)([(0,h.Cb)({type:Number})],y.prototype,"scale",void 0),(0,o._)([(0,h.Cb)({readOnly:!0})],y.prototype,"version",null),(0,o._)([(0,h.Cb)({readOnly:!0})],y.prototype,"visibleSublayers",null),y=(0,o._)([(0,l.j)("esri.layers.support.ExportWMSImageParameters")],y)},64510:function(e,t,r){r.d(t,{Z:function(){return N}});var n=r(37762),i=r(15671),a=r(43144),s=r(11752),o=r(61120),u=r(60136),c=r(29388),h=(r(93169),r(92026)),l=r(23588),f=r(53628),y=r(33624),p=r(29439),v=r(10064),d=r(32718),m=r(94172),g=r(87422),_=r(4942),x=r(1413),w=r(79347),Z=r(88396),k=r(6394),b=r(83406),I=r(80457),S=r(73271),P=r(44070),C=r(8548),U=d.Z.getLogger("esri.views.2d.engine.webgl.Mesh2D"),E=function(e,t,r,n){for(var i=0,a=1;a<r;a++){var s=e[2*(t+a-1)],o=e[2*(t+a-1)+1];i+=(e[2*(t+a)]-s)*(e[2*(t+a)+1]+o)}return n?i>0:i<0},R=function(e,t){for(var r=e.coords,i=e.lengths,a=[],s=0,o=0;s<i.length;o+=i[s],s+=1){for(var u=o,c=[];s<i.length-1&&E(r,o+i[s],i[s+1],t);o+=i[s+=1])c.push(o+i[s]-u);var h,l=r.slice(2*u,2*(o+i[s])),f=(0,w.e)(l,c,2),y=(0,n.Z)(f);try{for(y.s();!(h=y.n()).done;){var p=h.value;a.push(p+u)}}catch(v){y.e(v)}finally{y.f()}}return a},M=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,i.Z)(this,e),this._cache={},this.vertices=t,this.indices=r,this.primitiveType=n,this.isMapSpace=a}return(0,a.Z)(e,[{key:"destroy",value:function(){for(var e in(0,h.pC)(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose(),this._cache.vertexBuffers)(0,h.pC)(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}},{key:"elementType",get:function(){return function(e){switch(e.BYTES_PER_ELEMENT){case 1:return C.g.UNSIGNED_BYTE;case 2:return C.g.UNSIGNED_SHORT;case 4:return C.g.UNSIGNED_INT;default:throw new v.Z("Cannot get DataType of array")}}(this.indices)}},{key:"getIndexBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C.l1.STATIC_DRAW;return this._cache.indexBuffer||(this._cache.indexBuffer=P.f.createIndex(e,t,this.indices)),this._cache.indexBuffer}},{key:"getVertexBuffers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C.l1.STATIC_DRAW;return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((function(n,i){return(0,x.Z)((0,x.Z)({},n),{},(0,_.Z)({},i,P.f.createVertex(e,r,t.vertices[i])))}),{})),this._cache.vertexBuffers}}],[{key:"fromRect",value:function(t){var r=t.x,n=t.y,i=r+t.width,a=n+t.height;return e.fromScreenExtent({xmin:r,ymin:n,xmax:i,ymax:a})}},{key:"fromPath",value:function(t){for(var r=(0,b.ks)(new I.Z,t.path,!1,!1),n=r.coords,i=new Uint32Array(R(r,!0)),a=new Uint32Array(n.length/2),s=0;s<a.length;s++)a[s]=(0,S.UJ)(Math.floor(n[2*s]),Math.floor(n[2*s+1]));return new e({geometry:a},i,C.MX.TRIANGLES)}},{key:"fromGeometry",value:function(t,r){var n=r.geometry.type;switch(n){case"polygon":return e.fromPolygon(t,r.geometry);case"extent":return e.fromMapExtent(t,r.geometry);default:return U.error(new v.Z("mapview-bad-type","Unable to create a mesh from type ".concat(n),r)),e.fromRect({x:0,y:0,width:1,height:1})}}},{key:"fromPolygon",value:function(t,r){for(var n=(0,b.Uy)(new I.Z,r,!1,!1),i=n.coords,a=new Uint32Array(R(n,!1)),s=new Uint32Array(i.length/2),o=(0,k.a)(),u=(0,k.a)(),c=0;c<s.length;c++)(0,Z.a)(o,i[2*c],i[2*c+1]),t.toScreen(u,o),s[c]=(0,S.UJ)(Math.floor(u[0]),Math.floor(u[1]));return new e({geometry:s},a,C.MX.TRIANGLES,!0)}},{key:"fromScreenExtent",value:function(t){var r=t.xmin,n=t.xmax,i=t.ymin,a=t.ymax;return new e({geometry:new Uint32Array([(0,S.UJ)(r,i),(0,S.UJ)(n,i),(0,S.UJ)(r,a),(0,S.UJ)(r,a),(0,S.UJ)(n,i),(0,S.UJ)(n,a)])},new Uint32Array([0,1,2,3,4,5]),C.MX.TRIANGLES)}},{key:"fromMapExtent",value:function(t,r){var n=t.toScreen([0,0],[r.xmin,r.ymin]),i=(0,p.Z)(n,2),a=i[0],s=i[1],o=t.toScreen([0,0],[r.xmax,r.ymax]),u=(0,p.Z)(o,2),c=u[0],h=u[1];return new e({geometry:new Uint32Array([(0,S.UJ)(a,s),(0,S.UJ)(c,s),(0,S.UJ)(a,h),(0,S.UJ)(a,h),(0,S.UJ)(c,s),(0,S.UJ)(c,h)])},new Uint32Array([0,1,2,3,4,5]),C.MX.TRIANGLES)}}]),e}(),A=r(45412),L=d.Z.getLogger("esri.views.2d.engine.webgl.ClippingInfo"),T=function(e){return parseFloat(e)/100},B=function(e){(0,u.Z)(r,e);var t=(0,c.Z)(r);function r(e,n){var a;return(0,i.Z)(this,r),(a=t.call(this))._clip=n,a._cache={},a.stage=e,a._handle=(0,m.YP)((function(){return n.version}),(function(){return a._invalidate()})),a.ready(),a}return(0,a.Z)(r,[{key:"_destroyGL",value:function(){(0,h.pC)(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),(0,h.pC)(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}},{key:"destroy",value:function(){this._destroyGL(),this._handle.remove()}},{key:"getVAO",value:function(e,t,r,n){var i=(0,p.Z)(t.size,2),a=i[0],s=i[1];if("geometry"!==this._clip.type&&this._lastWidth===a&&this._lastHeight===s||(this._lastWidth=a,this._lastHeight=s,this._destroyGL()),(0,h.Wi)(this._cache.vao)){var o=this._createMesh(t,this._clip),u=o.getIndexBuffer(e),c=o.getVertexBuffers(e);this._cache.mesh=o,this._cache.vao=new A.U(e,r,n,c,u)}return this._cache.vao}},{key:"_createTransforms",value:function(){return{dvs:(0,l.c)()}}},{key:"_invalidate",value:function(){this._destroyGL(),this.requestRender()}},{key:"_createScreenRect",value:function(e,t){var r=(0,p.Z)(e.size,2),n=r[0],i=r[1],a="string"==typeof t.left?T(t.left)*n:t.left,s="string"==typeof t.right?T(t.right)*n:t.right,o="string"==typeof t.top?T(t.top)*i:t.top,u="string"==typeof t.bottom?T(t.bottom)*i:t.bottom,c=a,h=o;return{x:c,y:h,width:Math.max(n-s-c,0),height:Math.max(i-u-h,0)}}},{key:"_createMesh",value:function(e,t){switch(t.type){case"rect":return M.fromRect(this._createScreenRect(e,t));case"path":return M.fromPath(t);case"geometry":return M.fromGeometry(e,t);default:return L.error(new v.Z("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),M.fromRect({x:0,y:0,width:1,height:1})}}}],[{key:"fromClipArea",value:function(e,t){return new r(e,t)}}]),r}(g.s),G=r(80613),N=function(e){(0,u.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).name=e.constructor.name,e}return(0,a.Z)(r,[{key:"clips",set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e})),this._updateClippingInfo()}},{key:"_createTransforms",value:function(){return{dvs:(0,l.c)()}}},{key:"doRender",value:function(e){var t=this.createRenderParams(e),r=t.painter,n=t.globalOpacity,i=t.profiler,a=t.drawPhase,s=a===G.jx.LABEL||a===G.jx.HIGHLIGHT?1:n*this.computedOpacity;i.recordContainerStart(this.name),r.beforeRenderLayer(t,this._clippingInfos?255:0,s),this.updateTransforms(e.state),this.renderChildren(t),r.compositeLayer(t,s),i.recordContainerEnd()}},{key:"renderChildren",value:function(e){(0,h.Wi)(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));var t,r=(0,n.Z)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.beforeRender(e)}}catch(c){r.e(c)}finally{r.f()}var i,a=(0,n.Z)(this._renderPasses);try{for(a.s();!(i=a.n()).done;){var s=i.value;try{s.render(e)}catch(l){}}}catch(c){a.e(c)}finally{a.f()}var o,u=(0,n.Z)(this.children);try{for(u.s();!(o=u.n()).done;){o.value.afterRender(e)}}catch(c){u.e(c)}finally{u.f()}}},{key:"createRenderParams",value:function(e){return e.requireFBO=this.requiresDedicatedFBO,e}},{key:"prepareRenderPasses",value:function(e){var t=this;return[e.registerRenderPass({name:"clip",brushes:[f.U.clip],target:function(){return t._clippingInfos},drawPhase:G.jx.MAP|G.jx.LABEL|G.jx.LABEL_ALPHA|G.jx.DEBUG|G.jx.HIGHLIGHT})]}},{key:"updateTransforms",value:function(e){var t,r=(0,n.Z)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.setTransform(e)}}catch(i){r.e(i)}finally{r.f()}}},{key:"onAttach",value:function(){(0,s.Z)((0,o.Z)(r.prototype),"onAttach",this).call(this),this._updateClippingInfo()}},{key:"onDetach",value:function(){(0,s.Z)((0,o.Z)(r.prototype),"onDetach",this).call(this),this._updateClippingInfo()}},{key:"_updateClippingInfo",value:function(){var e=this;if((0,h.pC)(this._clippingInfos)&&(this._clippingInfos.forEach((function(e){return e.destroy()})),this._clippingInfos=null),this.stage){var t=this._clips;(0,h.pC)(t)&&t.length&&(this._clippingInfos=t.items.map((function(t){return B.fromClipArea(e.stage,t)}))),this.requestRender()}}}]),r}(y.W)},39332:function(e,t,r){r.r(t),r.d(t,{default:function(){return I}});var n=r(1413),i=r(74165),a=r(15861),s=r(15671),o=r(43144),u=r(60136),c=r(29388),h=r(27366),l=r(32718),f=r(66978),y=r(94172),p=r(49861),v=(r(63780),r(93169),r(25243),r(69912)),d=r(53866),m=r(90110),g=r(95986),_=r(9229),x=r(67581),w=r(13107),Z=r(29431),k=l.Z.getLogger("esri.views.2d.layers.WMSLayerView2D"),b=function(e){(0,u.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,s.Z)(this,r),(e=t.apply(this,arguments)).container=new m.c,e}return(0,o.Z)(r,[{key:"supportsSpatialReference",value:function(e){return this.layer.serviceSupportsSpatialReference(e)}},{key:"update",value:function(e){this.strategy.update(e).catch((function(e){(0,f.D_)(e)||k.error(e)}))}},{key:"attach",value:function(){var e=this,t=this.layer,r=this.container,n=t.imageMaxHeight,i=t.imageMaxWidth;this.strategy=new _.Z({container:r,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:n,imageMaxWidth:i,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add((0,y.YP)((function(){return e.exportImageVersion}),(function(){return e.requestUpdate()})),"exportImageVersion")}},{key:"detach",value:function(){this.handles.remove("exportImageVersion"),this.strategy.destroy(),this.strategy=null,this.container.removeAllChildren()}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"createFetchPopupFeaturesQuery",value:function(e){var t=this.view,r=this.container,n=e.x,i=e.y,a=t.spatialReference,s=null,o=0,u=0;if(r.children.some((function(e){var t=e.width,r=e.height,c=e.resolution,h=e.x,l=e.y,f=h+c*t,y=l-c*r;return n>=h&&n<=f&&i<=l&&i>=y&&(s=new d.Z({xmin:h,ymin:y,xmax:f,ymax:l,spatialReference:a}),o=t,u=r,!0)})),!s)return null;var c=s.width/o,h=Math.round((n-s.xmin)/c),l=Math.round((s.ymax-i)/c);return{extent:s,width:o,height:u,x:h,y:l}}},{key:"doRefresh",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"fetchImage",value:function(e,t,r,i){return this.layer.fetchImage(e,t,r,(0,n.Z)({timeExtent:this.timeExtent},i))}}]),r}((0,Z.Z)((0,w.Z)((0,g.y)(x.Z))));(0,h._)([(0,p.Cb)()],b.prototype,"strategy",void 0),(0,h._)([(0,p.Cb)()],b.prototype,"updating",void 0);var I=b=(0,h._)([(0,v.j)("esri.views.2d.layers.WMSLayerView2D")],b)},29431:function(e,t,r){r.d(t,{Z:function(){return y}});var n=r(15671),i=r(43144),a=r(60136),s=r(29388),o=r(27366),u=r(10064),c=r(49861),h=(r(63780),r(93169),r(25243),r(69912)),l=r(45948),f=r(42388),y=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"initialize",value:function(){this.exportImageParameters=new f.j({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters.destroy(),this.exportImageParameters=null}},{key:"exportImageVersion",get:function(){var e;return null!==(e=this.exportImageParameters)&&void 0!==e&&e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}},{key:"fetchPopupFeatures",value:function(e){var t=this.layer;if(!e)return Promise.reject(new u.Z("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));var r=t.popupEnabled;if(!r)return Promise.reject(new u.Z("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:r}));var n=this.createFetchPopupFeaturesQuery(e);if(!n)return Promise.resolve([]);var i=n.extent,a=n.width,s=n.height,o=n.x,c=n.y;if(!(i&&a&&s))throw new u.Z("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:i,width:a,height:s});var h=t.fetchFeatureInfo(i,a,s,o,c);return Promise.resolve(h?[h]:[])}}]),r}(e);return(0,o._)([(0,c.Cb)()],t.prototype,"exportImageParameters",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,o._)([(0,c.Cb)()],t.prototype,"layer",void 0),(0,o._)([(0,c.Cb)(l.qG)],t.prototype,"timeExtent",void 0),t=(0,o._)([(0,h.j)("esri.layers.mixins.WMSLayerView")],t)}}}]);
//# sourceMappingURL=1583.c36559de.chunk.js.map