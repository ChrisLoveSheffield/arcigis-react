"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[4105],{47037:function(e,t,r){r.d(t,{G:function(){return y}});var i=r(1413),n=r(37762),a=r(15671),s=r(43144),o=r(11752),l=r(61120),u=r(60136),c=r(29388),h=r(64510),f=r(8548),y=function(e){(0,u.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).requiresDedicatedFBO=!1,e}return(0,s.Z)(r,[{key:"dispose",value:function(){}},{key:"doRender",value:function(e){var t=this.createRenderParams(e),r=t.context,i=t.painter,a=t.profiler;this._prevFBO=r.getBoundFramebufferObject(),a.recordContainerStart(this.name);var s=this._getFbo(t),o=i.getRenderTarget();r.bindFramebuffer(s),i.setRenderTarget(s),r.setDepthWriteEnabled(!0),r.setColorMask(!0,!0,!0,!0),r.setClearColor(0,0,0,0),r.setClearDepth(1),r.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT),r.setDepthWriteEnabled(!1);var l,u=(0,n.Z)(this.children);try{for(u.s();!(l=u.n()).done;){l.value.beforeRender(e)}}catch(v){u.e(v)}finally{u.f()}var c,h=(0,n.Z)(this.children);try{for(h.s();!(c=h.n()).done;){c.value.processRender(t)}}catch(v){h.e(v)}finally{h.f()}var y,d=(0,n.Z)(this.children);try{for(d.s();!(y=d.n()).done;){y.value.afterRender(e)}}catch(v){d.e(v)}finally{d.f()}i.setRenderTarget(o),i.releaseFbo(s),r.bindFramebuffer(this._prevFBO),i.beforeRenderLayer(t,this._clippingInfos?255:0,this.computedOpacity),r.setStencilTestEnabled(!1),r.setStencilWriteMask(0),i.blitTexture(r,s.colorTexture,f.cw.NEAREST),i.compositeLayer(t,this.computedOpacity),a.recordContainerEnd()}},{key:"createRenderParams",value:function(e){return(0,i.Z)((0,i.Z)({},(0,o.Z)((0,l.Z)(r.prototype),"createRenderParams",this).call(this,e)),{},{blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1})}},{key:"_getFbo",value:function(e){var t=e.context,r=e.painter,i=t.getViewport(),n=i.width,a=i.height;return r.acquireFbo(n,a)}}]),r}(h.Z)},64510:function(e,t,r){r.d(t,{Z:function(){return O}});var i=r(37762),n=r(15671),a=r(43144),s=r(11752),o=r(61120),l=r(60136),u=r(29388),c=(r(93169),r(92026)),h=r(23588),f=r(53628),y=r(33624),d=r(29439),v=r(10064),p=r(32718),g=r(94172),_=r(87422),m=r(4942),w=r(1413),b=r(79347),Z=r(88396),k=r(6394),x=r(83406),V=r(80457),C=r(73271),L=r(44070),E=r(8548),R=p.Z.getLogger("esri.views.2d.engine.webgl.Mesh2D"),A=function(e,t,r,i){for(var n=0,a=1;a<r;a++){var s=e[2*(t+a-1)],o=e[2*(t+a-1)+1];n+=(e[2*(t+a)]-s)*(e[2*(t+a)+1]+o)}return i?n>0:n<0},U=function(e,t){for(var r=e.coords,n=e.lengths,a=[],s=0,o=0;s<n.length;o+=n[s],s+=1){for(var l=o,u=[];s<n.length-1&&A(r,o+n[s],n[s+1],t);o+=n[s+=1])u.push(o+n[s]-l);var c,h=r.slice(2*l,2*(o+n[s])),f=(0,b.e)(h,u,2),y=(0,i.Z)(f);try{for(y.s();!(c=y.n()).done;){var d=c.value;a.push(d+l)}}catch(v){y.e(v)}finally{y.f()}}return a},I=function(){function e(t,r,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,n.Z)(this,e),this._cache={},this.vertices=t,this.indices=r,this.primitiveType=i,this.isMapSpace=a}return(0,a.Z)(e,[{key:"destroy",value:function(){for(var e in(0,c.pC)(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose(),this._cache.vertexBuffers)(0,c.pC)(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}},{key:"elementType",get:function(){return function(e){switch(e.BYTES_PER_ELEMENT){case 1:return E.g.UNSIGNED_BYTE;case 2:return E.g.UNSIGNED_SHORT;case 4:return E.g.UNSIGNED_INT;default:throw new v.Z("Cannot get DataType of array")}}(this.indices)}},{key:"getIndexBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.l1.STATIC_DRAW;return this._cache.indexBuffer||(this._cache.indexBuffer=L.f.createIndex(e,t,this.indices)),this._cache.indexBuffer}},{key:"getVertexBuffers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.l1.STATIC_DRAW;return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((function(i,n){return(0,w.Z)((0,w.Z)({},i),{},(0,m.Z)({},n,L.f.createVertex(e,r,t.vertices[n])))}),{})),this._cache.vertexBuffers}}],[{key:"fromRect",value:function(t){var r=t.x,i=t.y,n=r+t.width,a=i+t.height;return e.fromScreenExtent({xmin:r,ymin:i,xmax:n,ymax:a})}},{key:"fromPath",value:function(t){for(var r=(0,x.ks)(new V.Z,t.path,!1,!1),i=r.coords,n=new Uint32Array(U(r,!0)),a=new Uint32Array(i.length/2),s=0;s<a.length;s++)a[s]=(0,C.UJ)(Math.floor(i[2*s]),Math.floor(i[2*s+1]));return new e({geometry:a},n,E.MX.TRIANGLES)}},{key:"fromGeometry",value:function(t,r){var i=r.geometry.type;switch(i){case"polygon":return e.fromPolygon(t,r.geometry);case"extent":return e.fromMapExtent(t,r.geometry);default:return R.error(new v.Z("mapview-bad-type","Unable to create a mesh from type ".concat(i),r)),e.fromRect({x:0,y:0,width:1,height:1})}}},{key:"fromPolygon",value:function(t,r){for(var i=(0,x.Uy)(new V.Z,r,!1,!1),n=i.coords,a=new Uint32Array(U(i,!1)),s=new Uint32Array(n.length/2),o=(0,k.a)(),l=(0,k.a)(),u=0;u<s.length;u++)(0,Z.a)(o,n[2*u],n[2*u+1]),t.toScreen(l,o),s[u]=(0,C.UJ)(Math.floor(l[0]),Math.floor(l[1]));return new e({geometry:s},a,E.MX.TRIANGLES,!0)}},{key:"fromScreenExtent",value:function(t){var r=t.xmin,i=t.xmax,n=t.ymin,a=t.ymax;return new e({geometry:new Uint32Array([(0,C.UJ)(r,n),(0,C.UJ)(i,n),(0,C.UJ)(r,a),(0,C.UJ)(r,a),(0,C.UJ)(i,n),(0,C.UJ)(i,a)])},new Uint32Array([0,1,2,3,4,5]),E.MX.TRIANGLES)}},{key:"fromMapExtent",value:function(t,r){var i=t.toScreen([0,0],[r.xmin,r.ymin]),n=(0,d.Z)(i,2),a=n[0],s=n[1],o=t.toScreen([0,0],[r.xmax,r.ymax]),l=(0,d.Z)(o,2),u=l[0],c=l[1];return new e({geometry:new Uint32Array([(0,C.UJ)(a,s),(0,C.UJ)(u,s),(0,C.UJ)(a,c),(0,C.UJ)(a,c),(0,C.UJ)(u,s),(0,C.UJ)(u,c)])},new Uint32Array([0,1,2,3,4,5]),E.MX.TRIANGLES)}}]),e}(),T=r(45412),B=p.Z.getLogger("esri.views.2d.engine.webgl.ClippingInfo"),P=function(e){return parseFloat(e)/100},S=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e,i){var a;return(0,n.Z)(this,r),(a=t.call(this))._clip=i,a._cache={},a.stage=e,a._handle=(0,g.YP)((function(){return i.version}),(function(){return a._invalidate()})),a.ready(),a}return(0,a.Z)(r,[{key:"_destroyGL",value:function(){(0,c.pC)(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),(0,c.pC)(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}},{key:"destroy",value:function(){this._destroyGL(),this._handle.remove()}},{key:"getVAO",value:function(e,t,r,i){var n=(0,d.Z)(t.size,2),a=n[0],s=n[1];if("geometry"!==this._clip.type&&this._lastWidth===a&&this._lastHeight===s||(this._lastWidth=a,this._lastHeight=s,this._destroyGL()),(0,c.Wi)(this._cache.vao)){var o=this._createMesh(t,this._clip),l=o.getIndexBuffer(e),u=o.getVertexBuffers(e);this._cache.mesh=o,this._cache.vao=new T.U(e,r,i,u,l)}return this._cache.vao}},{key:"_createTransforms",value:function(){return{dvs:(0,h.c)()}}},{key:"_invalidate",value:function(){this._destroyGL(),this.requestRender()}},{key:"_createScreenRect",value:function(e,t){var r=(0,d.Z)(e.size,2),i=r[0],n=r[1],a="string"==typeof t.left?P(t.left)*i:t.left,s="string"==typeof t.right?P(t.right)*i:t.right,o="string"==typeof t.top?P(t.top)*n:t.top,l="string"==typeof t.bottom?P(t.bottom)*n:t.bottom,u=a,c=o;return{x:u,y:c,width:Math.max(i-s-u,0),height:Math.max(n-l-c,0)}}},{key:"_createMesh",value:function(e,t){switch(t.type){case"rect":return I.fromRect(this._createScreenRect(e,t));case"path":return I.fromPath(t);case"geometry":return I.fromGeometry(e,t);default:return B.error(new v.Z("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),I.fromRect({x:0,y:0,width:1,height:1})}}}],[{key:"fromClipArea",value:function(e,t){return new r(e,t)}}]),r}(_.s),M=r(80613),O=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,n.Z)(this,r),(e=t.apply(this,arguments)).name=e.constructor.name,e}return(0,a.Z)(r,[{key:"clips",set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e})),this._updateClippingInfo()}},{key:"_createTransforms",value:function(){return{dvs:(0,h.c)()}}},{key:"doRender",value:function(e){var t=this.createRenderParams(e),r=t.painter,i=t.globalOpacity,n=t.profiler,a=t.drawPhase,s=a===M.jx.LABEL||a===M.jx.HIGHLIGHT?1:i*this.computedOpacity;n.recordContainerStart(this.name),r.beforeRenderLayer(t,this._clippingInfos?255:0,s),this.updateTransforms(e.state),this.renderChildren(t),r.compositeLayer(t,s),n.recordContainerEnd()}},{key:"renderChildren",value:function(e){(0,c.Wi)(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));var t,r=(0,i.Z)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.beforeRender(e)}}catch(u){r.e(u)}finally{r.f()}var n,a=(0,i.Z)(this._renderPasses);try{for(a.s();!(n=a.n()).done;){var s=n.value;try{s.render(e)}catch(h){}}}catch(u){a.e(u)}finally{a.f()}var o,l=(0,i.Z)(this.children);try{for(l.s();!(o=l.n()).done;){o.value.afterRender(e)}}catch(u){l.e(u)}finally{l.f()}}},{key:"createRenderParams",value:function(e){return e.requireFBO=this.requiresDedicatedFBO,e}},{key:"prepareRenderPasses",value:function(e){var t=this;return[e.registerRenderPass({name:"clip",brushes:[f.U.clip],target:function(){return t._clippingInfos},drawPhase:M.jx.MAP|M.jx.LABEL|M.jx.LABEL_ALPHA|M.jx.DEBUG|M.jx.HIGHLIGHT})]}},{key:"updateTransforms",value:function(e){var t,r=(0,i.Z)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.setTransform(e)}}catch(n){r.e(n)}finally{r.f()}}},{key:"onAttach",value:function(){(0,s.Z)((0,o.Z)(r.prototype),"onAttach",this).call(this),this._updateClippingInfo()}},{key:"onDetach",value:function(){(0,s.Z)((0,o.Z)(r.prototype),"onDetach",this).call(this),this._updateClippingInfo()}},{key:"_updateClippingInfo",value:function(){var e=this;if((0,c.pC)(this._clippingInfos)&&(this._clippingInfos.forEach((function(e){return e.destroy()})),this._clippingInfos=null),this.stage){var t=this._clips;(0,c.pC)(t)&&t.length&&(this._clippingInfos=t.items.map((function(t){return S.fromClipArea(e.stage,t)}))),this.requestRender()}}}]),r}(y.W)},74105:function(e,t,r){r.r(t),r.d(t,{default:function(){return y}});var i=r(15671),n=r(43144),a=r(60136),s=r(29388),o=r(27366),l=(r(32718),r(25243),r(63780),r(93169),r(75366),r(69912)),u=r(47037),c=r(95986),h=r(5407),f=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).container=new u.G,e}return(0,n.Z)(r,[{key:"attach",value:function(){var e=this;this._updateStageChildren(),this.handles.add(this.layerViews.on("after-changes",(function(){return e._updateStageChildren()})),"grouplayerview2d")}},{key:"detach",value:function(){this.handles.remove("grouplayerview2d"),this.container.removeAllChildren()}},{key:"update",value:function(e){}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){}},{key:"_updateStageChildren",value:function(){var e=this;this.container.removeAllChildren(),this.layerViews.forEach((function(t,r){return e.container.addChildAt(t.container,r)}))}}]),r}((0,c.y)(h.default)),y=f=(0,o._)([(0,l.j)("esri.views.2d.layers.GroupLayerView2D")],f)},5407:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});var i=r(15671),n=r(43144),a=r(60136),s=r(29388),o=r(27366),l=r(80987),u=r(60354),c=r(92026),h=r(94172),f=r(49861),y=(r(63780),r(93169),r(25243),r(69912)),d=function(e){(0,a.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type="group",n.layerViews=new l.Z,n}return(0,n.Z)(r,[{key:"_allLayerViewVisibility",value:function(e){this.layerViews.forEach((function(t){t.visible=e}))}},{key:"initialize",value:function(){var e=this;this.handles.add([this.layerViews.on("change",(function(t){return e._layerViewsChangeHandler(t)})),(0,h.YP)((function(){return e.layer.visibilityMode}),(function(){return e._applyVisibility((function(){return e._allLayerViewVisibility(e.visible)}),(function(){return e._applyExclusiveVisibility(null)}))}),h.Z_),(0,h.YP)((function(){return e.visible}),(function(t){e._applyVisibility((function(){return e._allLayerViewVisibility(t)}),(function(){}))}),h.Z_)],"grouplayerview"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]})}},{key:"layerViews",set:function(e){this._set("layerViews",(0,u.Z)(e,this._get("layerViews")))}},{key:"updatingProgress",get:function(){return 0===this.layerViews.length?1:this.layerViews.reduce((function(e,t){return e+t.updatingProgress}),0)/this.layerViews.length}},{key:"isUpdating",value:function(){return this.layerViews.some((function(e){return e.updating}))}},{key:"_hasLayerViewVisibleOverrides",value:function(){return this.layerViews.some((function(e){return e._isOverridden("visible")}))}},{key:"_findLayerViewForLayer",value:function(e){return e&&this.layerViews.find((function(t){return t.layer===e}))}},{key:"_firstVisibleOnLayerOrder",value:function(){var e=this,t=this.layer.layers.find((function(t){var r;return null===(r=e._findLayerViewForLayer(t))||void 0===r?void 0:r.visible}));return t&&this._findLayerViewForLayer(t)}},{key:"_applyExclusiveVisibility",value:function(e){(0,c.Wi)(e)&&(e=this._firstVisibleOnLayerOrder(),(0,c.Wi)(e)&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.getItemAt(0)))),this.layerViews.forEach((function(t){t.visible=t===e}))}},{key:"_layerViewsChangeHandler",value:function(e){var t=this;this.handles.remove("grouplayerview:visible"),this.handles.add(this.layerViews.map((function(e){return(0,h.YP)((function(){return e.visible}),(function(r){return t._applyVisibility((function(){r!==t.visible&&(e.visible=t.visible)}),(function(){return t._applyExclusiveVisibility(r?e:null)}))}),h.Z_)})).toArray(),"grouplayerview:visible");var r=e.added[e.added.length-1];this._applyVisibility((function(){return t._allLayerViewVisibility(t.visible)}),(function(){return t._applyExclusiveVisibility(null!==r&&void 0!==r&&r.visible?r:null)}))}},{key:"_applyVisibility",value:function(e,t){var r,i;this._hasLayerViewVisibleOverrides()&&("inherited"===(null===(r=this.layer)||void 0===r?void 0:r.visibilityMode)?e():"exclusive"===(null===(i=this.layer)||void 0===i?void 0:i.visibilityMode)&&t())}}]),r}(r(67581).Z);(0,o._)([(0,f.Cb)({cast:u.R})],d.prototype,"layerViews",null),(0,o._)([(0,f.Cb)({readOnly:!0})],d.prototype,"updatingProgress",null),(0,o._)([(0,f.Cb)()],d.prototype,"view",void 0);var v=d=(0,o._)([(0,y.j)("esri.views.layers.GroupLayerView")],d)}}]);
//# sourceMappingURL=4105.f8d0389c.chunk.js.map