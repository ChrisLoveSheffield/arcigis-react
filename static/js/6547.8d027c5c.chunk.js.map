{"version":3,"file":"static/js/6547.8d027c5c.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/PointCloudWorker.js","../node_modules/@arcgis/core/views/3d/layers/i3s/PointCloudWorkerUtil.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../core/maybe.js\";import{isArrayBuffer as r}from\"../../../core/typedArrayUtil.js\";import{c as e}from\"../../../chunks/quat.js\";import{c as a}from\"../../../chunks/quatf32.js\";import{q as o}from\"../../../chunks/vec3.js\";import{f,c as s}from\"../../../chunks/vec3f32.js\";import{projectBuffer as i}from\"../../../geometry/projection.js\";import n from\"../../../geometry/SpatialReference.js\";import{readGeometry as u,getAttributeValues as l,evaluateRenderer as b,filterInPlace as m}from\"./i3s/PointCloudWorkerUtil.js\";class c{transform(e){const a=this._transform(e),o=[a.points.buffer,a.rgb.buffer];t(a.pointIdFilterMap)&&o.push(a.pointIdFilterMap.buffer);for(const t of a.attributes)\"buffer\"in t.values&&r(t.values.buffer)&&t.values.buffer!==a.rgb.buffer&&o.push(t.values.buffer);return Promise.resolve({result:a,transferList:o})}_transform(r){const e=u(r.schema,r.geometryBuffer);let a=e.length/3,o=null;const f=[],s=l(r.primaryAttributeData,e,a);t(r.primaryAttributeData)&&s&&f.push({attributeInfo:r.primaryAttributeData.attributeInfo,values:s});const i=l(r.modulationAttributeData,e,a);t(r.modulationAttributeData)&&i&&f.push({attributeInfo:r.modulationAttributeData.attributeInfo,values:i});let c=b(r.rendererInfo,s,i,a);if(r.filterInfo&&r.filterInfo.length>0&&t(r.filterAttributesData)){const t=r.filterAttributesData.map((t=>{const r=l(t,e,a),o={attributeInfo:t.attributeInfo,values:r};return f.push(o),o}));o=new Uint32Array(a),a=m(e,c,o,r.filterInfo,t)}for(const t of r.userAttributesData){const r=l(t,e,a);f.push({attributeInfo:t.attributeInfo,values:r})}3*a<c.length&&(c=new Uint8Array(c.buffer.slice(0,3*a))),this._applyElevationOffsetInPlace(e,a,r.elevationOffset);const p=this._transformCoordinates(e,a,r.obb,n.fromJSON(r.inSR),n.fromJSON(r.outSR));return{obb:r.obb,points:p,rgb:c,attributes:f,pointIdFilterMap:o}}_transformCoordinates(t,r,a,n,u){if(!i(t,n,0,t,u,0,r))throw Error(\"Can't reproject\");const l=f(a.center[0],a.center[1],a.center[2]),b=s(),m=s();e(p,a.quaternion);const c=new Float32Array(3*r);for(let e=0;e<r;e++)b[0]=t[3*e]-l[0],b[1]=t[3*e+1]-l[1],b[2]=t[3*e+2]-l[2],o(m,b,p),a.halfSize[0]=Math.max(a.halfSize[0],Math.abs(m[0])),a.halfSize[1]=Math.max(a.halfSize[1],Math.abs(m[1])),a.halfSize[2]=Math.max(a.halfSize[2],Math.abs(m[2])),c[3*e]=b[0],c[3*e+1]=b[1],c[3*e+2]=b[2];return c}_applyElevationOffsetInPlace(t,r,e){if(0!==e)for(let a=0;a<r;a++)t[3*a+2]+=e}}const p=a();function h(){return new c}export{h as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as o}from\"../../../../core/maybe.js\";import r from\"../../../../renderers/PointCloudClassBreaksRenderer.js\";import t from\"../../../../renderers/PointCloudStretchRenderer.js\";import l from\"../../../../renderers/PointCloudUniqueValueRenderer.js\";import{createGeometryIndexFromSchema as n,createTypedView as s,readBinaryAttribute as i}from\"./I3SBinaryReader.js\";import{decodeXYZ as u}from\"./LEPCC.js\";function f(e,o,n,s){const{rendererJSON:i,isRGBRenderer:u}=e;let f=null,c=null;if(o&&u)f=o;else if(o&&\"pointCloudUniqueValueRenderer\"===i.type){c=l.fromJSON(i);const e=c.colorUniqueValueInfos;f=new Uint8Array(3*s);const r=p(c.fieldTransformType);for(let t=0;t<s;t++){const l=(r?r(o[t]):o[t])+\"\";for(let o=0;o<e.length;o++)if(e[o].values.includes(l)){f[3*t]=e[o].color.r,f[3*t+1]=e[o].color.g,f[3*t+2]=e[o].color.b;break}}}else if(o&&\"pointCloudStretchRenderer\"===i.type){c=t.fromJSON(i);const e=c.stops;f=new Uint8Array(3*s);const r=p(c.fieldTransformType);for(let t=0;t<s;t++){const l=r?r(o[t]):o[t],n=e.length-1;if(l<e[0].value)f[3*t]=e[0].color.r,f[3*t+1]=e[0].color.g,f[3*t+2]=e[0].color.b;else if(l>=e[n].value)f[3*t]=e[n].color.r,f[3*t+1]=e[n].color.g,f[3*t+2]=e[n].color.b;else for(let o=1;o<e.length;o++)if(l<e[o].value){const r=(l-e[o-1].value)/(e[o].value-e[o-1].value);f[3*t]=e[o].color.r*r+e[o-1].color.r*(1-r),f[3*t+1]=e[o].color.g*r+e[o-1].color.g*(1-r),f[3*t+2]=e[o].color.b*r+e[o-1].color.b*(1-r);break}}}else if(o&&\"pointCloudClassBreaksRenderer\"===i.type){c=r.fromJSON(i);const e=c.colorClassBreakInfos;f=new Uint8Array(3*s);const t=p(c.fieldTransformType);for(let r=0;r<s;r++){const l=t?t(o[r]):o[r];for(let o=0;o<e.length;o++)if(l>=e[o].minValue&&l<=e[o].maxValue){f[3*r]=e[o].color.r,f[3*r+1]=e[o].color.g,f[3*r+2]=e[o].color.b;break}}}else{f=new Uint8Array(3*s);for(let e=0;e<f.length;e++)f[e]=255}if(n&&c&&c.colorModulation){const e=c.colorModulation.minValue,o=c.colorModulation.maxValue,r=.3;for(let t=0;t<s;t++){const l=n[t],s=l>=o?1:l<=e?r:r+(1-r)*(l-e)/(o-e);f[3*t]=s*f[3*t],f[3*t+1]=s*f[3*t+1],f[3*t+2]=s*f[3*t+2]}}return f}function c(o,r){if(null==o.encoding||\"\"===o.encoding){const t=n(r,o);if(e(t.vertexAttributes.position))return;const l=s(r,t.vertexAttributes.position),i=t.header.fields,u=[i.offsetX,i.offsetY,i.offsetZ],f=[i.scaleX,i.scaleY,i.scaleZ],c=l.length/3,a=new Float64Array(3*c);for(let e=0;e<c;e++)a[3*e]=l[3*e]*f[0]+u[0],a[3*e+1]=l[3*e+1]*f[1]+u[1],a[3*e+2]=l[3*e+2]*f[2]+u[2];return a}if(\"lepcc-xyz\"===o.encoding)return u(r).result}function a(e,r,t){return o(e)&&e.attributeInfo.useElevation?d(r,t):o(e)?i(e.attributeInfo.storageInfo,e.buffer,t):null}function d(e,o){const r=new Float64Array(o);for(let t=0;t<o;t++)r[t]=e[3*t+2];return r}function m(e,o,r,t,l){const n=e.length/3;let s=0;for(let i=0;i<n;i++){let n=!0;for(let e=0;e<t.length&&n;e++){const{filterJSON:o}=t[e],r=l[e].values[i];switch(o.type){case\"pointCloudValueFilter\":{const e=\"exclude\"===o.mode;o.values.includes(r)===e&&(n=!1);break}case\"pointCloudBitfieldFilter\":{const e=b(o.requiredSetBits),t=b(o.requiredClearBits);(r&e)===e&&0==(r&t)||(n=!1);break}case\"pointCloudReturnFilter\":{const e=15&r,t=r>>>4&15,l=t>1,s=1===e,i=e===t;let u=!1;for(const r of o.includedReturns)if(\"last\"===r&&i||\"firstOfMany\"===r&&s&&l||\"lastOfMany\"===r&&i&&l||\"single\"===r&&!l){u=!0;break}u||(n=!1);break}}}n&&(r[s]=i,e[3*s]=e[3*i],e[3*s+1]=e[3*i+1],e[3*s+2]=e[3*i+2],o[3*s]=o[3*i],o[3*s+1]=o[3*i+1],o[3*s+2]=o[3*i+2],s++)}return s}function p(e){return null==e||\"none\"===e?null:\"low-four-bit\"===e?e=>15&e:\"high-four-bit\"===e?e=>(240&e)>>4:\"absolute-value\"===e?e=>Math.abs(e):\"modulo-ten\"===e?e=>e%10:null}function b(e){let o=0;for(const r of e||[])o|=1<<r;return o}export{d as elevationFromPositions,f as evaluateRenderer,m as filterInPlace,a as getAttributeValues,c as readGeometry};\n"],"names":["c","e","a","this","_transform","o","points","buffer","rgb","t","pointIdFilterMap","push","attributes","values","r","Promise","resolve","result","transferList","u","schema","geometryBuffer","length","f","s","l","primaryAttributeData","attributeInfo","i","modulationAttributeData","b","rendererInfo","filterInfo","filterAttributesData","map","Uint32Array","m","userAttributesData","Uint8Array","slice","_applyElevationOffsetInPlace","elevationOffset","p","_transformCoordinates","obb","n","inSR","outSR","Error","center","quaternion","Float32Array","halfSize","Math","max","abs","h","rendererJSON","isRGBRenderer","type","colorUniqueValueInfos","fieldTransformType","includes","color","g","stops","value","colorClassBreakInfos","minValue","maxValue","colorModulation","encoding","vertexAttributes","position","header","fields","offsetX","offsetY","offsetZ","scaleX","scaleY","scaleZ","Float64Array","useElevation","d","storageInfo","filterJSON","mode","requiredSetBits","requiredClearBits","includedReturns"],"sourceRoot":""}