{"version":3,"file":"static/js/1611.97130f57.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/2d/engine/webgl/Mesh2D.js","../node_modules/@arcgis/core/views/2d/engine/webgl/ClippingInfo.js","../node_modules/@arcgis/core/views/2d/engine/webgl/WGLContainer.js","../node_modules/@arcgis/core/views/2d/layers/BaseDynamicLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import t from\"../../../../core/Logger.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{e as o}from\"../../../../chunks/earcut.js\";import{a as s}from\"../../../../chunks/vec2.js\";import{a as n}from\"../../../../chunks/vec2f64.js\";import{convertFromNestedArray as i,convertFromPolygon as c}from\"../../../../layers/graphics/featureConversionUtils.js\";import a from\"../../../../layers/graphics/OptimizedGeometry.js\";import{i1616to32 as f}from\"./number.js\";import{BufferObject as h}from\"../../../webgl/BufferObject.js\";import{PrimitiveType as m,Usage as u,DataType as y}from\"../../../webgl/enums.js\";const x=t.getLogger(\"esri.views.2d.engine.webgl.Mesh2D\"),g=t=>{switch(t.BYTES_PER_ELEMENT){case 1:return y.UNSIGNED_BYTE;case 2:return y.UNSIGNED_SHORT;case 4:return y.UNSIGNED_INT;default:throw new e(\"Cannot get DataType of array\")}},p=(e,t,r,o)=>{let s=0;for(let n=1;n<r;n++){const r=e[2*(t+n-1)],o=e[2*(t+n-1)+1];s+=(e[2*(t+n)]-r)*(e[2*(t+n)+1]+o)}return o?s>0:s<0},l=({coords:e,lengths:t},r)=>{const s=[];for(let n=0,i=0;n<t.length;i+=t[n],n+=1){const c=i,a=[];for(;n<t.length-1&&p(e,i+t[n],t[n+1],r);n+=1,i+=t[n])a.push(i+t[n]-c);const f=e.slice(2*c,2*(i+t[n])),h=o(f,a,2);for(const e of h)s.push(e+c)}return s};class w{constructor(e,t,r,o=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=r,this.isMapSpace=o}static fromRect({x:e,y:t,width:r,height:o}){const s=e,n=t,i=s+r,c=n+o;return w.fromScreenExtent({xmin:s,ymin:n,xmax:i,ymax:c})}static fromPath(e){const t=i(new a,e.path,!1,!1),r=t.coords,o=new Uint32Array(l(t,!0)),s=new Uint32Array(r.length/2);for(let n=0;n<s.length;n++)s[n]=f(Math.floor(r[2*n]),Math.floor(r[2*n+1]));return new w({geometry:s},o,m.TRIANGLES)}static fromGeometry(t,r){const o=r.geometry.type;switch(o){case\"polygon\":return w.fromPolygon(t,r.geometry);case\"extent\":return w.fromMapExtent(t,r.geometry);default:return x.error(new e(\"mapview-bad-type\",`Unable to create a mesh from type ${o}`,r)),w.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const r=c(new a,t,!1,!1),o=r.coords,i=new Uint32Array(l(r,!1)),h=new Uint32Array(o.length/2),u=n(),y=n();for(let n=0;n<h.length;n++)s(u,o[2*n],o[2*n+1]),e.toScreen(y,u),h[n]=f(Math.floor(y[0]),Math.floor(y[1]));return new w({geometry:h},i,m.TRIANGLES,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:r,ymax:o}){const s={geometry:new Uint32Array([f(e,r),f(t,r),f(e,o),f(e,o),f(t,r),f(t,o)])},n=new Uint32Array([0,1,2,3,4,5]);return new w(s,n,m.TRIANGLES)}static fromMapExtent(e,t){const[r,o]=e.toScreen([0,0],[t.xmin,t.ymin]),[s,n]=e.toScreen([0,0],[t.xmax,t.ymax]),i={geometry:new Uint32Array([f(r,o),f(s,o),f(r,n),f(r,n),f(s,o),f(s,n)])},c=new Uint32Array([0,1,2,3,4,5]);return new w(i,c,m.TRIANGLES)}destroy(){r(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)r(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}get elementType(){return g(this.indices)}getIndexBuffer(e,t=u.STATIC_DRAW){return this._cache.indexBuffer||(this._cache.indexBuffer=h.createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=u.STATIC_DRAW){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(((r,o)=>({...r,[o]:h.createVertex(e,t,this.vertices[o])})),{})),this._cache.vertexBuffers}}export{w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Error.js\";import e from\"../../../../core/Logger.js\";import{isSome as r,isNone as s}from\"../../../../core/maybe.js\";import{watch as i}from\"../../../../core/reactiveUtils.js\";import{c as o}from\"../../../../chunks/mat3f32.js\";import{DisplayObject as h}from\"../DisplayObject.js\";import a from\"./Mesh2D.js\";import{VertexArrayObject as c}from\"../../../webgl/VertexArrayObject.js\";const n=e.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\"),m=t=>parseFloat(t)/100;class p extends h{constructor(t,e){super(),this._clip=e,this._cache={},this.stage=t,this._handle=i((()=>e.version),(()=>this._invalidate())),this.ready()}static fromClipArea(t,e){return new p(t,e)}_destroyGL(){r(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),r(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(t,e,r,i){const[o,h]=e.size;if(\"geometry\"!==this._clip.type&&this._lastWidth===o&&this._lastHeight===h||(this._lastWidth=o,this._lastHeight=h,this._destroyGL()),s(this._cache.vao)){const s=this._createMesh(e,this._clip),o=s.getIndexBuffer(t),h=s.getVertexBuffers(t);this._cache.mesh=s,this._cache.vao=new c(t,r,i,h,o)}return this._cache.vao}_createTransforms(){return{dvs:o()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(t,e){const[r,s]=t.size,i=\"string\"==typeof e.left?m(e.left)*r:e.left,o=\"string\"==typeof e.right?m(e.right)*r:e.right,h=\"string\"==typeof e.top?m(e.top)*s:e.top,a=\"string\"==typeof e.bottom?m(e.bottom)*s:e.bottom,c=i,n=h;return{x:c,y:n,width:Math.max(r-o-c,0),height:Math.max(s-a-n,0)}}_createMesh(e,r){switch(r.type){case\"rect\":return a.fromRect(this._createScreenRect(e,r));case\"path\":return a.fromPath(r);case\"geometry\":return a.fromGeometry(e,r);default:return n.error(new t(\"mapview-bad-type\",\"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")),a.fromRect({x:0,y:0,width:1,height:1})}}}export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{isNone as e,isSome as r}from\"../../../../core/maybe.js\";import{c as s}from\"../../../../chunks/mat3f32.js\";import{brushes as t}from\"../brushes.js\";import{Container as i}from\"../Container.js\";import n from\"./ClippingInfo.js\";import{WGLDrawPhase as o}from\"./enums.js\";class a extends i{constructor(){super(...arguments),this.name=this.constructor.name}set clips(e){this._clips=e,this.children.forEach((r=>r.clips=e)),this._updateClippingInfo()}_createTransforms(){return{dvs:s()}}doRender(e){const r=this.createRenderParams(e),{painter:s,globalOpacity:t,profiler:i,drawPhase:n}=r,a=n===o.LABEL||n===o.HIGHLIGHT?1:t*this.computedOpacity;i.recordContainerStart(this.name),s.beforeRenderLayer(r,this._clippingInfos?255:0,a),this.updateTransforms(e.state),this.renderChildren(r),s.compositeLayer(r,a),i.recordContainerEnd()}renderChildren(r){e(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(r.painter));for(const e of this.children)e.beforeRender(r);for(const e of this._renderPasses)try{e.render(r)}catch(s){}for(const e of this.children)e.afterRender(r)}createRenderParams(e){return e.requireFBO=this.requiresDedicatedFBO,e}prepareRenderPasses(e){return[e.registerRenderPass({name:\"clip\",brushes:[t.clip],target:()=>this._clippingInfos,drawPhase:o.MAP|o.LABEL|o.LABEL_ALPHA|o.DEBUG|o.HIGHLIGHT})]}updateTransforms(e){for(const r of this.children)r.setTransform(e)}onAttach(){super.onAttach(),this._updateClippingInfo()}onDetach(){super.onDetach(),this._updateClippingInfo()}_updateClippingInfo(){if(r(this._clippingInfos)&&(this._clippingInfos.forEach((e=>e.destroy())),this._clippingInfos=null),!this.stage)return;const e=this._clips;r(e)&&e.length&&(this._clippingInfos=e.items.map((e=>n.fromClipArea(this.stage,e)))),this.requestRender()}}export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import e from\"../../../core/Logger.js\";import{isAbortError as r}from\"../../../core/promiseUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{BitmapContainer as a}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as o}from\"./LayerView2D.js\";import p from\"./support/ExportStrategy.js\";import n from\"../../layers/LayerView.js\";import m from\"../../layers/RefreshableLayerView.js\";const h=e.getLogger(\"esri.views.2d.layers.BaseDynamicLayerView2D\");let c=class extends(m(o(n))){update(t){this.strategy.update(t).catch((t=>{r(t)||h.error(t)})),this.notifyChange(\"updating\")}attach(){this._bitmapContainer=new a,this.container.addChild(this._bitmapContainer),this.strategy=new p({container:this._bitmapContainer,fetchSource:this.fetchBitmapData.bind(this),requestUpdate:this.requestUpdate.bind(this)})}detach(){this.strategy.destroy(),this.strategy=null,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}fetchBitmapData(t,e,r){return this.layer.fetchImage(t,e,r)}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}};t([s()],c.prototype,\"strategy\",void 0),t([s()],c.prototype,\"updating\",void 0),c=t([i(\"esri.views.2d.layers.BaseDynamicLayerView2D\")],c);const d=c;export{d as default};\n"],"names":["x","t","p","e","r","o","s","n","l","coords","lengths","i","length","c","a","push","f","slice","h","w","this","_cache","vertices","indices","primitiveType","isMapSpace","indexBuffer","dispose","vertexBuffers","BYTES_PER_ELEMENT","y","g","u","Object","keys","reduce","width","height","fromScreenExtent","xmin","ymin","xmax","ymax","path","Uint32Array","Math","floor","geometry","m","type","fromPolygon","fromMapExtent","error","fromRect","toScreen","parseFloat","_clip","stage","_handle","version","_invalidate","ready","mesh","destroy","vao","_destroyGL","remove","size","_lastWidth","_lastHeight","_createMesh","getIndexBuffer","getVertexBuffers","dvs","requestRender","left","right","top","bottom","max","_createScreenRect","arguments","name","constructor","_clips","children","forEach","clips","_updateClippingInfo","createRenderParams","painter","globalOpacity","profiler","drawPhase","computedOpacity","recordContainerStart","beforeRenderLayer","_clippingInfos","updateTransforms","state","renderChildren","compositeLayer","recordContainerEnd","_renderPasses","prepareRenderPasses","beforeRender","render","afterRender","requireFBO","requiresDedicatedFBO","registerRenderPass","brushes","target","setTransform","items","map","strategy","update","catch","notifyChange","_bitmapContainer","container","addChild","fetchSource","fetchBitmapData","bind","requestUpdate","removeChild","removeAllChildren","layer","fetchImage","updating","updateRequested","prototype","d"],"sourceRoot":""}