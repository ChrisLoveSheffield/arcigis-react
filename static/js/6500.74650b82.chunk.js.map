{"version":3,"file":"static/js/6500.74650b82.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/core/CircularArray.js","../node_modules/@arcgis/core/layers/graphics/data/StreamFeatureManager.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/WebSocketConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/StreamConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"./maybe.js\";class s{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const s=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,s}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}find(s){if(0===this.size)return null;for(const e of this._buffer)if(t(e)&&s(e))return e;return null}clear(s){let e=this.dequeue();for(;t(e);)s&&s(e),e=this.dequeue()}}export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/CircularArray.js\";import{clamp as e}from\"../../../core/mathUtils.js\";import{isNone as s,isSome as i,unwrap as r}from\"../../../core/maybe.js\";const o=\"__esri_stream_id__\",d=\"__esri_timestamp__\",a=1e3;class h{constructor(t,e,s,i,r=128){this._trackIdToObservations=new Map,this._idCounter=0,this._lastPurge=performance.now(),this._addOrUpdated=new Map,this._removed=[],this._maxAge=0,this._timeInfo=s,this._purgeOptions=i,this.store=t,this.objectIdField=e,this.purgeInterval=r,this._useGeneratedIds=this.objectIdField===o}add(r){if(this._useGeneratedIds){const t=this._nextId();r.attributes[this.objectIdField]=t,r.objectId=t}else r.objectId=r.attributes[this.objectIdField];if(this._addOrUpdated.set(r.objectId,r),this._maxAge=Math.max(this._maxAge,r.attributes[this._timeInfo.startTimeField]),!this._timeInfo.trackIdField)return s(this._trackIdLessObservations)&&(this._trackIdLessObservations=new t(1e5)),void this._trackIdLessObservations.enqueue(r.objectId);const o=r.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(o)){const s=i(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:a,r=e(s,0,a);this._trackIdToObservations.set(o,new t(r))}const d=this._trackIdToObservations.get(o).enqueue(r.objectId);i(d)&&(this._addOrUpdated.has(d)?this._addOrUpdated.delete(d):this._removed.push(d))}checkForUpdates(){const t=this._getToAdd(),e=this._getToRemove(),s=performance.now();s-this._lastPurge>=this.purgeInterval&&(this._purge(s),this._lastPurge=s);const r=[];if(i(e))for(const o of e){const t=this.store.removeById(o);i(t)&&r.push(t)}if(i(t))for(const i of t)i.attributes[d]=s,this.store.add(i);(t||r)&&this.store.update(t,r)}_getToAdd(){if(!this._addOrUpdated.size)return null;const t=new Array(this._addOrUpdated.size);let e=0;return this._addOrUpdated.forEach((s=>t[e++]=s)),this._addOrUpdated.clear(),t}_getToRemove(){const t=this._removed;return this._removed.length?(this._removed=[],t):null}_nextId(){const t=this._idCounter;return this._idCounter=(this._idCounter+1)%4294967294+1,t}_purge(t){const e=this._purgeOptions;i(e)&&(this._purgeSomeByDisplayCount(e),this._purgeByAge(e),this._purgeByAgeReceived(t,e),this._purgeTracks())}_purgeSomeByDisplayCount(t){if(!t.displayCount)return;let e=this.store.size;if(e>t.displayCount){if(this._timeInfo.trackIdField)for(const s of this._trackIdToObservations.values())if(e>t.displayCount&&s.size){const t=r(s.dequeue());this._removed.push(t),e--}if(i(this._trackIdLessObservations)){let s=e-t.displayCount;for(;s-- >0;){const t=this._trackIdLessObservations.dequeue();i(t)&&this._removed.push(t)}}}}_purgeByAge(t){if(!t.age||!this._timeInfo?.startTimeField)return;const e=60*t.age*1e3,s=this._maxAge-e;this.store.forEach((t=>{t.attributes[this._timeInfo.startTimeField]<s&&this._removed.push(t.objectId)}))}_purgeByAgeReceived(t,e){if(!e.ageReceived)return;const s=t-60*e.ageReceived*1e3;this.store.forEach((t=>{t.attributes[d]<s&&this._removed.push(t.objectId)}))}_purgeTracks(){this._trackIdToObservations.forEach(((t,e)=>{0===t.size&&this._trackIdToObservations.delete(e)}))}}export{o as DEFAULT_STREAM_ID_FIELD,d as ESRI_TIMESTAMP,h as StreamFeatureManager};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Error.js\";import o from\"../../../../core/Logger.js\";import{isSome as r,isNone as s}from\"../../../../core/maybe.js\";import{after as n,createResolver as c}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as i}from\"../../../../core/urlUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as d}from\"../../../../geometry/support/zscale.js\";import h from\"./StreamConnection.js\";const p=o.getLogger(\"esri.layers.graphics.sources.connections.WebSocketConnection\");var u;!function(e){e[e.CONNECTING=0]=\"CONNECTING\",e[e.OPEN=1]=\"OPEN\",e[e.CLOSING=2]=\"CLOSING\",e[e.CLOSED=3]=\"CLOSED\"}(u||(u={}));let m=class extends h{constructor(e){super(),this.errorString=null;const{geometryType:t,spatialReference:o,sourceSpatialReference:r}=e;this._config=e,this._featureZScaler=d(t,r,o),this._open()}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){r(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(s(this._websocket))return\"disconnected\";switch(this._websocket.readyState){case u.CONNECTING:case u.OPEN:return\"connected\";case u.CLOSING:case u.CLOSED:return\"disconnected\"}}async _tryCreateWebSocket(e=this._config.source.path,o=1e3,r=0){try{if(this.destroyed)return;const t=i(e,this._config.customParameters);this._websocket=await this._createWebSocket(t),this.notifyChange(\"connectionStatus\")}catch(s){const c=o/1e3;return this._config.maxReconnectionAttempts&&r>=this._config.maxReconnectionAttempts?(p.error(new t(\"websocket-connection\",\"Exceeded maxReconnectionAttempts attempts. No further attempts will be made\")),void this.destroy()):(p.error(new t(\"websocket-connection\",`Failed to connect. Attempting to reconnect in ${c}s`,s)),await n(o),this._tryCreateWebSocket(e,Math.min(1.5*o,1e3*this._config.maxReconnectionInterval),r+1))}}_createWebSocket(e){return new Promise(((t,o)=>{const r=new WebSocket(e);r.onopen=()=>{if(r.onopen=null,this.destroyed)return r.onclose=null,void r.close();r.onclose=e=>this._onClose(e),r.onerror=e=>this._onError(e),r.onmessage=e=>this._onMessage(e),t(r)},r.onclose=e=>{r.onopen=r.onclose=null,o(e)}}))}async _handshake(e=1e4){const o=this._websocket;if(s(o))return;const r=c(),n=o.onmessage,{filter:i,outFields:a,spatialReference:l}=this._config;return r.timeout(e),o.onmessage=e=>{let s=null;try{s=JSON.parse(e.data)}catch(c){}s&&\"object\"==typeof s||(p.error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - malformed message\",e.data)),r.reject(),this.destroy()),s.spatialReference?.wkid!==l?.wkid&&(p.error(new t(\"websocket-connection\",`Protocol violation. Handshake failed - expected wkid of ${l.wkid}`,e.data)),r.reject(),this.destroy()),\"json\"!==s.format&&(p.error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - format is not set\",e.data)),r.reject(),this.destroy()),i&&s.filter!==i&&p.error(new t(\"websocket-connection\",\"Tried to set filter, but server doesn't support it\")),a&&s.outFields!==a&&p.error(new t(\"websocket-connection\",\"Tried to set outFields, but server doesn't support it\")),o.onmessage=n,r.resolve()},o.send(JSON.stringify({filter:i,outFields:a,format:\"json\",spatialReference:{wkid:l.wkid}})),r.promise}_onMessage(e){try{const o=JSON.parse(e.data);if(\"featureResult\"!==o.type)throw new t(\"websocket-connection\",\"Protocol violation - Expected to find message of type 'featureResult'\",o);for(const e of o.features)r(this._featureZScaler)&&this._featureZScaler(e.geometry),this.onFeature(e)}catch(o){return p.error(new t(\"websocket-connection\",\"Failed to parse message\",o)),void this.destroy()}}_onError(e){const t=\"Encountered an error over WebSocket connection\";this._set(\"errorString\",t),p.error(\"websocket-connection\",t)}_onClose(e){this._websocket=null,this.notifyChange(\"connectionStatus\"),1e3!==e.code&&p.error(\"websocket-connection\",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};e([a()],m.prototype,\"connectionStatus\",null),e([a()],m.prototype,\"errorString\",void 0),m=e([l(\"esri.layers.graphics.sources.connections.WebSocketConnection\")],m);export{u as ReadyState,m as WebSocketConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../core/Evented.js\";import{HandleOwner as s}from\"../../../../core/HandleOwner.js\";import\"../../../../core/Logger.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/set.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";let t=class extends(e.EventedMixin(s)){onFeature(r){this.emit(\"feature\",r)}};t=r([o(\"esri.layers.graphics.sources.connections.StreamConnection\")],t);const c=t;export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import\"../../../../geometry.js\";import t from\"../../../../request.js\";import r from\"../../../../core/Error.js\";import o from\"../../../../core/Logger.js\";import{isSome as s,isNone as i,unwrapOr as n,get as a}from\"../../../../core/maybe.js\";import{createResolver as c}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as u}from\"../../../../core/urlUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/set.js\";import{subclass as f}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{WebSocketConnection as d}from\"./WebSocketConnection.js\";import{executeQuery as h}from\"../../../../rest/query/operations/query.js\";import l from\"../../../../rest/support/Query.js\";import{fromJSON as y}from\"../../../../geometry/support/jsonUtils.js\";import m from\"../../../../geometry/SpatialReference.js\";const p=o.getLogger(\"esri.layers.graphics.sources.connections.GeoEventConnection\"),g=1e4,_={maxQueryDepth:5,maxRecordCountFactor:3};let w=class extends d{constructor(e){super({..._,...e})}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||p.warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){let t;try{t=this._enrich(JSON.parse(e.data)),s(this._featureZScaler)&&this._featureZScaler(t.geometry)}catch(o){return void p.error(new r(\"geoevent-connection\",\"Failed to parse message\",o))}this.onFeature(t)}async _fetchServiceDefinition(e){const r={f:\"json\",...this._config.customParameters},o=t(e.path,{query:r,responseType:\"json\"}),s=(await o).data;return this._serviceDefinition=s,s}_fetchWebSocketUrl(e,t){const r=e[0],{urls:o,token:s}=r,i=this._inferWebSocketBaseUrl(o);return u(`${i}/subscribe`,{outSR:\"\"+t.wkid,token:s})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return p.error(new r(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const o=this._websocket;if(i(o)||i(e)&&i(t))return;const s=JSON.stringify({filter:this._serializeFilter(e,t)});let n=!1;const a=c(),u=()=>{n||(this.destroyed||this._websocket!==o||p.error(new r(\"geoevent-connection\",\"Server timed out when setting filter\")),a.reject())},f=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(p.error(new r(\"geoevent-connection\",\"Failed to set service filter\",t.error)),this._set(\"errorString\",`Could not set service filter - ${t.error}`),a.reject(t.error)),o.onmessage=this._onMessage.bind(this),n=!0,a.resolve())};return o.onmessage=f,o.send(s),setTimeout(u,g),a.promise}_serializeFilter(e,t){const o={};if(i(e)&&i(t))return o;if(s(e)&&e.geometry)try{const t=y(e.geometry);if(\"extent\"!==t.type)throw new r(`Expected extent but found type ${t.type}`);o.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(n){p.error(new r(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",n))}return s(e)&&e.where&&\"1 = 1\"!==e.where&&(o.where=e.where),s(t)&&(o.outFields=t.join(\",\")),o}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t];if(!this._relatedFeatures.has(o))return p.warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:s,geometry:i}=this._relatedFeatures.get(o);for(const r in s)e.attributes[r]=s[r];return i&&(e.geometry=i),e.geometry||e.centroid||p.error(new r(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),o=this._queryArchive(t);await r;const s=await o;if(!s)return;for(const i of s.features)this.onFeature(this._enrich(i))}catch(e){p.error(new r(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await import(\"../../../FeatureLayer.js\")).default)({url:e}),{capabilities:r}=await t.load(),o=r.query.supportsMaxRecordCountFactor,s=r.query.supportsPagination,i=r.query.supportsCentroid,c=this._config.maxRecordCountFactor,u=t.capabilities.query.maxRecordCount,f=o?u*c:u,d=new l;if(d.outFields=n(this._config.outFields,[\"*\"]),d.where=n(a(this._config.filter,\"where\"),\"1=1\"),d.returnGeometry=!0,d.returnExceededLimitFeatures=!0,d.outSpatialReference=m.fromJSON(this._config.spatialReference),i&&(d.returnCentroid=!0),o&&(d.maxRecordCountFactor=c),s)return d.num=f,t.destroy(),this._queryPages(e,d);const y=await h(e,d,this._config.sourceSpatialReference);return t.destroy(),y.data}async _queryPages(e,t,r=[],o=0){t.start=s(t.num)?o*t.num:null;const{data:i}=await h(e,t,this._config.sourceSpatialReference);return i.exceededTransferLimit&&o<this._config.maxQueryDepth?(i.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,o+1)):(r.forEach((e=>i.features.push(e))),i)}_addRelatedFeatures(e){const t=new Map,r=e.features,o=this._serviceDefinition.relatedFeatures.joinField;for(const s of r){const e=s.attributes[o];t.set(e,s)}this._relatedFeatures=t}};w=e([f(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],w);const F=w;export{F as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"./GeoEventConnection.js\";import{WebSocketConnection as n}from\"./WebSocketConnection.js\";function t(t,o,r,c,i,s,a,m){const p=0===t.path.indexOf(\"wss://\")||0===t.path.indexOf(\"ws://\"),f={source:t,sourceSpatialReference:o,spatialReference:r,geometryType:c,filter:i,maxReconnectionAttempts:s,maxReconnectionInterval:a,customParameters:m};return p?new n(f):new e(f)}export{t as createConnection};\n"],"names":["s","t","this","size","_start","maxSize","_buffer","Array","e","dequeue","o","d","h","i","r","_trackIdToObservations","Map","_idCounter","_lastPurge","performance","now","_addOrUpdated","_removed","_maxAge","_timeInfo","_purgeOptions","store","objectIdField","purgeInterval","_useGeneratedIds","_nextId","attributes","objectId","set","Math","max","startTimeField","trackIdField","_trackIdLessObservations","enqueue","has","maxObservations","get","delete","push","_getToAdd","_getToRemove","_purge","removeById","add","update","forEach","clear","length","_purgeSomeByDisplayCount","_purgeByAge","_purgeByAgeReceived","_purgeTracks","displayCount","values","age","ageReceived","u","emit","c","p","CONNECTING","OPEN","CLOSING","CLOSED","m","errorString","geometryType","spatialReference","sourceSpatialReference","_config","_featureZScaler","_open","_tryCreateWebSocket","destroyed","_handshake","_websocket","onopen","onclose","onerror","onmessage","close","readyState","source","path","customParameters","_createWebSocket","notifyChange","maxReconnectionAttempts","error","destroy","n","min","maxReconnectionInterval","Promise","WebSocket","_onClose","_onError","_onMessage","a","filter","outFields","l","timeout","JSON","parse","data","reject","wkid","format","resolve","send","stringify","promise","type","features","geometry","onFeature","_set","code","prototype","_","maxQueryDepth","maxRecordCountFactor","w","_fetchServiceDefinition","timeInfo","warn","_fetchWebSocketUrl","streamUrls","_buddyServicesQuery","_queryBuddyServices","_setFilter","_enrich","f","query","responseType","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","outSR","includes","_serializeFilter","bind","setTimeout","y","shiftCentralMeridian","where","join","_relatedFeatures","relatedFeatures","joinField","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","_queryBuddy","featuresUrl","_addRelatedFeatures","default","url","load","capabilities","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","returnGeometry","returnExceededLimitFeatures","outSpatialReference","returnCentroid","num","_queryPages","start","exceededTransferLimit","F","indexOf"],"sourceRoot":""}