"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[9459],{49459:function(e,r,t){t.r(r),t.d(r,{default:function(){return Be}});var n=t(74165),i=t(1413),a=t(15861),s=t(37762),o=t(15671),u=t(43144),l=t(11752),p=t(61120),c=t(60136),y=t(29388),d=t(27366),f=t(80987),v=t(77178),h=t(10064),b=t(84652),g=t(93002),m=t(32718),Z=t(92026),w=t(97642),k=t(66978),_=t(35995),S=t(49861),x=(t(25243),t(38511)),I=t(69912),C=t(78952),j=t(30651),F=t(59147),O=t(15801),A=t(27961),B=t(11936),T=t(6061),P=t(29598),E=t(56811),q=t(95731),L=t(46784),M=t(71907),R=(t(63780),t(93169),function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).type=null,e}return(0,u.Z)(t)}(L.wq));(0,d._)([(0,S.Cb)({type:String,readOnly:!0,json:{write:!0}})],R.prototype,"type",void 0);var U,N=R=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterAuthoringInfo")],R),D=U=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).filterType=null,e.filterValues=null,e}return(0,u.Z)(t,[{key:"clone",value:function(){return new U({filterType:this.filterType,filterValues:(0,b.d9)(this.filterValues)})}}]),t}(L.wq);(0,d._)([(0,S.Cb)({type:String,json:{write:!0}})],D.prototype,"filterType",void 0),(0,d._)([(0,S.Cb)({type:[String],json:{write:!0}})],D.prototype,"filterValues",void 0);var V,K=D=U=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterAuthoringInfoType")],D),W=f.Z.ofType(K),J=V=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){return(0,o.Z)(this,t),r.apply(this,arguments)}return(0,u.Z)(t,[{key:"clone",value:function(){return new V({filterTypes:(0,b.d9)(this.filterTypes)})}}]),t}(L.wq);(0,d._)([(0,S.Cb)({type:W,json:{write:!0}})],J.prototype,"filterTypes",void 0);var $,H=J=V=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],J),G=f.Z.ofType(H),z=$=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).type="checkbox",e}return(0,u.Z)(t,[{key:"clone",value:function(){return new $({filterBlocks:(0,b.d9)(this.filterBlocks)})}}]),t}(N);(0,d._)([(0,S.Cb)({type:["checkbox"]})],z.prototype,"type",void 0),(0,d._)([(0,S.Cb)({type:G,json:{write:!0}})],z.prototype,"filterBlocks",void 0);var X=z=$=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],z),Y=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){return(0,o.Z)(this,t),r.apply(this,arguments)}return(0,u.Z)(t)}(L.wq);(0,d._)([(0,S.Cb)({readOnly:!0,json:{read:!1}})],Y.prototype,"type",void 0);var Q,ee=Y=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterMode")],Y),re=Q=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).type="solid",e}return(0,u.Z)(t,[{key:"clone",value:function(){return new Q}}]),t}(ee);(0,d._)([(0,S.Cb)({type:["solid"],readOnly:!0,json:{write:!0}})],re.prototype,"type",void 0);var te,ne=re=Q=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterModeSolid")],re),ie=t(27135),ae=t(68901),se=te=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).type="wire-frame",e.edges=null,e}return(0,u.Z)(t,[{key:"clone",value:function(){return new te({edges:(0,b.d9)(this.edges)})}}]),t}(ee);(0,d._)([(0,ie.J)({wireFrame:"wire-frame"})],se.prototype,"type",void 0),(0,d._)([(0,S.Cb)(ae.Z)],se.prototype,"edges",void 0);var oe,ue=se=te=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterModeWireFrame")],se),le=oe=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).type="x-ray",e}return(0,u.Z)(t,[{key:"clone",value:function(){return new oe}}]),t}(ee);(0,d._)([(0,S.Cb)({type:["x-ray"],readOnly:!0,json:{write:!0}})],le.prototype,"type",void 0);var pe,ce=le=oe=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterModeXRay")],le),ye={nonNullable:!0,types:{key:"type",base:ee,typeMap:{solid:ne,"wire-frame":ue,"x-ray":ce}},json:{read:function(e){switch(e&&e.type){case"solid":return ne.fromJSON(e);case"wireFrame":return ue.fromJSON(e);case"x-ray":return ce.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}},de=pe=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).filterExpression=null,e.filterMode=new ne,e.title="",e}return(0,u.Z)(t,[{key:"clone",value:function(){return new pe({filterExpression:this.filterExpression,filterMode:(0,b.d9)(this.filterMode),title:this.title})}}]),t}(L.wq);(0,d._)([(0,S.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],de.prototype,"filterExpression",void 0),(0,d._)([(0,S.Cb)(ye)],de.prototype,"filterMode",void 0),(0,d._)([(0,S.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],de.prototype,"title",void 0);var fe,ve=de=pe=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilterBlock")],de),he=f.Z.ofType(ve),be=fe=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).description=null,e.filterBlocks=null,e.id=(0,M.D)(),e.name=null,e}return(0,u.Z)(t,[{key:"clone",value:function(){return new fe({description:this.description,filterBlocks:(0,b.d9)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,b.d9)(this.filterAuthoringInfo)})}}]),t}(L.wq);(0,d._)([(0,S.Cb)({type:String,json:{write:!0}})],be.prototype,"description",void 0),(0,d._)([(0,S.Cb)({type:he,json:{write:{enabled:!0,isRequired:!0}}})],be.prototype,"filterBlocks",void 0),(0,d._)([(0,S.Cb)({types:{key:"type",base:N,typeMap:{checkbox:X}},json:{read:function(e){return"checkbox"===(e&&e.type)?X.fromJSON(e):null},write:!0}})],be.prototype,"filterAuthoringInfo",void 0),(0,d._)([(0,S.Cb)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],be.prototype,"id",void 0),(0,d._)([(0,S.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],be.prototype,"name",void 0);var ge=be=fe=(0,d._)([(0,I.j)("esri.layers.support.BuildingFilter")],be),me=t(76200),Ze=t(54472),we=t(67426),ke=m.Z.getLogger("esri.layers.support.BuildingSummaryStatistics"),_e=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).fieldName=null,e.modelName=null,e.label=null,e.min=null,e.max=null,e.mostFrequentValues=null,e.subLayerIds=null,e}return(0,u.Z)(t)}(L.wq);(0,d._)([(0,S.Cb)({type:String})],_e.prototype,"fieldName",void 0),(0,d._)([(0,S.Cb)({type:String})],_e.prototype,"modelName",void 0),(0,d._)([(0,S.Cb)({type:String})],_e.prototype,"label",void 0),(0,d._)([(0,S.Cb)({type:Number})],_e.prototype,"min",void 0),(0,d._)([(0,S.Cb)({type:Number})],_e.prototype,"max",void 0),(0,d._)([(0,S.Cb)({json:{read:function(e){return Array.isArray(e)&&(e.every((function(e){return"string"==typeof e}))||e.every((function(e){return"number"==typeof e})))?e.slice():null}}})],_e.prototype,"mostFrequentValues",void 0),(0,d._)([(0,S.Cb)({type:[Number]})],_e.prototype,"subLayerIds",void 0),_e=(0,d._)([(0,I.j)("esri.layers.support.BuildingFieldStatistics")],_e);var Se=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=r.apply(this,arguments)).url=null,e}return(0,u.Z)(t,[{key:"fields",get:function(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(ke.error("building summary statistics are not loaded"),null)}},{key:"load",value:function(e){var r=(0,Z.pC)(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(r)),Promise.resolve(this)}},{key:"_fetchService",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,me.default)(this.url,{query:{f:"json"},responseType:"json",signal:r});case 2:t=e.sent.data,this.read(t,{origin:"service"});case 4:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()}]),t}(Ze.Z.LoadableMixin((0,we.v)(L.wq)));(0,d._)([(0,S.Cb)({constructOnly:!0,type:String})],Se.prototype,"url",void 0),(0,d._)([(0,S.Cb)({readOnly:!0,type:[_e],json:{read:{source:"summary"}}})],Se.prototype,"fields",null);var xe=Se=(0,d._)([(0,I.j)("esri.layers.support.BuildingSummaryStatistics")],Se),Ie=t(45948),Ce=t(34785),je=m.Z.getLogger("esri.layers.BuildingSceneLayer"),Fe=f.Z.ofType(ge),Oe=(0,b.d9)(O.Z.sublayersProperty);Oe.json.origins["web-scene"]={type:[F.Z],write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}},Oe.json.origins["portal-item"]={type:[F.Z],write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}};var Ae=function(e){(0,c.Z)(t,e);var r=(0,y.Z)(t);function t(e){var n;return(0,o.Z)(this,t),(n=r.call(this,e)).operationalLayerType="BuildingSceneLayer",n.allSublayers=new v.Z({getCollections:function(){return[n.sublayers]},getChildrenFunction:function(e){return"building-group"===e.type?e.sublayers:null}}),n.sublayers=null,n.sublayerOverrides=null,n.filters=new Fe,n.activeFilterId=null,n.summaryStatistics=null,n.outFields=null,n.type="building-scene",n}return(0,u.Z)(t,[{key:"normalizeCtorArgs",value:function(e){return"string"==typeof e?{url:e}:e}},{key:"destroy",value:function(){this.allSublayers.destroy()}},{key:"readSublayers",value:function(e,r,t){var n=this,i=O.Z.readSublayers(e,r,t);return O.Z.forEachSublayer(i,(function(e){return e.layer=n})),this.sublayerOverrides&&(this.applySublayerOverrides(i,this.sublayerOverrides),this.sublayerOverrides=null),i}},{key:"applySublayerOverrides",value:function(e,r){var t=r.overrides,n=r.context;O.Z.forEachSublayer(e,(function(e){return e.read(t.get(e.id),n)}))}},{key:"readSublayerOverrides",value:function(e,r){var t,n=new Map,i=(0,s.Z)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;null!=a&&"object"==typeof a&&"number"==typeof a.id?n.set(a.id,a):r.messages.push(new h.Z("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:a}))}}catch(o){i.e(o)}finally{i.f()}return{overrides:n,context:r}}},{key:"writeSublayerOverrides",value:function(e,r,t){var n=[];O.Z.forEachSublayer(this.sublayers,(function(e){var r=e.write({},t);Object.keys(r).length>1&&n.push(r)})),n.length>0&&(r.sublayers=n)}},{key:"writeUnappliedOverrides",value:function(e,r){r.sublayers=[],e.overrides.forEach((function(e){r.sublayers.push((0,b.d9)(e))}))}},{key:"write",value:function(e,r){return e=(0,l.Z)((0,p.Z)(t.prototype),"write",this).call(this,e,r),!r||"web-scene"!==r.origin&&"portal-item"!==r.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,r):this.sublayerOverrides&&this.writeUnappliedOverrides(this.sublayerOverrides,e)),e}},{key:"read",value:function(e,r){if((0,l.Z)((0,p.Z)(t.prototype),"read",this).call(this,e,r),r&&("web-scene"===r.origin||"portal-item"===r.origin)&&null!=e&&Array.isArray(e.sublayers)){var n=this.readSublayerOverrides(e.sublayers,r);this.sublayers?this.applySublayerOverrides(this.sublayers,n):this.sublayerOverrides=n}}},{key:"readSummaryStatistics",value:function(e,r){if("string"==typeof r.statisticsHRef){var t=(0,_.v_)(this.parsedUrl.path,r.statisticsHRef);return new xe({url:t})}return null}},{key:"elevationInfo",set:function(e){this._set("elevationInfo",e),this._validateElevationInfo()}},{key:"load",value:function(e){var r=this,t=(0,Z.pC)(e)?e.signal:null,n=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(k.r9).then((function(){return r._fetchService(t)})).then((function(){return r._fetchAssociatedFeatureService(t)}));return this.addResolvingPromise(n),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,g.G)(this,(function(r){O.Z.forEachSublayer(e.sublayers,(function(e){"building-group"!==e.type&&r(e)})),e.summaryStatistics&&r(e.summaryStatistics)}))}},{key:"saveAs",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r,t){var a=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._debouncedSaveOperations(q.xp.SAVE_AS,(0,i.Z)((0,i.Z)({},t),{},{getTypeKeywords:function(){return a._getTypeKeywords()},portalItemLayerType:"building-scene"}),r));case 1:case"end":return e.stop()}}),e,this)})));return function(r,t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var r,t=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={getTypeKeywords:function(){return t._getTypeKeywords()},portalItemLayerType:"building-scene"},e.abrupt("return",this._debouncedSaveOperations(q.xp.SAVE,r));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateLayer",value:function(e){if(!e.layerType||"Building"!==e.layerType)throw new h.Z("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}},{key:"_getTypeKeywords",value:function(){return["Building"]}},{key:"_validateElevationInfo",value:function(){var e=this.elevationInfo;e&&("absolute-height"!==e.mode&&je.warn(".elevationInfo=","Building scene layers only support absolute-height elevation mode"),e.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression&&je.warn(".elevationInfo=","Building scene layers do not support featureExpressionInfo"))}},{key:"_fetchAssociatedFeatureService",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Ce.W(this.parsedUrl,this.portalItem,this.apiKey,r),e.prev=1,e.next=4,t.fetchPortalItem();case 4:this.associatedFeatureServiceItem=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),je.warn("Associated feature service item could not be loaded",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(r){return e.apply(this,arguments)}}()}]),t}((0,q.Vt)((0,B.Y)((0,T.q)((0,P.I)((0,E.M)((0,w.R)((0,A.V)(j.Z))))))));(0,d._)([(0,S.Cb)({type:["BuildingSceneLayer"]})],Ae.prototype,"operationalLayerType",void 0),(0,d._)([(0,S.Cb)({readOnly:!0})],Ae.prototype,"allSublayers",void 0),(0,d._)([(0,S.Cb)(Oe)],Ae.prototype,"sublayers",void 0),(0,d._)([(0,x.r)("service","sublayers")],Ae.prototype,"readSublayers",null),(0,d._)([(0,S.Cb)({type:Fe,nonNullable:!0,json:{write:!0}})],Ae.prototype,"filters",void 0),(0,d._)([(0,S.Cb)({type:String,json:{write:!0}})],Ae.prototype,"activeFilterId",void 0),(0,d._)([(0,S.Cb)({readOnly:!0,type:xe})],Ae.prototype,"summaryStatistics",void 0),(0,d._)([(0,x.r)("summaryStatistics",["statisticsHRef"])],Ae.prototype,"readSummaryStatistics",null),(0,d._)([(0,S.Cb)({type:[String],json:{read:!1}})],Ae.prototype,"outFields",void 0),(0,d._)([(0,S.Cb)(Ie.vg)],Ae.prototype,"fullExtent",void 0),(0,d._)([(0,S.Cb)({type:["show","hide","hide-children"]})],Ae.prototype,"listMode",void 0),(0,d._)([(0,S.Cb)((0,Ie.Lx)(C.Z))],Ae.prototype,"spatialReference",void 0),(0,d._)([(0,S.Cb)(Ie.PV)],Ae.prototype,"elevationInfo",null),(0,d._)([(0,S.Cb)({json:{read:!1},readOnly:!0})],Ae.prototype,"type",void 0),(0,d._)([(0,S.Cb)()],Ae.prototype,"associatedFeatureServiceItem",void 0);var Be=Ae=(0,d._)([(0,I.j)("esri.layers.BuildingSceneLayer")],Ae)},15801:function(e,r,t){t.d(r,{Z:function(){return Z}});var n,i=t(15671),a=t(43144),s=t(60136),o=t(29388),u=t(27366),l=t(80987),p=t(93002),c=t(51370),y=t(49861),d=(t(63780),t(93169),t(25243),t(69912)),f=t(59147),v=t(58550),h={type:l.Z,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:b}}},read:!1}};function b(e,r,t){if(e&&Array.isArray(e))return new l.Z(e.map((function(e){var r=function(e){return"group"===e.layerType?m:f.Z}(e);if(r){var n=new r;return n.read(e,t),n}t&&t.messages&&e&&t.messages.push(new c.Z("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t}))})))}var g,m=n=function(e){(0,s.Z)(t,e);var r=(0,o.Z)(t);function t(e){var n;return(0,i.Z)(this,t),(n=r.call(this,e)).type="building-group",n.listMode="show",n.sublayers=null,n}return(0,a.Z)(t,[{key:"loadAll",value:function(){var e=this;return(0,p.w)(this,(function(r){return n.forEachSublayer(e.sublayers,(function(e){"building-group"!==e.type&&r(e)}))}))}}]),t}(v.Z);(0,u._)([(0,y.Cb)({type:["hide","show","hide-children"],json:{write:!0}})],m.prototype,"listMode",void 0),(0,u._)([(0,y.Cb)(h)],m.prototype,"sublayers",void 0),m=n=(0,u._)([(0,d.j)("esri.layers.buildingSublayers.BuildingGroupSublayer")],m),(g=m||(m={})).sublayersProperty=h,g.readSublayers=b,g.forEachSublayer=function e(r,t){r.forEach((function(r){t(r),"building-group"===r.type&&e(r.sublayers,t)}))};var Z=m},34785:function(e,r,t){t.d(r,{W:function(){return v}});var n=t(29439),i=t(74165),a=t(15861),s=t(15671),o=t(43144),u=t(19545),l=t(76200),p=t(92026),c=t(66978),y=t(53894),d=t(70032),f=t(98995),v=function(){function e(r,t,n,i){(0,s.Z)(this,e),this.parsedUrl=r,this.portalItem=t,this.apiKey=n,this.signal=i,this.rootDocument=null;var a=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);a&&(this.urlParts={root:a[1],layerId:parseInt(a[2],10)})}return(0,o.Z)(e,[{key:"fetch",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r,t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.urlParts){e.next=2;break}return e.abrupt("return",null);case 2:if(null===(r=this.portalItem)||void 0===r){e.next=6;break}e.t0=r,e.next=9;break;case 6:return e.next=8,this._portalItemFromServiceItemId();case 8:e.t0=e.sent;case 9:if(t=e.t0,!(0,p.Wi)(t)){e.next=12;break}return e.abrupt("return",this._loadFromUrl());case 12:return e.next=14,this._findAndLoadRelatedPortalItem(t);case 14:return n=e.sent,e.abrupt("return",(0,p.Wi)(n)?null:this._loadFeatureLayerFromPortalItem(n));case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchPortalItem",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.urlParts){e.next=2;break}return e.abrupt("return",null);case 2:if(null===(r=this.portalItem)||void 0===r){e.next=6;break}e.t0=r,e.next=9;break;case 6:return e.next=8,this._portalItemFromServiceItemId();case 8:e.t0=e.sent;case 9:return t=e.t0,e.abrupt("return",(0,p.Wi)(t)?null:this._findAndLoadRelatedPortalItem(t));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_fetchRootDocument",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r,t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,p.pC)(this.rootDocument)){e.next=2;break}return e.abrupt("return",this.rootDocument);case 2:if(!(0,p.Wi)(this.urlParts)){e.next=4;break}return e.abrupt("return",(this.rootDocument={},{}));case 4:return r={query:{f:"json",token:this.apiKey},responseType:"json",signal:this.signal},t="".concat(this.urlParts.root,"/SceneServer"),e.prev=5,e.next=8,(0,l.default)(t,r);case 8:n=e.sent,this.rootDocument=n.data,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),this.rootDocument={};case 15:return e.abrupt("return",this.rootDocument);case 16:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"_fetchServiceOwningPortalUrl",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r,t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=null===u.id||void 0===u.id?void 0:u.id.findServerInfo(this.parsedUrl.path))||void 0===r||!r.owningSystemUrl){e.next=3;break}return e.abrupt("return",r.owningSystemUrl);case 3:return t=this.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info",e.prev=4,e.next=7,(0,l.default)(t,{query:{f:"json"},responseType:"json",signal:this.signal});case 7:if(!(n=e.sent.data.owningSystemUrl)){e.next=10;break}return e.abrupt("return",n);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),(0,c.r9)(e.t0);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"_findAndLoadRelatedPortalItem",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:this.signal});case 3:if(e.t0=e.sent.find((function(e){return"Feature Service"===e.type})),e.t0){e.next=6;break}e.t0=null;case 6:return e.abrupt("return",e.t0);case 9:return e.prev=9,e.t1=e.catch(0),e.abrupt("return",((0,c.r9)(e.t1),null));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(r){return e.apply(this,arguments)}}()},{key:"_loadFeatureLayerFromPortalItem",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(r){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.load({signal:this.signal});case 2:return e.next=4,this._findMatchingAssociatedSublayerUrl(r.url);case 4:return t=e.sent,e.abrupt("return",new y.default({url:t,portalItem:r}).load({signal:this.signal}));case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"_loadFromUrl",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._findMatchingAssociatedSublayerUrl("".concat(this.urlParts.root,"/FeatureServer"));case 2:return r=e.sent,e.abrupt("return",new y.default({url:r}).load({signal:this.signal}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_findMatchingAssociatedSublayerUrl",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(r){var t,a,s,o,u,p,c,y,d,f,v,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),a={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:this.signal},s=this.urlParts.layerId,o=this._fetchRootDocument(),u=(0,l.default)(t,a),e.next=7,Promise.all([u,o]);case 7:if(p=e.sent,c=(0,n.Z)(p,2),y=c[0],d=c[1],f=d&&d.layers,v=y.data&&y.data.layers,Array.isArray(v)){e.next=15;break}throw new Error("expected layers array");case 15:if(!Array.isArray(f)){e.next=25;break}h=0;case 17:if(!(h<Math.min(f.length,v.length))){e.next=23;break}if(f[h].id!==s){e.next=20;break}return e.abrupt("return","".concat(t,"/").concat(v[h].id));case 20:h++,e.next=17;break;case 23:e.next=27;break;case 25:if(!(s<v.length)){e.next=27;break}return e.abrupt("return","".concat(t,"/").concat(v[s].id));case 27:throw new Error("could not find matching associated sublayer");case 28:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"_portalItemFromServiceItemId",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var r,t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchRootDocument();case 2:if(r=e.sent.serviceItemId){e.next=5;break}return e.abrupt("return",null);case 5:return t=new f.default({id:r,apiKey:this.apiKey}),e.next=8,this._fetchServiceOwningPortalUrl();case 8:return n=e.sent,(0,p.pC)(n)&&(t.portal=new d.Z({url:n})),e.prev=10,e.abrupt("return",t.load({signal:this.signal}));case 14:return e.prev=14,e.t0=e.catch(10),e.abrupt("return",((0,c.r9)(e.t0),null));case 17:case"end":return e.stop()}}),e,this,[[10,14]])})));return function(){return e.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=9459.a32cccec.chunk.js.map