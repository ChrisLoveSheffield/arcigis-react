"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[6859],{30494:function(e,t,i){i.d(t,{T:function(){return o}});var a=i(74165),n=i(15861),r=i(76200),s=i(10064),l=i(92026);function o(e,t,i,a,n,r){return u.apply(this,arguments)}function u(){return u=(0,n.Z)((0,a.Z)().mark((function e(t,i,n,o,u,c){var p,h,d,v,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=null,!(0,l.pC)(n)){e.next=17;break}return h="".concat(t,"/nodepages/"),d=h+Math.floor(n.rootIndex/n.nodesPerPage),e.prev=3,e.next=6,(0,r.default)(d,{query:{f:"json",token:o},responseType:"json",signal:c});case 6:return e.t0=e.sent.data,e.t1=n.rootIndex,e.t2=n.nodesPerPage,e.t3=n.lodSelectionMetricType,e.t4=h,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),(0,l.pC)(u)&&u.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",d,e.t5),p=e.t5;case 17:if(i){e.next=19;break}return e.abrupt("return",null);case 19:return v="".concat(t,"/nodes/"),f=v+(i&&i.split("/").pop()),e.prev=20,e.next=23,(0,r.default)(f,{query:{f:"json",token:o},responseType:"json",signal:c});case 23:return e.t6=e.sent.data,e.t7=v,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new s.Z("sceneservice:root-node-missing","Root node missing.",{pageError:p,nodeError:e.t8,url:f});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),u.apply(this,arguments)}},98074:function(e,t,i){i.d(t,{p:function(){return d}});var a=i(15671),n=i(43144),r=i(60136),s=i(29388),l=i(27366),o=i(42537),u=i(92026),c=i(67426),p=i(49861),h=(i(63780),i(93169),i(25243),i(69912)),d=function(e){var t=function(e){(0,r.Z)(i,e);var t=(0,s.Z)(i);function i(){var e;return(0,a.Z)(this,i),(e=t.apply(this,arguments)).parent=null,e._userInteractive=!1,e._interactiveViewModelCount=0,e}return(0,n.Z)(i,[{key:"interactive",get:function(){return this._interactiveViewModelCount>0||this._userInteractive},set:function(e){this._userInteractive=e}},{key:"updating",get:function(){return!1}},{key:"visible",get:function(){return!(0,u.pC)(this.parent)||this.parent.visible&&!this.parent.suspended},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}},{key:"forceInteractiveForViewModel",value:function(){var e=this;return this._interactiveViewModelCount++,(0,o.kB)((function(){return e._interactiveViewModelCount--}))}}]),i}((0,c.v)(e));return(0,l._)([(0,p.Cb)({readOnly:!0})],t.prototype,"type",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],t.prototype,"analysis",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],t.prototype,"parent",void 0),(0,l._)([(0,p.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,l._)([(0,p.Cb)({type:Boolean})],t.prototype,"interactive",null),(0,l._)([(0,p.Cb)()],t.prototype,"_userInteractive",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],t.prototype,"updating",null),(0,l._)([(0,p.Cb)()],t.prototype,"visible",null),(0,l._)([(0,p.Cb)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,l._)([(0,h.j)("esri.views.3d.analysis.AnalysisView3D")],t)}},90430:function(e,t,i){i.r(t),i.d(t,{default:function(){return pe}});var a=i(74165),n=i(15861),r=i(15671),s=i(43144),l=i(60136),o=i(29388),u=i(27366),c=i(85015),p=i(92026),h=i(49861),d=(i(63780),i(93169),i(25243),i(69912)),v=i(98074),f=i(77372),y=i(100),w=i(32718),_=i(94172),g=i(82218),D=i(30651),P=i(59147),C=i(38978),b=i(33906),m=i(53379),k=w.Z.getLogger("esri.views.3d.analysis.Slice.SliceController"),M=function(e){(0,l.Z)(i,e);var t=(0,o.Z)(i);function i(e){var a;return(0,r.Z)(this,i),(a=t.call(this,e))._handles=new y.Z,a._internalChange=!1,a._currentSlicePlane=null,a.state="ready",a}return(0,s.Z)(i,[{key:"ready",get:function(){return"ready"===this.state}},{key:"initialize",value:function(){var e=this;this._handles.add(this.analysis.excludedLayers.on("before-add",(function(t){var i=t.item;null!=i&&(i instanceof D.Z||i instanceof P.Z)?i instanceof D.Z&&(0,m.xk)(i)?(k.error("excludedLayers","Layer '".concat(i.title,", id:").concat(i.id,"' of type '").concat(i.type,"' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.")),t.preventDefault()):e.analysis.excludedLayers.includes(i)&&t.preventDefault():(k.error("excludedLayers","Invalid layer type, layer must derive from Layer or BuildingComponentSublayer"),t.preventDefault())}))),function(e,t){V.has(e)||V.set(e,{all:[],activeController:null}),V.get(e).all.push(t)}(this.view,this),this._handles.add([(0,_.YP)((function(){return e.analysisViewData.plane}),(function(){e._internalChange||e._updateSlicePlaneFromBoundedPlane(),e._updateLayerViews()}),{sync:!0}),(0,_.YP)((function(){return e.analysis.excludeGroundSurface}),(function(){return e._updateLayerViews()}),{sync:!0}),this.analysis.excludedLayers.on("change",(function(){return e._updateLayerViews()})),(0,_.YP)((function(){return[e.analysisViewData.active,e.analysisViewData.visible]}),(function(){e._updateActiveController(),e._updateViewSlicePlane()}),{sync:!0}),(0,_.YP)((function(){return e._allLayerAndSubLayerViews}),(function(){return e._updateLayerViews()}))]),this._handles.add([(0,_.YP)((function(){return e.analysis.shape}),(function(){e._internalChange||(e._updateBoundedPlaneFromSlicePlane(),e._updateViewSlicePlane())}),{sync:!0})],"analysis"),this._set("state","ready"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}},{key:"destroy",value:function(){"destroyed"!==this.state&&(this.analysisViewData.active&&(this.analysisViewData.active=!1,this.view.slicePlane=null),function(e,t){if(!V.has(e))throw new Error("view expected in global slice register");var i=V.get(e),a=i.all.lastIndexOf(t);if(-1===a)throw new Error("controller expected in global slice register");i.all.splice(a,1),0===i.all.length&&V.delete(e)}(this.view,this),this._handles.destroy(),this.set("view",null),this._set("state","destroyed"))}},{key:"whenReady",value:function(){var e=(0,n.Z)((0,a.Z)().mark((function e(){var t=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.N1)((function(){return t.ready}));case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_allLayerAndSubLayerViews",get:function(){var e=this.view.allLayerViews.items;return e.concat(e.filter(C.lR).flatMap((function(e){return e.sublayerViews.items})))}},{key:"_updateBoundedPlaneFromSlicePlane",value:function(){var e=this.analysis.shape,t=this._currentSlicePlane;if(!((0,p.Wi)(t)&&(0,p.Wi)(e)||(0,p.pC)(t)&&(0,p.pC)(e)&&e.equals(t))){var i=null,a=null;if((0,p.pC)(e)&&(0,p.pC)(e.position)){var n=e.position.spatialReference,r=(0,C.m3)(e,this.view);(0,p.Wi)(r)&&(0,b.e)(this.analysis,n,k),i=(0,C.oP)(r,this.view,{tiltEnabled:this.analysis.tiltEnabled},(0,g.c)()),(0,p.pC)(i)&&(a={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height})}this._currentSlicePlane=a,this._internalChange=!0,this.analysisViewData.plane=i,this._internalChange=!1}}},{key:"_updateSlicePlaneFromBoundedPlane",value:function(){var e=this.analysisViewData.plane,t=(0,C.Hq)(e,this.view,this.view.spatialReference,new f.Z),i=null;(0,p.pC)(t)&&(i={heading:t.heading,tilt:t.tilt,position:t.position,width:t.width,height:t.height}),this._currentSlicePlane=i,this._internalChange=!0,this.analysis.shape=t,this._internalChange=!1,this._updateViewSlicePlane()}},{key:"_updateActiveController",value:function(){if(!A){var e=T(this.view);if(this.analysisViewData.active)(0,p.pC)(e.activeController)&&e.activeController!==this?(A=!0,e.activeController.analysisViewData.active=!1,A=!1):(0,p.pC)(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if((0,p.pC)(e.activeController)&&e.activeController!==this)return;(0,p.pC)(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}}},{key:"_updateViewSlicePlane",value:function(){"ready"===this.state&&function(e){var t=T(e).activeController;(0,p.pC)(t)&&(0,p.pC)(t.analysisViewData.plane)&&t.analysisViewData.visible?e.slicePlane=t.analysisViewData.plane:e.slicePlane=null}(this.view)}},{key:"_updateLayerViews",value:function(){var e=(0,p.pC)(this.analysisViewData.plane)&&this.analysisViewData.visible&&this.analysisViewData.active,t=[];this.analysis.excludedLayers.forEach((function e(i){"layers"in i?i.layers.forEach(e):t.push(i)})),this.view.allLayerViews.forEach((function(i){i.destroyed||("slicePlaneEnabled"in i&&(i.slicePlaneEnabled=e&&!t.includes(i.layer)),"sublayerViews"in i&&i.sublayerViews.forEach((function(i){i.slicePlaneEnabled=e&&!t.includes(i.sublayer)})))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.analysis.excludeGroundSurface)}}]),i}(c.Z);(0,u._)([(0,h.Cb)({readOnly:!0})],M.prototype,"state",void 0),(0,u._)([(0,h.Cb)()],M.prototype,"view",void 0),(0,u._)([(0,h.Cb)()],M.prototype,"analysis",void 0),(0,u._)([(0,h.Cb)()],M.prototype,"analysisViewData",void 0),(0,u._)([(0,h.Cb)()],M.prototype,"ready",null),(0,u._)([(0,h.Cb)()],M.prototype,"_allLayerAndSubLayerViews",null),M=(0,u._)([(0,d.j)("esri.views.3d.analysis.Slice.SliceController")],M);var V=new Map,A=!1;function T(e){return V.get(e)}var E=i(1413),S=i(84702),x=i(99346),R=i(17842),H=i(14226),Z=i(11186),z=i(71353),I=i(55652),L=i(40885),G=i(51378),W=i(3319),O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC",Q="data:image/png;base64,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",U=i(1487),B={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};var N,Y=i(60142),q=i(51328),j=i(81703),F=i(88153),K=i(54463),X=i(86509),J=i(5693),$=i(72612),ee=N=function(e){(0,l.Z)(i,e);var t=(0,o.Z)(i);function i(e){var a;return(0,r.Z)(this,i),(a=t.call(this,e)).clock=S.m,a._previewPlaneOpacity=1,a.removeIncompleteOnCancel=!1,a.layersMode="none",a.shiftManipulator=null,a.rotateHeadingManipulator=null,a.rotateTiltManipulator=null,a.resizeManipulators=null,a._handles=new y.Z,a._viewHandles=new y.Z,a._frameTask=null,a._pointerMoveTimerMs=W.N3,a._prevPointerMoveTimeout=null,a._previewPlaneGridVisualElement=null,a._previewPlaneOutlineVisualElement=null,a._startPlane=(0,g.c)(),a._previewPlane=null,a._activeKeyModifiers={},a._lastCursorPosition=(0,R.vW)(),a._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],a._intersector=(0,F.Z8)(e.view.state.viewingMode),a._intersector.options.store=K.eC.MIN,a}return(0,s.Z)(i,[{key:"initialize",value:function(){var e=this;if(null==this.analysis)throw new Error("SliceTool requires valid analysis, but null was provided.");this.rotateHeadingImage=function(e){return e.fromData(O,(function(){return new U.x(O,B)}))}(this.view.toolViewManager.textures),this.rotateTiltImage=function(e){return e.fromData(Q,(function(){return new U.x(Q,B)}))}(this.view.toolViewManager.textures);var t=function(t){e._updateManipulatorsInteractive(t),t.grabbing||((0,p.pC)(e.analysisViewData.plane)&&(0,g.a)(e.analysisViewData.plane,e._startPlane),e.inputState=null)};this.shiftManipulator=(0,C.Pt)(this.view),this.manipulators.add(this.shiftManipulator),this.shiftManipulator.events.on("grab-changed",(function(i){e._onShiftGrab(i),t(e.shiftManipulator)})),this._handles.add(this._createShiftDragPipeline(this.shiftManipulator)),this.rotateHeadingManipulator=(0,C.Ju)(this.view,this.rotateHeadingImage.texture),this.manipulators.add(this.rotateHeadingManipulator),this.rotateHeadingManipulator.events.on("grab-changed",(function(i){e._onRotateHeadingGrab(i),t(e.rotateHeadingManipulator)})),this._handles.add(this._createRotateHeadingDragPipeline(this.rotateHeadingManipulator)),this.rotateTiltManipulator=(0,C.Ju)(this.view,this.rotateTiltImage.texture),this.manipulators.add(this.rotateTiltManipulator),this.rotateTiltManipulator.events.on("grab-changed",(function(i){e._onRotateTiltGrab(i),t(e.rotateTiltManipulator)})),this._handles.add(this._createRotateTiltDragPipeline(this.rotateTiltManipulator)),this.resizeManipulators=this._resizeHandles.map((function(i,a){var n=(0,C.vw)(e.view,i);return n.events.on("grab-changed",(function(i){e._onResizeGrab(i,a),t(n)})),e._handles.add(e._createResizeDragPipeline(n)),n})),this.manipulators.addMany(this.resizeManipulators),this._previewPlaneGridVisualElement=(0,C.R_)(this.view),this._previewPlaneOutlineVisualElement=(0,C.i3)(this.view),this._previewPlaneOutlineVisualElement.width=W.q7,this._handles.add((0,_.YP)((function(){return e.analysisViewData.plane}),(function(){return e._updateManipulators()}),_.Z_));var i=(0,_.YP)((function(){return e.state}),(function(t){"sliced"===t&&e.finishToolCreation()}),_.tX);this._handles.add([i,(0,_.YP)((function(){return e.view.state.camera}),(function(){return e._onCameraChange()}))])}},{key:"destroy",value:function(){this.rotateHeadingImage=(0,p.RY)(this.rotateHeadingImage),this.rotateTiltImage=(0,p.RY)(this.rotateTiltImage),this._handles=(0,p.SC)(this._handles),this._viewHandles=(0,p.SC)(this._viewHandles),this._removeFrameTask(),this._clearPointerMoveTimeout(),this._previewPlaneOutlineVisualElement=(0,p.SC)(this._previewPlaneOutlineVisualElement),this._previewPlaneGridVisualElement=(0,p.SC)(this._previewPlaneGridVisualElement)}},{key:"state",get:function(){var e=!!this.analysisViewData.plane,t=!!this.inputState;return e?e&&t?"slicing":e&&!t?"sliced":"ready":"ready"}},{key:"cursor",get:function(){return this._isPlacingSlicePlane||"exclude"===this.layersMode?"crosshair":(0,p.pC)(this._creatingPointerId)?"grabbing":null}},{key:"analysis",set:function(e){if(null==e)throw new Error("SliceTool requires valid analysis, but null was provided.");this._handles.remove("analysis"),this._set("analysis",e)}},{key:"inputState",get:function(){return this._get("inputState")},set:function(e){this._set("inputState",e),this.analysisViewData.showGrid=(0,p.pC)(e)&&"resize"===e.type,this._updateMaterials()}},{key:"_isPlacingSlicePlane",get:function(){return!this.inputState&&!this.analysisViewData.plane&&this.active}},{key:"_creatingPointerId",get:function(){return(0,p.pC)(this.inputState)&&"shift"===this.inputState.type?this.inputState.creatingPointerId:null}},{key:"enterExcludeLayerMode",value:function(){(0,p.Wi)(this.analysisViewData.plane)||(this._set("layersMode","exclude"),this.active||(this.view.activeTool=this))}},{key:"exitExcludeLayerMode",value:function(){(0,p.Wi)(this.analysisViewData.plane)||(this._set("layersMode","none"),this.active&&(this.view.activeTool=null))}},{key:"onDeactivate",value:function(){this._set("layersMode","none"),this._updatePreviewPlane(null)}},{key:"onShow",value:function(){this._updateVisibility(!0)}},{key:"onHide",value:function(){this._updateVisibility(!1)}},{key:"_updateVisibility",value:function(e){this.shiftManipulator&&(this._updateManipulators(),e||this._clearPointerMoveTimeout())}},{key:"onInputEvent",value:function(e){switch(e.type){case"pointer-drag":if(!ie(e))return;this._isPlacingSlicePlane?this._onClickPlacePlane(e)&&e.stopPropagation():this._onPointerDrag(e)&&e.stopPropagation();break;case"pointer-move":this._onPointerMove(e);break;case"pointer-up":this._onPointerUp(e)&&e.stopPropagation();break;case"immediate-click":if(!ie(e))return;this._onClickPlacePlane(e)&&e.stopPropagation();break;case"click":if(!ie(e))return;this._onClickExcludeLayer(e)&&e.stopPropagation();break;case"drag":this.inputState&&e.stopPropagation();break;case"key-down":this._onKeyDown(e)&&e.stopPropagation();break;case"key-up":this._onKeyUp(e)&&e.stopPropagation()}}},{key:"onEditableChange",value:function(){this.analysisViewData.editable=this.editable}},{key:"_onPointerDrag",value:function(e){var t=this.inputState;if(e.pointerId===this._creatingPointerId&&(0,p.pC)(t)&&"shift"===t.type){var i=(0,$.vT)(e);return this.shiftManipulator.events.emit("drag",{action:t.hasBeenDragged?"update":"start",pointerType:e.pointerType,start:i,screenPoint:i}),t.hasBeenDragged=!0,!0}return!1}},{key:"_onPointerMove",value:function(e){this._lastCursorPosition.x=e.x,this._lastCursorPosition.y=e.y,this._resetPointerMoveTimeout(),"touch"!==e.pointerType&&this._updatePreviewPlane((0,$.vT)(e),this._activeKeyModifiers)}},{key:"_onCameraChange",value:function(){this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),this._updateManipulators()}},{key:"_onPointerUp",value:function(e){if(e.pointerId===this._creatingPointerId&&(0,p.pC)(this.analysisViewData.plane)){var t=(0,$.vT)(e);return this.shiftManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),(0,g.a)(this.analysisViewData.plane,this._startPlane),this.inputState=null,!0}return!1}},{key:"_onClickPlacePlane",value:function(e){if("exclude"===this.layersMode)return!1;if(this._isPlacingSlicePlane){var t=(0,$.vT)(e),i=(0,g.c)();if(this._pickPlane(t,!1,this._activeKeyModifiers,i)){if((0,g.a)(i,this._startPlane),this.analysis.shape=(0,C.Hq)(i,this.view,this.view.spatialReference,new f.Z),"pointer-drag"===e.type){var a=this._calculatePickRay(t);this.inputState=te(a,e.pointerId,i.origin,i)}return!0}}return!1}},{key:"_onClickExcludeLayer",value:function(e){var t=this;return!("exclude"!==this.layersMode||!this.created)&&(this.view.hitTest((0,$.vT)(e)).then((function(e){if(e.results.length){var i=e.results[0],a="graphic"===(null===i||void 0===i?void 0:i.type)&&i.graphic;if(a){var n=a.sourceLayer||a.layer;n&&t.analysis.excludedLayers.push(n)}}else e.ground.layer?t.analysis.excludedLayers.push(e.ground.layer):t.analysis.excludeGroundSurface=!0})),this._set("layersMode","none"),this.active&&(this.view.activeTool=null),!0)}},{key:"_onKeyDown",value:function(e){return(e.key===W.GI||e.key===W.tW)&&(this._activeKeyModifiers[e.key]=!0,(0,p.pC)(this._previewPlane)&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)}},{key:"_onKeyUp",value:function(e){return!(e.key!==W.GI&&e.key!==W.tW||!this._activeKeyModifiers[e.key])&&(delete this._activeKeyModifiers[e.key],(0,p.pC)(this._previewPlane)&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)}},{key:"_onShiftGrab",value:function(e){if("start"===e.action&&!(0,p.Wi)(this.analysisViewData.plane)){var t=this._calculatePickRay(e.screenPoint);(0,g.a)(this.analysisViewData.plane,this._startPlane),this.inputState=te(t,null,this.shiftManipulator.renderLocation,this.analysisViewData.plane)}}},{key:"_createShiftDragPipeline",value:function(e){var t=this;return(0,J.Xd)(e,(function(e,i,a){var n=t.inputState;if(!(0,p.Wi)(n)&&"shift"===n.type){var r=(0,p.pC)(t.analysisViewData.plane)?(0,g.a)(t.analysisViewData.plane,(0,g.c)()):null;i.next((0,q._N)(t.view,n.shiftPlane)).next(t._shiftDragAdjustSensitivity(n)).next(t._shiftDragUpdatePlane(n)),a.next((function(){(0,p.pC)(r)&&t._updateBoundedPlane(r)}))}}))}},{key:"_shiftDragAdjustSensitivity",value:function(e){var t=this;return function(i){if((0,p.Wi)(t.analysisViewData.plane))return null;var a=Math.min((1-Math.abs((0,Z.e)((0,g.n)(t.analysisViewData.plane),i.ray.direction)/(0,Z.l)(i.ray.direction)))/.001,1),n=-(0,I.jH)(t._startPlane.plane,i.renderEnd),r=-(0,I.jH)(t._startPlane.plane,e.startPoint);return e.depth=e.depth*(1-a)+n*a-r,i}}},{key:"_shiftDragUpdatePlane",value:function(e){var t=this;return function(){if(!(0,p.Wi)(t.analysisViewData.plane)){var i=(0,Z.c)(G.WM.get(),t._startPlane.origin),a=(0,Z.c)(G.WM.get(),(0,g.n)(t._startPlane));(0,Z.g)(a,a,-e.depth),(0,Z.a)(a,a,i);var n=(0,g.f)(a,t.analysisViewData.plane.basis1,t.analysisViewData.plane.basis2,(0,g.c)());t._updateBoundedPlane(n)}}}},{key:"_onRotateHeadingGrab",value:function(e){if("start"===e.action&&!(0,p.Wi)(this.analysisViewData.plane)){var t=(0,C.Rd)(this.analysisViewData.plane,this.view.renderCoordsHelper,C.aZ.HEADING,(0,I.Ue)()),i=this._calculatePickRay(e.screenPoint),a=(0,z.c)();(0,I.BR)(t,i,a)&&((0,g.a)(this.analysisViewData.plane,this._startPlane),this.inputState={type:"rotate",rotatePlane:t,startPoint:a})}}},{key:"_createRotateHeadingDragPipeline",value:function(e){var t=this;return(0,J.Xd)(e,(function(e,i,a){var n=t.inputState;if(!(0,p.Wi)(n)&&"rotate"===n.type){var r=(0,p.pC)(t.analysisViewData.plane)?(0,g.a)(t.analysisViewData.plane,(0,g.c)()):null;i.next((0,q._N)(t.view,n.rotatePlane)).next(t._rotateDragRenderPlaneToRotate(n)).next(t._rotateDragUpdatePlaneFromRotate()),a.next((function(){(0,p.pC)(r)&&t._updateBoundedPlane(r)}))}}))}},{key:"_onRotateTiltGrab",value:function(e){if("start"===e.action&&!(0,p.Wi)(this.analysisViewData.plane)){var t=(0,C.Rd)(this.analysisViewData.plane,this.view.renderCoordsHelper,C.aZ.TILT,(0,I.Ue)()),i=this._calculatePickRay(e.screenPoint),a=(0,z.c)();(0,I.BR)(t,i,a)&&((0,g.a)(this.analysisViewData.plane,this._startPlane),this.inputState={type:"rotate",rotatePlane:t,startPoint:a})}}},{key:"_createRotateTiltDragPipeline",value:function(e){var t=this;return(0,J.Xd)(e,(function(e,i,a){var n=t.inputState;if(!(0,p.Wi)(n)&&"rotate"===n.type){var r=(0,p.pC)(t.analysisViewData.plane)?(0,g.a)(t.analysisViewData.plane,(0,g.c)()):null;i.next((0,q._N)(t.view,n.rotatePlane)).next(t._rotateDragRenderPlaneToRotate(n)).next(t._rotateDragUpdatePlaneFromRotate()),a.next((function(){(0,p.pC)(r)&&t._updateBoundedPlane(r)}))}}))}},{key:"_rotateDragRenderPlaneToRotate",value:function(e){var t=this;return function(i){if((0,p.Wi)(t.analysisViewData.plane))return null;var a=(0,I.mJ)(e.rotatePlane),n=(0,Y.Gd)(e.startPoint,i.renderEnd,t.analysisViewData.plane.origin,a);return(0,E.Z)((0,E.Z)({},i),{},{rotateAxis:a,rotateAngle:n})}}},{key:"_rotateDragUpdatePlaneFromRotate",value:function(){var e=this;return function(t){if(!(0,p.Wi)(e.analysisViewData.plane)){var i=(0,H.d)(G.MP.get(),t.rotateAngle,t.rotateAxis);if(!(0,p.Wi)(i)){var a=(0,Z.m)(G.WM.get(),e._startPlane.basis1,i),n=(0,Z.m)(G.WM.get(),e._startPlane.basis2,i),r=(0,g.f)(e.analysisViewData.plane.origin,a,n,(0,g.c)());e._updateBoundedPlane(r)}}}}},{key:"_onResizeGrab",value:function(e,t){if("start"===e.action&&!(0,p.Wi)(this.analysisViewData.plane)){var i=this._calculatePickRay(e.screenPoint),a=G.WM.get();(0,I.BR)(this.analysisViewData.plane.plane,i,a)&&((0,g.a)(this.analysisViewData.plane,this._startPlane),this.inputState={type:"resize",activeHandleIdx:t,startPoint:(0,z.a)(a)})}}},{key:"_createResizeDragPipeline",value:function(e){var t=this;return(0,J.Xd)(e,(function(e,i,a){var n=t.inputState;if(!(0,p.Wi)(n)&&"resize"===n.type&&!(0,p.Wi)(t.analysisViewData.plane)){var r=(0,g.a)(t.analysisViewData.plane,(0,g.c)());i.next((0,q._N)(t.view,t.analysisViewData.plane.plane)).next(t._resizeDragUpdatePlane(n)),a.next((function(){t._updateBoundedPlane(r)}))}}))}},{key:"_resizeDragUpdatePlane",value:function(e){var t=this;return function(i){if(!(0,p.Wi)(t.analysisViewData.plane)){var a=t._resizeHandles[e.activeHandleIdx],n=(0,C.Q3)(a,e.startPoint,i.renderEnd,t.view.state.camera,t._startPlane,(0,g.a)(t.analysisViewData.plane));t._updateBoundedPlane(n)}}}},{key:"_updateBoundedPlane",value:function(e){var t=this.analysisViewData;if(!(0,p.pC)(t))throw new Error("valid internal object expected");t.plane=e}},{key:"_updatePreviewPlane",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this._previewPlane;if(this._previewPlane=null,(0,p.Wi)(e))return this._removeFrameTask(),void this._updateManipulators();if(!this.analysisViewData.plane&&this.active){var n=(0,p.pC)(a)?a:(0,g.c)();if(a=(0,p.pC)(a)?(0,g.a)(a,ae):null,this._pickPlane(e,!0,i,n)){var r=W.Vj,s=!1;(0,p.pC)(a)&&(s=(0,Z.e)(a.plane,n.plane)<r||(0,Z.e)((0,Z.n)(G.WM.get(),a.basis1),(0,Z.n)(G.WM.get(),n.basis1))<r),s&&(this._previewPlaneOpacity=0),this._previewPlane=n}}(0,p.pC)(this._previewPlane)&&(0,p.Wi)(this._frameTask)&&0===this._previewPlaneOpacity?this._frameTask=(0,x.A)({update:function(e){var i=e.deltaTime;t._previewPlaneOpacity=Math.min(t._previewPlaneOpacity+i/(1e3*W.Fj),1),t._updateManipulators(),1===t._previewPlaneOpacity&&t._removeFrameTask()}}):(0,p.Wi)(this._previewPlane)&&(0,p.pC)(this._frameTask)?this._removeFrameTask():(0,p.pC)(this._previewPlane)&&this._updateManipulators()}},{key:"_removeFrameTask",value:function(){this._frameTask=(0,p.hw)(this._frameTask)}},{key:"_calculatePickRay",value:function(e){var t=(0,L.Ue)(),i=(0,R.md)(e,ne);return(0,j.u4)(this.view.state.camera,i,t),(0,Z.n)(t.direction,t.direction),t}},{key:"_pickMinResult",value:function(e){var t=(0,R.md)(e,G.qW.get());return this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector),this._intersector.results.min}},{key:"_pickPlane",value:function(e,t,i,a){var n=this._pickMinResult(e),r=G.WM.get();if(!n.getIntersectionPoint(r))return!1;var s=n.getTransformedNormal(G.WM.get()),l=this.view.state.camera;(0,Z.e)(s,l.viewForward)>0&&(0,Z.g)(s,s,-1);var o=(0,C.fT)(r,l),u=(t?1:-1)*o*W.go,c=(0,Z.g)(G.WM.get(),s,u);(0,Z.a)(c,c,r);var p=this.analysis.tiltEnabled?C.ww.TILTED:C.ww.HORIZONTAL_OR_VERTICAL,h=i[W.GI]?C.ww.VERTICAL:i[W.tW]?C.ww.HORIZONTAL:p;return(0,C.j6)(c,s,o,o,l,h,this.view.renderCoordsHelper,a),!0}},{key:"_clearPointerMoveTimeout",value:function(){this._prevPointerMoveTimeout=(0,p.hw)(this._prevPointerMoveTimeout)}},{key:"_resetPointerMoveTimeout",value:function(){var e=this;this._clearPointerMoveTimeout(),this.shiftManipulator.state|=C.do,this.rotateHeadingManipulator.state|=C.do,this.rotateTiltManipulator.state|=C.do,this._prevPointerMoveTimeout=this.clock.setTimeout((function(){e.shiftManipulator.state&=~C.do,e.rotateHeadingManipulator.state&=~C.do,e.rotateTiltManipulator.state&=~C.do}),this._pointerMoveTimerMs)}},{key:"_updateManipulators",value:function(){var e=this;if(!N.disableEngineLayers){var t=null,i=!1;if((0,p.pC)(this.analysisViewData.plane))t=this.analysisViewData.plane,i=!1;else{if(!(0,p.pC)(this._previewPlane))return this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach((function(e){return e.available=!1})),this._previewPlaneOutlineVisualElement.visible=!1,void(this._previewPlaneGridVisualElement.visible=!1);t=this._previewPlane,i=!0}var a=(0,C.zY)(t,G.MP.get());i?(this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach((function(e){return e.available=!1})),this._previewPlaneOutlineVisualElement.visible=!0,this._previewPlaneGridVisualElement.visible=!0):(this.shiftManipulator.available=!0,this.rotateHeadingManipulator.available=!0,this.rotateTiltManipulator.available=this.analysis.tiltEnabled,this.resizeManipulators.forEach((function(e){return e.available=!0})),(0,C.tF)(this.shiftManipulator,a,t,this.view.state.camera),(0,C.A5)(this.rotateHeadingManipulator,a,t,this.view.renderCoordsHelper),(0,C.wj)(this.rotateTiltManipulator,a,t),this.resizeManipulators.forEach((function(i,n){return(0,C.EC)(i,e._resizeHandles[n],a,t)})),this._previewPlaneOutlineVisualElement.visible=!1,this._previewPlaneGridVisualElement.visible=!1);var n=(0,Z.s)(G.WM.get(),(0,Z.l)(t.basis1),(0,Z.l)(t.basis2),1),r=(0,H.u)(G.MP.get(),n),s=(0,H.m)(r,a,r);this._previewPlaneOutlineVisualElement.transform=s,this._previewPlaneGridVisualElement.transform=s,this._updateMaterials()}}},{key:"_updateMaterials",value:function(){var e=[W.hf[0],W.hf[1],W.hf[2],W.hf[3]*this._previewPlaneOpacity];this._previewPlaneOutlineVisualElement.color=e;var t=[W.wk[0],W.wk[1],W.wk[2],W.wk[3]*this._previewPlaneOpacity];this._previewPlaneGridVisualElement.backgroundColor=t,this._previewPlaneGridVisualElement.gridColor=[0,0,0,0]}},{key:"_updateManipulatorsInteractive",value:function(e){if(!e.grabbing)return this.shiftManipulator.interactive=!0,this.rotateHeadingManipulator.interactive=!0,this.rotateTiltManipulator.interactive=!0,void this.resizeManipulators.forEach((function(e){e.interactive=!0}));this.shiftManipulator.interactive=this.shiftManipulator===e,this.rotateHeadingManipulator.interactive=this.rotateHeadingManipulator===e,this.rotateTiltManipulator.interactive=this.rotateTiltManipulator===e,this.resizeManipulators.forEach((function(t){t.interactive=t===e}))}},{key:"testData",value:function(){var e=this;return{plane:this.analysisViewData.plane,setPointerMoveTimerMs:function(t){e._pointerMoveTimerMs=t}}}}]),i}(X.f);function te(e,t,i,a){var n=(0,C.TA)(i,(0,g.n)(a),e.direction,(0,I.Ue)()),r=(0,z.c)();return(0,I.BR)(n,e,r)?{type:"shift",creatingPointerId:t,hasBeenDragged:!1,shiftPlane:n,depth:0,startPoint:r}:null}function ie(e){return"mouse"!==e.pointerType||0===e.button}ee.disableEngineLayers=!1,(0,u._)([(0,h.Cb)()],ee.prototype,"clock",void 0),(0,u._)([(0,h.Cb)({constructOnly:!0})],ee.prototype,"view",void 0),(0,u._)([(0,h.Cb)()],ee.prototype,"analysisViewData",void 0),(0,u._)([(0,h.Cb)({readOnly:!0})],ee.prototype,"state",null),(0,u._)([(0,h.Cb)({readOnly:!0})],ee.prototype,"cursor",null),(0,u._)([(0,h.Cb)()],ee.prototype,"analysis",null),(0,u._)([(0,h.Cb)()],ee.prototype,"removeIncompleteOnCancel",void 0),(0,u._)([(0,h.Cb)({readOnly:!0})],ee.prototype,"layersMode",void 0),(0,u._)([(0,h.Cb)({value:null})],ee.prototype,"inputState",null),(0,u._)([(0,h.Cb)()],ee.prototype,"_isPlacingSlicePlane",null),(0,u._)([(0,h.Cb)()],ee.prototype,"_creatingPointerId",null),ee=N=(0,u._)([(0,d.j)("esri.views.3d.analysis.Slice.SliceTool")],ee);var ae=(0,g.c)(),ne=(0,R.s1)(),re=ee,se=i(67077),le=i(86700),oe=function(e){(0,l.Z)(i,e);var t=(0,o.Z)(i);function i(e){var a;return(0,r.Z)(this,i),(a=t.call(this,e))._handles=new y.Z,a._gridVisualElement=null,a._outlineVisualElement=null,a.state="pending",a.showGrid=!1,a.preview=!0,a}return(0,s.Z)(i,[{key:"ready",get:function(){return"ready"===this.state}},{key:"initialize",value:function(){this._initialize()}},{key:"_initialize",value:function(){var e=(0,n.Z)((0,a.Z)().mark((function e(){var t,i=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("destroyed"!==this.state&&"ready"!==this.state){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,_.N1)((function(){return i.view.ready}));case 4:if(t=this.analysisViewData,!(0,p.Wi)(t)){e.next=7;break}throw new Error("expected internal object to be valid");case 7:this._gridVisualElement=(0,C.R_)(this.view),this._outlineVisualElement=(0,C.i3)(this.view),this._handles.add([(0,_.YP)((function(){return{visible:(0,p.pC)(t.plane)&&i.analysisViewData.visible,active:i.analysisViewData.active,preview:i.preview,showGrid:i.showGrid}}),(function(e){return i._updateMaterials(e)}),_.tX),(0,_.YP)((function(){return t.plane}),(function(e){return i._updatePlane(e)}),_.tX)],"internal"),this._set("state","ready");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){"destroyed"!==this.state&&"pending"!==this.state&&(this._handles.destroy(),this._gridVisualElement=(0,p.SC)(this._gridVisualElement),this._outlineVisualElement=(0,p.SC)(this._outlineVisualElement),this.set("view",null),this._set("state","destroyed"))}},{key:"whenReady",value:function(){var e=(0,n.Z)((0,a.Z)().mark((function e(){var t=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.N1)((function(){return t.view.ready}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_updatePlane",value:function(e){if(!(0,p.Wi)(e)){var t=(0,Z.s)(G.WM.get(),(0,Z.l)(e.basis1),(0,Z.l)(e.basis2),1),i=(0,H.u)(G.MP.get(),t),a=(0,C.zY)(e,G.MP.get()),n=(0,H.m)(i,a,i);this._outlineVisualElement.transform=n,this._gridVisualElement.transform=n}}},{key:"_updateMaterials",value:function(e){var t=e.visible,i=e.active,a=e.preview,n=e.showGrid;this._outlineVisualElement.color=W.hf,this._outlineVisualElement.width=a?W.q7:W.kq,this._outlineVisualElement.stipplePattern=i?null:(0,le.z5)(5),this._gridVisualElement.backgroundColor=W.wk,this._gridVisualElement.gridColor=n?W.A:se.Z,this._gridVisualElement.visible=t,this._outlineVisualElement.visible=t}}]),i}(c.Z);(0,u._)([(0,h.Cb)({readOnly:!0})],oe.prototype,"state",void 0),(0,u._)([(0,h.Cb)()],oe.prototype,"view",void 0),(0,u._)([(0,h.Cb)()],oe.prototype,"analysis",void 0),(0,u._)([(0,h.Cb)()],oe.prototype,"analysisViewData",void 0),(0,u._)([(0,h.Cb)()],oe.prototype,"ready",null),(0,u._)([(0,h.Cb)()],oe.prototype,"showGrid",void 0),(0,u._)([(0,h.Cb)()],oe.prototype,"preview",void 0),oe=(0,u._)([(0,d.j)("esri.views.3d.analysis.Slice.SliceVisualization")],oe);var ue=i(70209),ce=function(e){(0,l.Z)(i,e);var t=(0,o.Z)(i);function i(e){var a;return(0,r.Z)(this,i),(a=t.call(this,e)).type="slice-view-3d",a.analysis=null,a.tool=null,a.analysisVisualization=null,a.analysisController=null,a.plane=null,a.active=!0,a.showGrid=!1,a}return(0,s.Z)(i,[{key:"initialize",value:function(){this.analysisVisualization=new oe({view:this.view,analysis:this.analysis,analysisViewData:this}),this.analysisController=new M({view:this.view,analysis:this.analysis,analysisViewData:this}),this.own((0,ue.Lp)(this,re))}},{key:"destroy",value:function(){(0,ue.Yq)(this),this.analysisVisualization=(0,p.SC)(this.analysisVisualization),this.analysisController=(0,p.SC)(this.analysisController)}},{key:"editable",get:function(){return!this.analysisVisualization.preview},set:function(e){this.analysisVisualization.preview=!e}},{key:"when",value:function(){var e=(0,n.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.analysisVisualization.whenReady();case 2:return e.next=4,this.analysisController.whenReady();case 4:return e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"testData",get:function(){return{visualization:this.analysisVisualization,controller:this.analysisController,tool:(0,p.Wg)(this.tool)}}}]),i}((0,v.p)(c.Z));(0,u._)([(0,h.Cb)({readOnly:!0})],ce.prototype,"type",void 0),(0,u._)([(0,h.Cb)({constructOnly:!0,nonNullable:!0})],ce.prototype,"analysis",void 0),(0,u._)([(0,h.Cb)()],ce.prototype,"tool",void 0),(0,u._)([(0,h.Cb)()],ce.prototype,"plane",void 0),(0,u._)([(0,h.Cb)()],ce.prototype,"active",void 0),(0,u._)([(0,h.Cb)({aliasOf:"analysisVisualization.showGrid"})],ce.prototype,"showGrid",void 0),(0,u._)([(0,h.Cb)()],ce.prototype,"editable",null);var pe=ce=(0,u._)([(0,d.j)("esri.views.3d.analysis.SliceAnalysisView3D")],ce)},51328:function(e,t,i){i.d(t,{J4:function(){return w},_N:function(){return f},gv:function(){return _}});var a,n=i(1413),r=i(92026),s=i(17842),l=(i(11186),i(71353)),o=(i(79803),i(55652)),u=i(40885),c=(i(40927),i(51378)),p=(i(74509),i(81703)),h=i(88153),d=i(54463),v=i(76783);i(5693);function f(e,t){return y(e,(function(){return t}))}function y(e,t){var i=(0,l.c)(),a=(0,l.c)(),u=!1;return function(l){var h=t(l);if("start"===l.action){var d=(0,s.md)(l.screenStart,(0,s.c$)(c.qW.get())),v=(0,p.u4)(e.state.camera,d,g);(0,r.pC)(v)&&(u=(0,o.BR)(h,v,i))}if(!u)return null;var f=(0,s.md)(l.screenEnd,(0,s.c$)(c.qW.get())),y=(0,p.u4)(e.state.camera,f,g);return(0,r.Wi)(y)?null:(0,o.BR)(h,y,a)?(0,n.Z)((0,n.Z)({},l),{},{renderStart:i,renderEnd:a,plane:h,ray:y}):null}}function w(e){var t=null;return function(i){switch(i.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":(0,r.pC)(t)&&(t.remove(),t=null)}return i}}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=(0,h.Z8)(e.state.viewingMode);i.options.selectionMode=!0,i.options.store=d.eC.MIN,i.options.hud=!1;var o,u=(0,s.s1)(),c={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},p=(0,l.c)(),f=(0,r.Pt)(t,e.spatialReference),y=function(t){e.map.ground&&e.map.ground.opacity<1?c.exclude.add(v.cy):c.exclude.delete(v.cy),e.sceneIntersectionHelper.intersectIntersectorScreen((0,s.md)(t,u),i,c);var n,r=i.results.min;if(r.getIntersectionPoint(p))n=r.intersector===d.q7.TERRAIN?a.GROUND:a.OTHER;else{if(!i.results.ground.getIntersectionPoint(p))return null;n=a.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(p,f),surfaceType:n}};return function(e){if("start"===e.action){var t=y(e.screenStart);o=(0,r.pC)(t)?t.location:null}if((0,r.Wi)(o))return null;var i=y(e.screenEnd);return(0,r.pC)(i)&&(0,r.pC)(i.location)?(0,n.Z)((0,n.Z)({},e),{},{mapStart:o,mapEnd:i.location,surfaceType:i.surfaceType}):null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(a||(a={}));(0,l.c)(),(0,l.c)();var g=(0,u.Ue)()},70209:function(e,t,i){i.d(t,{Lp:function(){return u},P9:function(){return o},Yq:function(){return h}});var a=i(74165),n=i(15861),r=i(92026),s=i(66978),l=i(94172);function o(e,t,i){var o=p(e,t);e.view.activeTool=o;var u=(0,s.fu)(i,(function(){return c(e,t)}));return(0,s.vr)(function(){var i=(0,n.Z)((0,a.Z)().mark((function i(n){return(0,a.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,l.N1)((function(){return!o.active}),n);case 2:u=(0,r.hw)(u),c(e,t);case 4:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}(),i)}function u(e,t){return(0,l.YP)((function(){return e.interactive}),(function(){return c(e,t)}),l.tX)}function c(e,t){e.interactive?p(e,t):h(e)}function p(e,t){h(e);var i=e.view,a=new t({view:i,analysis:e.analysis,analysisViewData:e});return e.tool=a,i.tools.add(a),a}function h(e){var t=e.view,i=e.tool;(0,r.Wi)(i)||(t.tools.remove(i),e.tool=null)}},86509:function(e,t,i){i.d(t,{f:function(){return p}});var a=i(15671),n=i(43144),r=i(60136),s=i(29388),l=i(27366),o=i(94172),u=i(49861),c=(i(63780),i(93169),i(25243),i(69912)),p=function(e){(0,r.Z)(i,e);var t=(0,s.Z)(i);function i(e){return(0,a.Z)(this,i),t.call(this,e)}return(0,n.Z)(i,[{key:"initialize",value:function(){var e=this;this.own((0,o.YP)((function(){return e.analysisViewData.visible}),(function(t){return e.visible=t}),o.tX))}},{key:"deactivate",value:function(){this.onDeactivate(),this.created||this.analysis.clear()}},{key:"resetCreated",value:function(){this._set("created",!1)}}]),i}(i(29919).m);(0,l._)([(0,u.Cb)({constructOnly:!0})],p.prototype,"analysis",void 0),(0,l._)([(0,u.Cb)()],p.prototype,"analysisViewData",void 0),p=(0,l._)([(0,c.j)("esri.views.interactive.AnalysisToolBase")],p)}}]);
//# sourceMappingURL=6859.75855bc8.chunk.js.map