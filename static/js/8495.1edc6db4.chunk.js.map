{"version":3,"file":"static/js/8495.1edc6db4.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/layers/FeatureLayerView.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{deprecatedProperty as t}from\"../../core/deprecate.js\";import r from\"../../core/Error.js\";import i from\"../../core/Logger.js\";import{isSome as s,isNone as o}from\"../../core/maybe.js\";import{eachAlways as n}from\"../../core/promiseUtils.js\";import{watch as a,syncAndInitial as l,on as u}from\"../../core/reactiveUtils.js\";import{property as p}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as f}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as d}from\"../../layers/support/commonProperties.js\";import c from\"../../layers/support/FeatureEffect.js\";import m from\"../../layers/support/FeatureFilter.js\";import{fixFields as h,unpackFieldNames as y,collectLabelingFields as F,collectElevationFields as g,collectFilterFields as w,collectFeatureReductionFields as E,collectOrderByInfos as b,collectFields as x,collectField as v,featureHasFields as j}from\"../../layers/support/fieldUtils.js\";import{getFloorFilterClause as R}from\"../../layers/support/floorFilterUtils.js\";import I from\"../../rest/support/Query.js\";import{loadArcade as q}from\"../../support/arcadeOnDemand.js\";import{getFetchPopupTemplate as _,getRequiredFields as P}from\"./support/popupUtils.js\";const O=i.getLogger(\"esri.views.layers.FeatureLayerView\"),A=i=>{let A=class extends i{constructor(...e){super(...e),this._updatingRequiredFieldsPromise=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){this.handles.add([a((()=>{const e=this.layer;return[e?.elevationInfo?.featureExpressionInfo,e?.displayField,e?.timeInfo,e&&\"renderer\"in e&&e.renderer,e&&\"labelingInfo\"in e&&e.labelingInfo,e&&\"floorInfo\"in e&&e.floorInfo,this.filter,this.featureEffect,this.timeExtent]}),(()=>this._handleRequiredFieldsChange()),l),u((()=>this.view?.floors),\"change\",(()=>this._handleRequiredFieldsChange())),u((()=>{const e=this.layer;return e&&\"sublayers\"in e&&e.sublayers}),\"change\",(()=>this._handleRequiredFieldsChange()))])}get availableFields(){const{layer:e,layer:{fieldsIndex:t},requiredFields:r}=this;return\"outFields\"in e&&e.outFields?h(t,[...y(t,e.outFields),...r]):h(t,r)}set effect(e){t(O,\"effect\",{replacement:\"featureEffect\",version:\"4.22\"}),this.featureEffect=e}get effect(){return t(O,\"effect\",{replacement:\"featureEffect\",version:\"4.22\"}),this.featureEffect}get featureEffect(){return this.layer&&\"featureEffect\"in this.layer?this.layer.featureEffect:null}set featureEffect(e){void 0!==e?this._override(\"featureEffect\",e):this._clearOverride(\"featureEffect\")}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){O.error(\"#maximumNumberOfFeatures=\",\"Setting maximum number of features is not supported\")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error(\"missing implementation\")}createQuery(){const e={outFields:[\"*\"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=s(this.filter)?this.filter.createQuery(e):new I(e);if(\"feature\"===this.layer.type){const e=R(this);s(e)&&(t.where=t.where?`(${t.where}) AND (${e})`:e)}return s(this.timeExtent)&&(t.timeExtent=s(t.timeExtent)?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}queryFeatures(e,t){throw new Error(\"missing implementation\")}queryObjectIds(e,t){throw new Error(\"missing implementation\")}queryFeatureCount(e,t){throw new Error(\"missing implementation\")}queryExtent(e,t){throw new Error(\"missing implementation\")}async fetchPopupFeatures(e,t){const r=this.validateFetchPopupFeatures(t);if(r)throw r;return this.fetchClientPopupFeatures(t)}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\")||Array.isArray(e.content)&&e.content.some((e=>\"expression\"===e.type)))return q()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set(\"_updatingRequiredFieldsPromise\",e),e.then((()=>{this._updatingRequiredFieldsPromise===e&&this._set(\"_updatingRequiredFieldsPromise\",null)}))}async _updateRequiredFields(){if(!this.layer||!this.view)return;const e=\"3d\"===this.view.type,{layer:t,layer:{fieldsIndex:r,objectIdField:i}}=this,o=\"renderer\"in t&&t.renderer,a=\"orderBy\"in t&&t.orderBy,l=t.featureReduction,u=new Set,p=await n([o?o.collectRequiredFields(u,r):null,F(u,t),e?g(u,t):null,s(this.filter)?w(u,t,this.filter):null,s(this.featureEffect)?w(u,t,this.featureEffect.filter):null,l?E(u,t,l):null,a?b(u,t,a):null]);if(t.timeInfo&&this.timeExtent&&x(u,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),\"feature\"===t.type&&t.floorInfo&&x(u,t.fieldsIndex,[t.floorInfo.floorField]),\"subtype-group\"===t.type){v(u,r,t.subtypeField);const e=t.sublayers.map((e=>Promise.all([e.renderer?.collectRequiredFields(u,r),F(u,e)])));await n(e)}for(const s of p)s.error&&O.error(s.error);v(u,r,i),e&&\"displayField\"in t&&t.displayField&&v(u,r,t.displayField);const f=Array.from(u).sort();this._set(\"requiredFields\",f)}validateFetchPopupFeatures(e){if(o(e))return null;for(const t of e.clientGraphics){const i=t.layer;if(\"popupEnabled\"in i&&!i.popupEnabled)return new r(\"featurelayerview:fetchPopupFeatures\",\"Popups are disabled\",{layer:i});if(t.isAggregate){if(!(i.featureReduction&&\"popupTemplate\"in i.featureReduction&&i.featureReduction.popupEnabled&&i.featureReduction.popupTemplate))return new r(\"featurelayerview:fetchPopupFeatures\",\"Popups are disabled\",{layer:i})}else if(\"popupTemplate\"in i){if(!_(i,e))return new r(\"featurelayerview:fetchPopupFeatures\",\"Layer does not define a popup template\",{layer:i})}}}async fetchClientPopupFeatures(e){const t=s(e)?e.clientGraphics:null;if(!t||0===t.length)return[];const r=new Array(t.length),i=new Map,n=await this.createPopupQuery(e);for(let s=0;s<t.length;s++){const a=t[s];if(a.isAggregate){r[s]=a;continue}const{layer:l}=a;if(!(\"popupEnabled\"in l))continue;const u=y(this.layer.fieldsIndex,n.outFields),p=_(l,e);if(o(p))continue;const f=await this._loadArcadeModules(p);f&&f.arcadeUtils.hasGeometryOperations(p)||!j(u,a)?i.set(a.getObjectId(),s):r[s]=a}if(\"stream\"===this.layer.type||0===i.size)return r.filter(Boolean);n.objectIds=Array.from(i.keys());try{const e=await this.layer.queryFeatures(n);for(const t of e.features){r[i.get(t.getObjectId())]=t}}catch{}return r.filter(Boolean)}async createPopupQuery(e){const t=this.layer.createQuery(),r=new Set;let i=!1;const n=s(e)&&e.clientGraphics?e.clientGraphics.map((e=>e.layer)):[this.layer];for(const s of n){if(!(\"popupEnabled\"in s))continue;const t=_(s,e);if(o(t))continue;const n=await this._loadArcadeModules(t),a=n&&n.arcadeUtils.hasGeometryOperations(t);i=!(\"point\"!==this.layer.geometryType&&!a);const l=await P(this.layer,t);for(const e of l)r.add(e)}if(t.returnGeometry=i,t.returnZ=i,t.returnM=i,t.outFields=Array.from(r),t.outSpatialReference=this.view.spatialReference,\"feature\"===this.layer.type){const e=R(this);s(e)&&(t.where=t.where?`(${t.where}) AND (${e})`:e)}return t}canResume(){return!!super.canResume()&&(!s(this.timeExtent)||!this.timeExtent.isEmpty)}};return e([p()],A.prototype,\"_updatingRequiredFieldsPromise\",void 0),e([p({readOnly:!0})],A.prototype,\"availableFields\",null),e([p()],A.prototype,\"effect\",null),e([p({type:c})],A.prototype,\"featureEffect\",null),e([p({type:m})],A.prototype,\"filter\",void 0),e([p(d)],A.prototype,\"timeExtent\",void 0),e([p()],A.prototype,\"layer\",void 0),e([p({type:Number})],A.prototype,\"maximumNumberOfFeatures\",null),e([p({readOnly:!0,type:Boolean})],A.prototype,\"maximumNumberOfFeaturesExceeded\",null),e([p({readOnly:!0})],A.prototype,\"requiredFields\",void 0),e([p()],A.prototype,\"suspended\",void 0),e([p()],A.prototype,\"view\",void 0),A=e([f(\"esri.views.layers.FeatureLayerView\")],A),A};export{A as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as l}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as t}from\"../../../layers/support/fieldUtils.js\";async function d(l,d=l.popupTemplate){if(e(d))return[];const s=await d.getRequiredFields(l.fieldsIndex),{lastEditInfoEnabled:i}=d,{objectIdField:n,typeIdField:u,globalIdField:a,relationships:o}=l;if(s.includes(\"*\"))return[\"*\"];const r=i?await p(l):[],f=t(l.fieldsIndex,[...s,...r]);return u&&f.push(u),f&&n&&l.fieldsIndex.has(n)&&!f.includes(n)&&f.push(n),f&&a&&l.fieldsIndex.has(a)&&!f.includes(a)&&f.push(a),o&&o.forEach((e=>{const{keyField:p}=e;f&&p&&l.fieldsIndex.has(p)&&!f.includes(p)&&f.push(p)})),f}function s(e,p){return e.popupTemplate?e.popupTemplate:l(p)&&p.defaultPopupTemplateEnabled&&l(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}export{s as getFetchPopupTemplate,d as getRequiredFields};\n"],"names":["O","i","A","e","_updatingRequiredFieldsPromise","filter","timeExtent","layer","requiredFields","view","this","handles","add","a","elevationInfo","featureExpressionInfo","displayField","timeInfo","renderer","labelingInfo","floorInfo","featureEffect","_handleRequiredFieldsChange","l","u","floors","sublayers","t","fieldsIndex","r","outFields","h","y","replacement","version","_override","_clearOverride","error","Error","returnGeometry","outSpatialReference","spatialReference","s","createQuery","I","type","R","where","intersection","clone","validateFetchPopupFeatures","fetchClientPopupFeatures","get","Array","isArray","content","some","q","_updateRequiredFields","_set","then","objectIdField","o","orderBy","featureReduction","Set","n","collectRequiredFields","F","g","w","E","b","p","x","startField","endField","floorField","v","subtypeField","map","Promise","all","f","from","sort","clientGraphics","popupEnabled","isAggregate","popupTemplate","_","length","Map","createPopupQuery","_loadArcadeModules","arcadeUtils","hasGeometryOperations","j","set","getObjectId","size","Boolean","objectIds","keys","queryFeatures","features","geometryType","P","returnZ","returnM","isEmpty","prototype","readOnly","c","m","d","Number","doRefresh","dataChanged","catch","declaredClass","getRequiredFields","lastEditInfoEnabled","typeIdField","globalIdField","relationships","includes","push","has","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate"],"sourceRoot":""}