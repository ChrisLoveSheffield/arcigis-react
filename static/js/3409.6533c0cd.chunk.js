"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[3409],{42069:function(e,t,i){i.d(t,{A:function(){return b}});var n=i(74165),r=i(15861),s=i(15671),a=i(43144),u=i(11752),o=i(61120),l=i(60136),c=i(29388),d=i(27366),p=i(42537),h=i(66978),y=i(94172),f=i(49861),v=(i(63780),i(93169),i(25243),i(69912)),g=i(5354),b=function(e){var t=function(e){(0,l.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,s.Z)(this,i),(e=t.apply(this,arguments)).slicePlaneEnabled=!1,e.supportsHeightUnitConversion=!1,e}return(0,a.Z)(i,[{key:"postscript",value:function(e){(0,u.Z)((0,o.Z)(i.prototype),"postscript",this).call(this,e),(0,g.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}},{key:"_validateHeightModelInfo",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,s=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new AbortController,i=t.signal,this.handles.add((0,p.kB)((function(){return t.abort()}))),e.next=4,(0,y.N1)((function(){var e;return null===(e=s.view.defaultsFromMap)||void 0===e?void 0:e.heightModelInfoReady}),i);case 4:if((0,h.k_)(i),!(r=(0,g.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion))){e.next=8;break}throw r;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,u.Z)((0,o.Z)(i.prototype),"canResume",this).call(this)&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}},{key:"getSuspendInfo",value:function(){var e=(0,u.Z)((0,o.Z)(i.prototype),"getSuspendInfo",this).call(this),t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return t&&t.minScale&&t.maxScale&&t.minScale<t.maxScale&&(e.outsideScaleRange=!0),e}}]),i}(e);return(0,d._)([(0,f.Cb)()],t.prototype,"view",void 0),(0,d._)([(0,f.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,d._)([(0,v.j)("esri.views.3d.layers.LayerView3D")],t)}},12173:function(e,t,i){i.d(t,{Z:function(){return J}});var n=i(74165),r=i(15861),s=i(1413),a=i(15671),u=i(43144),o=i(60136),l=i(29388),c=i(27366),d=i(52639),p=i(41644),h=i(41691),y=i(92026),f=i(66978),v=i(94172),g=i(49861),b=(i(63780),i(93169),i(25243),i(69912)),m=i(48732),_=i(81753),C=i(34610),w=i(21149),E=i(26279),x=i(61310),k=i(86792),S=i(79874),V=i(85015),I=i(100),Z=i(32718),R=i(62314),O=i(18661),F=i(87072),P=i(70446),Q=i(82607),G=i(93463),q=Z.Z.getLogger("esri.views.3d.layers.graphics.Graphics3DFilterVisibility"),j=function(e){(0,o.Z)(i,e);var t=(0,l.Z)(i);function i(){var e;(0,a.Z)(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r)))._dirty=!1,e._querying=!1,e._handles=new I.Z,e}return(0,u.Z)(i,[{key:"updating",get:function(){return this._dirty||this._querying||(0,y.pC)(this._queryResult)}},{key:"setup",value:function(e,t){var i=this;this._layerView=e,this._core=t,this._objectIdField=e.layer.objectIdField,this._queryEngine=new Q.q({layerView:this._layerView,priority:G.T8.FILTER_VISIBILITY});var n=this._layerView.view.resourceController.scheduler;this._handles.add(n.registerTask(G.T8.FILTER_VISIBILITY,this)),this._handles.add((0,v.on)((function(){var e;return null===(e=t.owner)||void 0===e?void 0:e.loadedGraphics}),"after-changes",(function(e){return i._graphicsChanged(e)}),{onListenerAdd:function(){return i.dirty=!0}})),this.filterChanged()}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this.clear(),this._layerView=null,this._core=null}},{key:"clear",value:function(){this._queryEngine.clear()&&(this._core.modifyGraphics3DGraphicVisibilities((function(e){return e.clearVisibilityFlag(P.P.FILTER)})),this._queryResult=null,this._querying=!1),this.dirty=!1}},{key:"_graphicsChanged",value:function(e){this._queryEngine&&0==(e.type&R.y.ADD)||(this.dirty=!0)}},{key:"updateVisibility",value:function(e){this.active&&(e.hasVisibilityFlag(P.P.FILTER,P.E.GRAPHIC)||e.setVisibilityFlag(P.P.FILTER,!1,P.E.GRAPHIC),this.dirty=!0)}},{key:"filterChanged",value:function(){var e=this._recomputeFilter();e!==this._featureFilter&&(this._featureFilter=e,this.dirty=!0);var t="layerFilter"in this._layerView?this._layerView.layerFilter:null;t!==this._sceneFilter&&(this._sceneFilter=t,this.dirty=!0)}},{key:"active",get:function(){return(this._featureFilter||this._sceneFilter)&&this._core.graphics3DGraphics.size>0}},{key:"_recomputeFilter",value:function(){var e="filter"in this._layerView?this._layerView.filter:null,t="timeExtent"in this._layerView?this._layerView.timeExtent:null,i=(0,F.c)(this._layerView);if((0,y.Wi)(t)&&(0,y.Wi)(i))return e;var n=(0,y.pC)(e)?e.clone():new O.Z;if((0,y.pC)(t)&&(n.timeExtent=(0,y.pC)(n.timeExtent)?n.timeExtent.intersection(t):t),(0,y.pC)(i)){var r=null==n.where||""===n.where;n.where=r?i:"(".concat(n.where,") AND (").concat(i,")")}return n}},{key:"running",get:function(){return this._dirty&&!this._querying||(0,y.pC)(this._queryResult)}},{key:"runTask",value:function(e){var t=this;if(this.active){!this._dirty||this._querying||e.done||(this._querying=!0,this.dirty=!1,this._queryEngine.executeQueryForIdSet(this._featureFilter,this._sceneFilter).then((function(e){t._queryResult=e,t._querying=!1})).catch((function(e){if(!(0,f.D_)(e)){q.warn("FeatureFilter query failed: "+e,{error:e});var i=new Set;t._core.graphics3DGraphics.forEach((function(e){return i.add(t._getFeatureId(e.graphic))})),t._queryResult=i,t._querying=!1}})),e.madeProgress());var i=this._queryResult;(0,y.pC)(i)&&!e.done&&(this._core.modifyGraphics3DGraphicVisibilities((function(n){if(e.done)return!1;var r=i.has(t._getFeatureId(n.graphic));return!!n.setVisibilityFlag(P.P.FILTER,r,P.E.GRAPHIC)&&(e.madeProgress(),!0)})),e.done||(this._queryResult=null))}else this.clear()}},{key:"_getFeatureId",value:function(e){return null==e.objectId?e.attributes[this._objectIdField]:e.objectId}},{key:"dirty",set:function(e){this._dirty=e}}]),i}(V.Z);(0,c._)([(0,g.Cb)({readOnly:!0})],j.prototype,"updating",null),(0,c._)([(0,g.Cb)({readOnly:!0})],j.prototype,"running",null),(0,c._)([(0,g.Cb)()],j.prototype,"_dirty",void 0),(0,c._)([(0,g.Cb)()],j.prototype,"_querying",void 0),(0,c._)([(0,g.Cb)()],j.prototype,"_queryResult",void 0),j=(0,c._)([(0,b.j)("esri.views.3d.layers.graphics.Graphics3DFilterVisibility")],j);var A=i(84328),M=i(46568),N=i(59453),T=i(96387),H=i(99879),L=i(68401),D=function(e){(0,o.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e)).type="graphics-3d",n.elevationFeatureExpressionEnabled=!1,n.dataExtent=null,n.drapeSourceType=E.L.Features,n.preferredUpdatePolicy=L.jq.ASYNC,n.suspendResumeExtent=null,n}return(0,u.Z)(i,[{key:"normalizeCtorArgs",value:function(e){var t=e.frustumVisibilityEnabled?new A.Z:null,i=e.scaleVisibilityEnabled?new N.Z:null,n=(e.filterVisibilityEnabled||e.timeExtentEnabled)&&"multipatch"!==e.owner.layer.geometryType?new j:null,r=e.elevationAlignmentEnabled?new S.Z:null;return{owner:e.owner,updateClippingExtent:e.updateClippingExtent,dataExtent:e.dataExtent,frustumVisibility:t,scaleVisibility:i,filterVisibility:n,elevationAlignment:r,elevationFeatureExpressionEnabled:e.elevationFeatureExpressionEnabled,preferredUpdatePolicy:e.preferredUpdatePolicy}}},{key:"initialize",value:function(){var e=this,t=new k.w({owner:this,layer:this.layer,preferredUpdatePolicy:this.preferredUpdatePolicy,elevationFeatureExpressionEnabled:this.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1,hasZ:this.owner.hasZ,hasM:this.owner.hasM});this._set("graphicsCore",t),this.scaleVisibility&&this.updatingHandles.add((function(){return e.layer.effectiveScaleRange}),(function(){return e.scaleVisibility.layerMinMaxScaleChangeHandler()}));var i=this.filterVisibility;(0,y.pC)(i)&&(this.updatingHandles.add((function(){return"filter"in e.owner&&e.owner.filter}),(function(){return i.filterChanged()})),this.updatingHandles.add((function(){return"timeExtent"in e.owner&&e.owner.timeExtent}),(function(){return i.filterChanged()})),this.updatingHandles.add((function(){return"layerFilter"in e.owner&&e.owner.layerFilter}),(function(){return i.filterChanged()}))),this.elevationAlignment&&this.updatingHandles.add((function(){return e.layer.elevationInfo}),(function(t,i){(0,m.Hg)(t,i)&&e.updatingHandles.addPromise(e.graphicsCore.elevationInfoChange())})),this.updatingHandles.add((function(){return e.layer.labelsVisible}),(function(){return e.graphicsCore.updateVisibilityInfo()})),this.updatingHandles.add((function(){return e.layer.labelingInfo}),(function(t,i){(0,m.Hg)(t,i)&&e.graphicsCore.updateLabelingInfo()})),this.updatingHandles.add((function(){return e.preferredUpdatePolicy}),(function(t){return e.graphicsCore.preferredUpdatePolicy=t}))}},{key:"destroy",value:function(){this.handles.removeAll(),this.updatingHandles.removeAll(),this._set("frustumVisibility",(0,y.SC)(this.frustumVisibility)),this._set("scaleVisibility",(0,y.SC)(this.scaleVisibility)),this._set("filterVisibility",(0,y.SC)(this.filterVisibility)),this._set("elevationAlignment",(0,y.SC)(this.elevationAlignment)),this._set("objectStates",(0,y.SC)(this.objectStates)),this._set("graphicsCore",(0,y.SC)(this.graphicsCore)),this._set("owner",null)}},{key:"layer",get:function(){return this.owner.layer}},{key:"suspendResumeExtentMode",get:function(){return"suspendResumeExtentMode"in this.owner?this.owner.suspendResumeExtentMode:"computed"}},{key:"scaleVisibilitySuspended",get:function(){var e;return null===(e=this.scaleVisibility)||void 0===e?void 0:e.suspended}},{key:"suspended",get:function(){return this.owner.suspended}},{key:"legendEnabled",get:function(){return(0,y.Wi)(this.frustumVisibility)||!this.frustumVisibility.suspended}},{key:"suspendInfo",get:function(){var e,t={};return null!==(e=this.scaleVisibility)&&void 0!==e&&e.suspended&&(t.outsideScaleRange=!0),(0,y.pC)(this.frustumVisibility)&&this.frustumVisibility.suspended&&(t.outsideOfView=!0),t}},{key:"updating",get:function(){var e,t;return!!(null!==(e=this.graphicsCore)&&void 0!==e&&e.updating||(0,y.pC)(this.frustumVisibility)&&this.frustumVisibility.updating||null!==(t=this.updatingHandles)&&void 0!==t&&t.updating)}},{key:"updatingRemaining",get:function(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.updatingRemaining)&&void 0!==e?e:0}},{key:"featureStore",get:function(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.featureStore}},{key:"view",get:function(){return this.owner.view}},{key:"loadedGraphics",get:function(){return this.owner.loadedGraphics}},{key:"fullOpacity",get:function(){var e;return null===(e=this.owner)||void 0===e?void 0:e.fullOpacity}},{key:"filter",get:function(){return"filter"in this.owner?this.owner.filter:null}},{key:"slicePlaneEnabled",get:function(){return this.owner.slicePlaneEnabled}},{key:"updatePolicy",get:function(){return this.owner.updatePolicy}},{key:"featureSpatialReference",get:function(){return"featureSpatialReference"in this.owner?this.owner.featureSpatialReference:this.owner.view.spatialReference}},{key:"graphics3DGraphics",get:function(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.graphics3DGraphics}},{key:"graphics3DGraphicsByObjectID",get:function(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.graphics3DGraphicsByObjectID}},{key:"symbolUpdateType",get:function(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.symbolUpdateType}},{key:"displayFeatureLimit",get:function(){var e,t=this.view.resourceController.memoryController.memoryFactor,i=null===(e=this.graphicsCore)||void 0===e?void 0:e.displayFeatureLimit;if(1===t)return i;var n=Math.ceil(i.maximumNumberOfFeatures*t),r=Math.ceil(i.maximumTotalNumberOfFeatures*t),a=Math.ceil(i.minimumTotalNumberOfFeatures*t);return(0,s.Z)((0,s.Z)({},i),{},{maximumNumberOfFeatures:n,maximumTotalNumberOfFeatures:r,minimumTotalNumberOfFeatures:a})}},{key:"usedMemory",get:function(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.usedMemory)&&void 0!==e?e:0}},{key:"usedMemoryPerFeature",get:function(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.usedMemoryPerGraphic)&&void 0!==e?e:0}},{key:"unprocessedMemoryEstimate",get:function(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.unprocessedMemoryEstimate)&&void 0!==e?e:0}},{key:"performanceInfo",get:function(){return{core:this.graphicsCore.performanceInfo,elevationUpdating:this.elevationAlignment.updating,visibilityFrustum:(0,y.Wi)(this.frustumVisibility)||!this.frustumVisibility.suspended,visibilityScale:!this.scaleVisibility.suspended}}},{key:"setup",value:function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t,i,r,s,a=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,y.pC)(this.frustumVisibility)&&this.frustumVisibility.setup(this),t=this.owner,i=this.owner.view.basemapTerrain,r=function(e,t,i){return a.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(e,t,i)},this.scaleVisibility&&this.scaleVisibility.setup(this,this.layer,r,this.graphicsCore,i),(0,y.pC)(this.filterVisibility)&&("filter"in t||"timeExtent"in t)&&this.filterVisibility.setup(t,this.graphicsCore),this.elevationAlignment&&(s=t.view.elevationProvider,this.elevationAlignment.setup(this,r,this.graphicsCore,s)),this._set("objectStates",new M.d(this.graphicsCore)),this._set("labeling",this.owner.view.labeler.addGraphicsOwner(this.graphicsCore,this.scaleVisibility)),this._set("deconfliction",t.view.deconflictor.addGraphicsOwner(this.graphicsCore)),e.next=8,(0,f.U3)(this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,filterVisibility:this.filterVisibility,deconflictor:this.deconfliction,labeler:this.labeling,objectStates:this.objectStates}));case 8:if(this.updatingHandles.add((function(){return a.layer.renderer}),(function(e){return a.updatingHandles.addPromise(a.graphicsCore.rendererChange(e))})),this.updatingHandles.add((function(){return t.fullOpacity}),(function(){return a.graphicsCore.opacityChange()})),this._setupSuspendResumeExtent(),this.updateClippingExtent&&(this.updatingHandles.add((function(){return t.view.clippingArea}),(function(){return a._updateClippingExtent()})),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),e.t0=this.graphicsCore.labelsEnabled,!e.t0){e.next=17;break}return e.next=17,(0,f.U3)(this.graphicsCore.updateLabelingInfo());case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"maskOccludee",value:function(e){var t=this.objectStates.acquireSet(L.V_.MaskOccludee,null),i=t.set,n=t.handle;return this.objectStates.setUid(i,e.uid),n}},{key:"highlight",value:function(e,t){var i=this;if(e instanceof w.Z){var n=this.objectStates.acquireSet(L.V_.Highlight,t),r=n.set,s=n.handle;return this.owner.queryObjectIds(e).then((function(e){return i.objectStates.setObjectIds(r,e)})),s}if("number"==typeof e||"string"==typeof e)return this.highlight([e],t);if(e instanceof d.Z)return this.highlight([e],t);if("toArray"in e&&(e=e.toArray()),Array.isArray(e)&&e.length>0){if(e[0]instanceof d.Z){var a=e;if(null==(0,H.g)(this.layer.fieldsIndex,a[0].attributes,t)){var u=a.map((function(e){return e.uid})),o=this.objectStates.acquireSet(L.V_.Highlight,null),l=o.set,c=o.handle;return this.objectStates.setUids(l,u),c}e=a.map((function(e){return(0,H.g)(i.layer.fieldsIndex,e.attributes,t)}))}if("number"==typeof e[0]||"string"==typeof e[0]){var p=e,h=this.objectStates.acquireSet(L.V_.Highlight,t),y=h.set,f=h.handle;return this.objectStates.setObjectIds(y,p),f}}return B}},{key:"whenGraphicBounds",value:function(e,t){var i;return null===(i=this.graphicsCore)||void 0===i?void 0:i.whenGraphicBounds(e,t)}},{key:"computeAttachmentOrigin",value:function(e,t){var i;return null===(i=this.graphicsCore)||void 0===i?void 0:i.computeAttachmentOrigin(e,t)}},{key:"notifyGraphicGeometryChanged",value:function(e){this.graphicsCore.notifyGraphicGeometryChanged(e)}},{key:"notifyGraphicVisibilityChanged",value:function(e){this.graphicsCore.notifyGraphicVisibilityChanged(e)}},{key:"getRenderingInfo",value:function(e,t,i){var n=(0,C.Kb)(e,{renderer:t,arcade:i});if((0,y.pC)(n)&&n.color){var r=n.color;r[0]=r[0]/255,r[1]=r[1]/255,r[2]=r[2]/255}return n}},{key:"getRenderingInfoAsync",value:function(e,t,i,n){return(0,C.xn)(e,(0,s.Z)({renderer:t,arcade:i},n))}},{key:"getSymbolLayerSize",value:function(e,t){var i;return null===(i=this.graphicsCore)||void 0===i?void 0:i.getSymbolLayerSize(e,t)}},{key:"setObjectIdVisibility",value:function(e,t){var i;null===(i=this.graphicsCore)||void 0===i||i.setObjectIdVisibility(e,t)}},{key:"_updateClippingExtent",value:function(){var e=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.owner.view.spatialReference)&&(this.updateClippingExtent(e)||this.graphicsCore.recreateAllGraphics())}},{key:"_setupSuspendResumeExtent",value:function(){var e=this;(this.frustumVisibility||this.scaleVisibility)&&this.handles.add((0,v.YP)((function(){return e.suspendResumeExtentMode}),(function(){switch(e.handles.remove(U),e.suspendResumeExtentMode){case"computed":e.handles.add([(0,v.YP)((function(){return e.graphicsCore.computedExtent}),(function(t){return e._updateSuspendResumeExtent(t)}),v.nn),(0,v.YP)((function(){return e.graphicsCore.extentPadding}),(function(){return e._updateSuspendResumeExtent(e.graphicsCore.computedExtent)}))],U);break;case"data":e.handles.add([(0,v.gx)((function(){return e.dataExtent}),(function(t){return e._updateSuspendResumeExtent(t)}),v.nn),(0,v.YP)((function(){return e.graphicsCore.extentPadding}),(function(){return e._updateSuspendResumeExtent((0,y.Wg)(e.dataExtent))}))],U);break;default:(0,p.Bg)(e.suspendResumeExtentMode)}}),v.nn))}},{key:"_updateSuspendResumeExtent",value:function(e){e?this._suspendResumeExtentChanged(this._extentToSuspendResumeRect(e,this.suspendResumeExtent)):this._suspendResumeExtentChanged(null)}},{key:"_extentToSuspendResumeRect",value:function(e,t){var i=this.owner.view.spatialReference;if(!e.spatialReference.equals(i)){if(!(0,_.Q8)(e,i))return;e=(0,_.iV)(e,i)}return(0,T.Go)(e,t,x.ZF,this.graphicsCore.extentPadding)}},{key:"_suspendResumeExtentChanged",value:function(e){(0,y.pC)(this.frustumVisibility)&&this.frustumVisibility.setExtent(e),this.scaleVisibility&&this.scaleVisibility.setExtent(e)}}]),i}(h.r);(0,c._)([(0,g.Cb)()],D.prototype,"type",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"owner",void 0),(0,c._)([(0,g.Cb)()],D.prototype,"layer",null),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"updateClippingExtent",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"elevationFeatureExpressionEnabled",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"graphicsCore",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"scaleVisibility",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"filterVisibility",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"elevationAlignment",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"frustumVisibility",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],D.prototype,"deconfliction",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],D.prototype,"labeling",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],D.prototype,"objectStates",void 0),(0,c._)([(0,g.Cb)()],D.prototype,"suspendResumeExtentMode",null),(0,c._)([(0,g.Cb)()],D.prototype,"dataExtent",void 0),(0,c._)([(0,g.Cb)()],D.prototype,"scaleVisibilitySuspended",null),(0,c._)([(0,g.Cb)()],D.prototype,"suspended",null),(0,c._)([(0,g.Cb)()],D.prototype,"legendEnabled",null),(0,c._)([(0,g.Cb)()],D.prototype,"suspendInfo",null),(0,c._)([(0,g.Cb)()],D.prototype,"updating",null),(0,c._)([(0,g.Cb)()],D.prototype,"updatingRemaining",null),(0,c._)([(0,g.Cb)()],D.prototype,"featureStore",null),(0,c._)([(0,g.Cb)()],D.prototype,"view",null),(0,c._)([(0,g.Cb)()],D.prototype,"loadedGraphics",null),(0,c._)([(0,g.Cb)()],D.prototype,"fullOpacity",null),(0,c._)([(0,g.Cb)()],D.prototype,"filter",null),(0,c._)([(0,g.Cb)()],D.prototype,"slicePlaneEnabled",null),(0,c._)([(0,g.Cb)()],D.prototype,"drapeSourceType",void 0),(0,c._)([(0,g.Cb)()],D.prototype,"updatePolicy",null),(0,c._)([(0,g.Cb)()],D.prototype,"preferredUpdatePolicy",void 0),(0,c._)([(0,g.Cb)()],D.prototype,"displayFeatureLimit",null);var J=D=(0,c._)([(0,b.j)("esri.views.3d.layers.graphics.Graphics3DFeatureProcessor")],D),U="suspendResumeExtentMode",B={remove:function(){},pause:function(){},resume:function(){}}},82607:function(e,t,i){i.d(t,{q:function(){return C}});var n=i(1413),r=i(74165),s=i(15861),a=i(15671),u=i(43144),o=i(60136),l=i(29388),c=i(27366),d=(i(59486),i(85015)),p=i(92026),h=i(49861),y=(i(63780),i(93169),i(25243),i(69912)),f=i(53866),v=i(14e3),g=i(49818),b=i(21149),m=i(27823),_=v.q,C=function(e){(0,o.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this,e))._dataQueryEngineInstance=null,n}return(0,u.Z)(i,[{key:"queryGeometryType",get:function(){switch(this.layer.geometryType){case"multipoint":case"point":case"polygon":case"polyline":return this.layer.geometryType;case"mesh":return"polygon";default:return}}},{key:"defaultQueryJSON",get:function(){return new b.Z({outSpatialReference:this.spatialReference}).toJSON()}},{key:"dataQueryEngine",get:function(){return this._ensureDataQueryEngine()}},{key:"destroy",value:function(){this.clear()}},{key:"clear",value:function(){return!!this._dataQueryEngineInstance&&(this._dataQueryEngineInstance.destroy(),this._dataQueryEngineInstance=null,!0)}},{key:"executeQueryForIdSet",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,i){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dataQueryEngine.executeQueryForIdSet(this._ensureQueryJSON(t,i)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,i){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(t),i));case 1:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,i){var n,s,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(t),i);case 2:return n=e.sent,s=n.count,a=n.extent,e.abrupt("return",{count:s,extent:f.Z.fromJSON(a)});case 6:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,i){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(t),i));case 1:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,i){var n,s,a=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataQueryEngine.executeQueryForLatestObservations(this._ensureQueryJSON(t),i);case 2:return n=e.sent,s=g.default.fromJSON(n),e.abrupt("return",(s.features.forEach((function(e){e.layer=a.layer,e.sourceLayer=a.layer})),s));case 5:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"executeQuery",value:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,i){var n,s,a=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataQueryEngine.executeQuery(this._ensureQueryJSON(t),i);case 2:return n=e.sent,s=g.default.fromJSON(n),e.abrupt("return",(s.features.forEach((function(e){e.layer=a.layer,e.sourceLayer=a.layer})),s));case 5:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_ensureQueryJSON",value:function(e,t){var i=this.defaultQueryJSON;return(0,p.pC)(e)&&("outSpatialReference"in e&&!e.outSpatialReference&&(e.outSpatialReference=this.spatialReference),i=e.toJSON()),(0,p.pC)(t)&&(i=(0,n.Z)((0,n.Z)({},i),{},{sceneFilter:(0,n.Z)((0,n.Z)({},t),{},{geometry:t.geometry.toJSON()})})),i}},{key:"_ensureDataQueryEngine",value:function(){if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;var e="timeInfo"in this.layer&&this.layer.timeInfo&&this.layer.timeInfo.toJSON()||null,t=this.layer.objectIdField,i=m.Mk.toJSON(this.queryGeometryType),n=this.layer.fields.map((function(e){return e.toJSON()})),r=this.layerView.view.resourceController.scheduler,s=this.priority,a=this.spatialReference.toJSON(),u=this.layerView.processor.featureStore,o=this.layerView,l=o.hasZ,c=o.hasM;return this._dataQueryEngineInstance=new _({hasZ:l,hasM:c,geometryType:i,fields:n,timeInfo:e,spatialReference:a,objectIdField:t,featureStore:u,scheduler:r,priority:s}),this._dataQueryEngineInstance}}]),i}(d.Z);(0,c._)([(0,h.Cb)({constructOnly:!0})],C.prototype,"layerView",void 0),(0,c._)([(0,h.Cb)({constructOnly:!0})],C.prototype,"priority",void 0),(0,c._)([(0,h.Cb)({readOnly:!0,aliasOf:"layerView.view.spatialReference"})],C.prototype,"spatialReference",void 0),(0,c._)([(0,h.Cb)({readOnly:!0,aliasOf:"layerView.layer"})],C.prototype,"layer",void 0),(0,c._)([(0,h.Cb)({readOnly:!0})],C.prototype,"queryGeometryType",null),(0,c._)([(0,h.Cb)({readOnly:!0})],C.prototype,"defaultQueryJSON",null),C=(0,c._)([(0,y.j)("esri.views.3d.layers.graphics.QueryEngine")],C)},99879:function(e,t,i){function n(e,t,i){if(!i||null==t)return null;if(!e)return function(e,t){var i=t.toLowerCase();for(var n in e)if(n.toLowerCase()===i)return e[n];return null}(t,i);var n=e.get(i);return n?t[n.name]:null}i.d(t,{g:function(){return n}})},67581:function(e,t,i){i.d(t,{Z:function(){return b}});var n=i(15671),r=i(43144),s=i(60136),a=i(29388),u=i(27366),o=i(85015),l=i(91505),c=i(41691),d=i(79056),p=i(32718),h=i(92026),y=i(67426),f=i(49861),v=(i(63780),i(93169),i(25243),i(69912)),g=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).layer=null,r.parent=null,r}return(0,r.Z)(i,[{key:"initialize",value:function(){var e=this;this.when().catch((function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";p.Z.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '".concat(n,"', id: '").concat(i,"')"),t)}}))}},{key:"fullOpacity",get:function(){return(0,h.Pt)(this.get("layer.opacity"),1)*(0,h.Pt)(this.get("parent.fullOpacity"),1)}},{key:"suspended",get:function(){return!this.canResume()}},{key:"suspendInfo",get:function(){return this.getSuspendInfo()}},{key:"legendEnabled",get:function(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}},{key:"updating",get:function(){var e;return!((null===(e=this.updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}},{key:"updatingProgress",get:function(){return this.updating?0:1}},{key:"visible",get:function(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}},{key:"canResume",value:function(){var e,t,i;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&!(null!==(t=this.parent)&&void 0!==t&&t.suspended)&&(null===(i=this.view)||void 0===i?void 0:i.ready)||!1}},{key:"getSuspendInfo",value:function(){var e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}},{key:"isUpdating",value:function(){return!1}}]),i}((0,c.p)((0,d.IG)((0,y.v)(l.Z.EventedMixin(o.Z)))));(0,u._)([(0,f.Cb)()],g.prototype,"fullOpacity",null),(0,u._)([(0,f.Cb)()],g.prototype,"layer",void 0),(0,u._)([(0,f.Cb)()],g.prototype,"parent",void 0),(0,u._)([(0,f.Cb)({readOnly:!0})],g.prototype,"suspended",null),(0,u._)([(0,f.Cb)({readOnly:!0})],g.prototype,"suspendInfo",null),(0,u._)([(0,f.Cb)({readOnly:!0})],g.prototype,"legendEnabled",null),(0,u._)([(0,f.Cb)({type:Boolean,readOnly:!0})],g.prototype,"updating",null),(0,u._)([(0,f.Cb)({readOnly:!0})],g.prototype,"updatingProgress",null),(0,u._)([(0,f.Cb)()],g.prototype,"visible",null),(0,u._)([(0,f.Cb)()],g.prototype,"view",void 0);var b=g=(0,u._)([(0,v.j)("esri.views.layers.LayerView")],g)}}]);
//# sourceMappingURL=3409.6533c0cd.chunk.js.map