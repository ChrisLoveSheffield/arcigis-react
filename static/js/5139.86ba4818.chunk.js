"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[5139],{47991:function(e,t,n){n.d(t,{SR:function(){return y},Ui:function(){return d}});var r=n(43144),i=n(15671),a=n(37762),s=n(29439),o=n(92026),u=n(65156),l=n(376),h=n(69662),c=n(77981),f=n(76335),v=n(92975);function d(e){return p(e,!0)}function y(e){return p(e,!1)}function p(e,t){if((0,o.Wi)(e))return null;var n=e.spatialReference,r=(0,v.C5)(n),i="toJSON"in e?e.toJSON():e;if(!r)return i;var a=(0,v.sS)(n)?102100:4326,s=f.UZ[a].maxX,u=f.UZ[a].minX;if((0,c.wp)(i))return _(i,s,u);if((0,c.aW)(i))return i.points=i.points.map((function(e){return _(e,s,u)})),i;if((0,c.YX)(i))return m(i,r);if((0,c.oU)(i)||(0,c.l9)(i)){var h=(0,l.$P)(C,i),d={xmin:h[0],ymin:h[1],xmax:h[2],ymax:h[3]},y=(0,f.XZ)(d.xmin,u)*(2*s),p=0===y?i:(0,f.Sy)(i,y);return d.xmin+=y,d.xmax+=y,d.xmax>s?w(p,s,t):d.xmin<u?w(p,u,t):p}return i}function m(e,t){if(!t)return e;var n=function(e,t){var n=[],r=e.ymin,i=e.ymax,a=e.xmin,o=e.xmax,u=e.xmax-e.xmin,l=(0,s.Z)(t.valid,2),h=l[0],c=l[1],f=x(e.xmin,t),v=f.x,d=f.frameId,y=x(e.xmax,t),p=y.x,m=y.frameId,_=v===p&&u>0;if(u>2*c){var Z={xmin:a<o?v:p,ymin:r,xmax:c,ymax:i},w={xmin:h,ymin:r,xmax:a<o?p:v,ymax:i},C={xmin:0,ymin:r,xmax:c,ymax:i},I={xmin:h,ymin:r,xmax:0,ymax:i},R=[],T=[];g(Z,C)&&R.push(d),g(Z,I)&&T.push(d),g(w,C)&&R.push(m),g(w,I)&&T.push(m);for(var M=d+1;M<m;M++)R.push(M),T.push(M);n.push(new k(Z,[d]),new k(w,[m]),new k(C,R),new k(I,T))}else v>p||_?n.push(new k({xmin:v,ymin:r,xmax:c,ymax:i},[d]),new k({xmin:h,ymin:r,xmax:p,ymax:i},[m])):n.push(new k({xmin:v,ymin:r,xmax:p,ymax:i},[d]));return n}(e,t).map((function(e){return e.extent}));return n.length<2?n[0]||e:n.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:n.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}function _(e,t,n){if(Array.isArray(e)){var r=e[0];if(r>t){var i=(0,f.XZ)(r,t);e[0]=r+i*(-2*t)}else if(r<n){var a=(0,f.XZ)(r,n);e[0]=r+a*(-2*n)}}else{var s=e.x;if(s>t){var o=(0,f.XZ)(s,t);e.x+=o*(-2*t)}else if(s<n){var u=(0,f.XZ)(s,n);e.x+=u*(-2*n)}}return e}function x(e,t){var n,r=(0,s.Z)(t.valid,2),i=r[0],a=r[1],o=2*a,u=0;return e>a?(e-=(n=Math.ceil(Math.abs(e-a)/o))*o,u=n):e<i&&(e+=(n=Math.ceil(Math.abs(e-i)/o))*o,u=-n),{x:e,frameId:u}}function g(e,t){var n=t.xmin,r=t.ymin,i=t.xmax,a=t.ymax;return Z(e,n,r)&&Z(e,n,a)&&Z(e,i,a)&&Z(e,i,r)}function Z(e,t,n){return t>=e.xmin&&t<=e.xmax&&n>=e.ymin&&n<=e.ymax}function w(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(0,c.l9)(e);if(r&&(0,h.Zy)(e),n)return(new I).cut(e,t);for(var i=r?e.rings:e.paths,s=r?4:2,o=i.length,u=-2*t,l=0;l<o;l++){var f=i[l];if(f&&f.length>=s){var v,d=[],y=(0,a.Z)(f);try{for(y.s();!(v=y.n()).done;){var p=v.value;d.push([p[0]+u,p[1]])}}catch(m){y.e(m)}finally{y.f()}i.push(d)}}return r?e.rings=i:e.paths=i,e}var k=(0,r.Z)((function e(t,n){(0,i.Z)(this,e),this.extent=t,this.frameIds=n})),C=(0,u.Ue)(),I=function(){function e(){(0,i.Z)(this,e),this.linesIn=[],this.linesOut=[]}return(0,r.Z)(e,[{key:"cut",value:function(e,t){var n;if(this.xCut=t,e.rings)this.closed=!0,n=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,n=e.paths,this.minPts=2}var r,i=(0,a.Z)(n);try{for(i.s();!(r=i.n()).done;){var s=r.value;if(s&&!(s.length<this.minPts)){var o,u=!0,l=(0,a.Z)(s);try{for(l.s();!(o=l.n()).done;){var h=o.value;u?(this.moveTo(h),u=!1):this.lineTo(h)}}catch(g){l.e(g)}finally{l.f()}this.closed&&this.close()}}}catch(g){i.e(g)}finally{i.f()}this._pushLineIn(),this._pushLineOut(),n=[];var c,f=(0,a.Z)(this.linesIn);try{for(f.s();!(c=f.n()).done;){var v=c.value;v&&v.length>=this.minPts&&n.push(v)}}catch(g){f.e(g)}finally{f.f()}var d,y=-2*this.xCut,p=(0,a.Z)(this.linesOut);try{for(p.s();!(d=p.n()).done;){var m=d.value;if(m&&m.length>=this.minPts){var _,x=(0,a.Z)(m);try{for(x.s();!(_=x.n()).done;){_.value[0]+=y}}catch(g){x.e(g)}finally{x.f()}n.push(m)}}}catch(g){p.e(g)}finally{p.f()}return this.closed?e.rings=n:e.paths=n,e}},{key:"moveTo",value:function(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}},{key:"lineTo",value:function(e){var t=this._side(e[0]);if(t*this._prevSide==-1){var n=this._intersect(this._prevPt,e);this._lineTo(this.xCut,n,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}},{key:"close",value:function(){var e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this.lineIn),this._checkClosingPt(this.lineOut)}},{key:"_moveTo",value:function(e,t,n){this.closed?(this.lineIn.push([n<=0?e:this.xCut,t]),this.lineOut.push([n>=0?e:this.xCut,t])):(n<=0&&this.lineIn.push([e,t]),n>=0&&this.lineOut.push([e,t]))}},{key:"_lineTo",value:function(e,t,n){this.closed?(this._addPolyVertex(this.lineIn,n<=0?e:this.xCut,t),this._addPolyVertex(this.lineOut,n>=0?e:this.xCut,t)):n<0?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([e,t])):n>0?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([e,t])):this._prevSide<0?(this.lineIn.push([e,t]),this.lineOut.push([e,t])):this._prevSide>0&&(this.lineOut.push([e,t]),this.lineIn.push([e,t]))}},{key:"_addPolyVertex",value:function(e,t,n){var r=e.length;r>1&&e[r-1][0]===t&&e[r-2][0]===t?e[r-1][1]=n:e.push([t,n])}},{key:"_checkClosingPt",value:function(e){var t=e.length;t>3&&e[0][0]===this.xCut&&e[t-2][0]===this.xCut&&e[1][0]===this.xCut&&(e[0][1]=e[t-2][1],e.pop())}},{key:"_side",value:function(e){return e<this.xCut?-1:e>this.xCut?1:0}},{key:"_intersect",value:function(e,t){var n=(this.xCut-e[0])/(t[0]-e[0]);return e[1]+n*(t[1]-e[1])}},{key:"_pushLineIn",value:function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn),this.lineIn=[]}},{key:"_pushLineOut",value:function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut),this.lineOut=[]}}]),e}()},84735:function(e,t,n){n.d(t,{L:function(){return p}});var r=n(15671),i=n(43144),a=n(60136),s=n(29388),o=n(27366),u=n(85015),l=n(92026),h=n(49861),c=(n(63780),n(93169),n(25243),n(69912)),f=n(80885),v=n(79803),d=n(65156),y=n(47991),p=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,i.Z)(n,[{key:"bounds",get:function(){var e=this.coords;return(0,l.Wi)(e)?null:(0,d.oJ)(e.extent)}},{key:"coords",get:function(){var e,t=null===(e=(0,l.Wg)(this.element.georeference))||void 0===e?void 0:e.coords;return(0,v.dz)(t,this.spatialReference).geometry}},{key:"normalizedCoords",get:function(){return f.Z.fromJSON((0,y.Ui)(this.coords))}},{key:"normalizedBounds",get:function(){return(0,l.pC)(this.normalizedCoords)?(0,d.oJ)(this.normalizedCoords.extent):null}}]),n}(u.Z);(0,o._)([(0,h.Cb)()],p.prototype,"spatialReference",void 0),(0,o._)([(0,h.Cb)()],p.prototype,"element",void 0),(0,o._)([(0,h.Cb)()],p.prototype,"bounds",null),(0,o._)([(0,h.Cb)()],p.prototype,"coords",null),(0,o._)([(0,h.Cb)()],p.prototype,"normalizedCoords",null),(0,o._)([(0,h.Cb)()],p.prototype,"normalizedBounds",null),p=(0,o._)([(0,c.j)("esri.layers.support.media.MediaElementView")],p)},64510:function(e,t,n){n.d(t,{Z:function(){return V}});var r=n(37762),i=n(15671),a=n(43144),s=n(11752),o=n(61120),u=n(60136),l=n(29388),h=(n(93169),n(92026)),c=n(23588),f=n(53628),v=n(33624),d=n(29439),y=n(10064),p=n(32718),m=n(94172),_=n(87422),x=n(4942),g=n(1413),Z=n(79347),w=n(88396),k=n(6394),C=n(83406),I=n(80457),R=n(73271),T=n(44070),M=n(8548),S=p.Z.getLogger("esri.views.2d.engine.webgl.Mesh2D"),P=function(e,t,n,r){for(var i=0,a=1;a<n;a++){var s=e[2*(t+a-1)],o=e[2*(t+a-1)+1];i+=(e[2*(t+a)]-s)*(e[2*(t+a)+1]+o)}return r?i>0:i<0},b=function(e,t){for(var n=e.coords,i=e.lengths,a=[],s=0,o=0;s<i.length;o+=i[s],s+=1){for(var u=o,l=[];s<i.length-1&&P(n,o+i[s],i[s+1],t);o+=i[s+=1])l.push(o+i[s]-u);var h,c=n.slice(2*u,2*(o+i[s])),f=(0,Z.e)(c,l,2),v=(0,r.Z)(f);try{for(v.s();!(h=v.n()).done;){var d=h.value;a.push(d+u)}}catch(y){v.e(y)}finally{v.f()}}return a},U=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,i.Z)(this,e),this._cache={},this.vertices=t,this.indices=n,this.primitiveType=r,this.isMapSpace=a}return(0,a.Z)(e,[{key:"destroy",value:function(){for(var e in(0,h.pC)(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose(),this._cache.vertexBuffers)(0,h.pC)(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}},{key:"elementType",get:function(){return function(e){switch(e.BYTES_PER_ELEMENT){case 1:return M.g.UNSIGNED_BYTE;case 2:return M.g.UNSIGNED_SHORT;case 4:return M.g.UNSIGNED_INT;default:throw new y.Z("Cannot get DataType of array")}}(this.indices)}},{key:"getIndexBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.l1.STATIC_DRAW;return this._cache.indexBuffer||(this._cache.indexBuffer=T.f.createIndex(e,t,this.indices)),this._cache.indexBuffer}},{key:"getVertexBuffers",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.l1.STATIC_DRAW;return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((function(r,i){return(0,g.Z)((0,g.Z)({},r),{},(0,x.Z)({},i,T.f.createVertex(e,n,t.vertices[i])))}),{})),this._cache.vertexBuffers}}],[{key:"fromRect",value:function(t){var n=t.x,r=t.y,i=n+t.width,a=r+t.height;return e.fromScreenExtent({xmin:n,ymin:r,xmax:i,ymax:a})}},{key:"fromPath",value:function(t){for(var n=(0,C.ks)(new I.Z,t.path,!1,!1),r=n.coords,i=new Uint32Array(b(n,!0)),a=new Uint32Array(r.length/2),s=0;s<a.length;s++)a[s]=(0,R.UJ)(Math.floor(r[2*s]),Math.floor(r[2*s+1]));return new e({geometry:a},i,M.MX.TRIANGLES)}},{key:"fromGeometry",value:function(t,n){var r=n.geometry.type;switch(r){case"polygon":return e.fromPolygon(t,n.geometry);case"extent":return e.fromMapExtent(t,n.geometry);default:return S.error(new y.Z("mapview-bad-type","Unable to create a mesh from type ".concat(r),n)),e.fromRect({x:0,y:0,width:1,height:1})}}},{key:"fromPolygon",value:function(t,n){for(var r=(0,C.Uy)(new I.Z,n,!1,!1),i=r.coords,a=new Uint32Array(b(r,!1)),s=new Uint32Array(i.length/2),o=(0,k.a)(),u=(0,k.a)(),l=0;l<s.length;l++)(0,w.a)(o,i[2*l],i[2*l+1]),t.toScreen(u,o),s[l]=(0,R.UJ)(Math.floor(u[0]),Math.floor(u[1]));return new e({geometry:s},a,M.MX.TRIANGLES,!0)}},{key:"fromScreenExtent",value:function(t){var n=t.xmin,r=t.xmax,i=t.ymin,a=t.ymax;return new e({geometry:new Uint32Array([(0,R.UJ)(n,i),(0,R.UJ)(r,i),(0,R.UJ)(n,a),(0,R.UJ)(n,a),(0,R.UJ)(r,i),(0,R.UJ)(r,a)])},new Uint32Array([0,1,2,3,4,5]),M.MX.TRIANGLES)}},{key:"fromMapExtent",value:function(t,n){var r=t.toScreen([0,0],[n.xmin,n.ymin]),i=(0,d.Z)(r,2),a=i[0],s=i[1],o=t.toScreen([0,0],[n.xmax,n.ymax]),u=(0,d.Z)(o,2),l=u[0],h=u[1];return new e({geometry:new Uint32Array([(0,R.UJ)(a,s),(0,R.UJ)(l,s),(0,R.UJ)(a,h),(0,R.UJ)(a,h),(0,R.UJ)(l,s),(0,R.UJ)(l,h)])},new Uint32Array([0,1,2,3,4,5]),M.MX.TRIANGLES)}}]),e}(),A=n(45412),E=p.Z.getLogger("esri.views.2d.engine.webgl.ClippingInfo"),L=function(e){return parseFloat(e)/100},O=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this))._clip=r,a._cache={},a.stage=e,a._handle=(0,m.YP)((function(){return r.version}),(function(){return a._invalidate()})),a.ready(),a}return(0,a.Z)(n,[{key:"_destroyGL",value:function(){(0,h.pC)(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),(0,h.pC)(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}},{key:"destroy",value:function(){this._destroyGL(),this._handle.remove()}},{key:"getVAO",value:function(e,t,n,r){var i=(0,d.Z)(t.size,2),a=i[0],s=i[1];if("geometry"!==this._clip.type&&this._lastWidth===a&&this._lastHeight===s||(this._lastWidth=a,this._lastHeight=s,this._destroyGL()),(0,h.Wi)(this._cache.vao)){var o=this._createMesh(t,this._clip),u=o.getIndexBuffer(e),l=o.getVertexBuffers(e);this._cache.mesh=o,this._cache.vao=new A.U(e,n,r,l,u)}return this._cache.vao}},{key:"_createTransforms",value:function(){return{dvs:(0,c.c)()}}},{key:"_invalidate",value:function(){this._destroyGL(),this.requestRender()}},{key:"_createScreenRect",value:function(e,t){var n=(0,d.Z)(e.size,2),r=n[0],i=n[1],a="string"==typeof t.left?L(t.left)*r:t.left,s="string"==typeof t.right?L(t.right)*r:t.right,o="string"==typeof t.top?L(t.top)*i:t.top,u="string"==typeof t.bottom?L(t.bottom)*i:t.bottom,l=a,h=o;return{x:l,y:h,width:Math.max(r-s-l,0),height:Math.max(i-u-h,0)}}},{key:"_createMesh",value:function(e,t){switch(t.type){case"rect":return U.fromRect(this._createScreenRect(e,t));case"path":return U.fromPath(t);case"geometry":return U.fromGeometry(e,t);default:return E.error(new y.Z("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),U.fromRect({x:0,y:0,width:1,height:1})}}}],[{key:"fromClipArea",value:function(e,t){return new n(e,t)}}]),n}(_.s),B=n(80613),V=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).name=e.constructor.name,e}return(0,a.Z)(n,[{key:"clips",set:function(e){this._clips=e,this.children.forEach((function(t){return t.clips=e})),this._updateClippingInfo()}},{key:"_createTransforms",value:function(){return{dvs:(0,c.c)()}}},{key:"doRender",value:function(e){var t=this.createRenderParams(e),n=t.painter,r=t.globalOpacity,i=t.profiler,a=t.drawPhase,s=a===B.jx.LABEL||a===B.jx.HIGHLIGHT?1:r*this.computedOpacity;i.recordContainerStart(this.name),n.beforeRenderLayer(t,this._clippingInfos?255:0,s),this.updateTransforms(e.state),this.renderChildren(t),n.compositeLayer(t,s),i.recordContainerEnd()}},{key:"renderChildren",value:function(e){(0,h.Wi)(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));var t,n=(0,r.Z)(this.children);try{for(n.s();!(t=n.n()).done;){t.value.beforeRender(e)}}catch(l){n.e(l)}finally{n.f()}var i,a=(0,r.Z)(this._renderPasses);try{for(a.s();!(i=a.n()).done;){var s=i.value;try{s.render(e)}catch(c){}}}catch(l){a.e(l)}finally{a.f()}var o,u=(0,r.Z)(this.children);try{for(u.s();!(o=u.n()).done;){o.value.afterRender(e)}}catch(l){u.e(l)}finally{u.f()}}},{key:"createRenderParams",value:function(e){return e.requireFBO=this.requiresDedicatedFBO,e}},{key:"prepareRenderPasses",value:function(e){var t=this;return[e.registerRenderPass({name:"clip",brushes:[f.U.clip],target:function(){return t._clippingInfos},drawPhase:B.jx.MAP|B.jx.LABEL|B.jx.LABEL_ALPHA|B.jx.DEBUG|B.jx.HIGHLIGHT})]}},{key:"updateTransforms",value:function(e){var t,n=(0,r.Z)(this.children);try{for(n.s();!(t=n.n()).done;){t.value.setTransform(e)}}catch(i){n.e(i)}finally{n.f()}}},{key:"onAttach",value:function(){(0,s.Z)((0,o.Z)(n.prototype),"onAttach",this).call(this),this._updateClippingInfo()}},{key:"onDetach",value:function(){(0,s.Z)((0,o.Z)(n.prototype),"onDetach",this).call(this),this._updateClippingInfo()}},{key:"_updateClippingInfo",value:function(){var e=this;if((0,h.pC)(this._clippingInfos)&&(this._clippingInfos.forEach((function(e){return e.destroy()})),this._clippingInfos=null),this.stage){var t=this._clips;(0,h.pC)(t)&&t.length&&(this._clippingInfos=t.items.map((function(t){return O.fromClipArea(e.stage,t)}))),this.requestRender()}}}]),n}(v.W)},45139:function(e,t,n){n.r(t),n.d(t,{default:function(){return te}});var r=n(29439),i=n(74165),a=n(15861),s=n(37762),o=n(15671),u=n(43144),l=n(11752),h=n(61120),c=n(60136),f=n(29388),v=n(27366),d=(n(59486),n(80987)),y=n(32718),p=n(77427),m=n(92026),_=n(66978),x=n(94172),g=n(49861),Z=(n(63780),n(93169),n(25243),n(69912)),w=n(65156),k=n(34066),C=n(84735),I=(n(5131),n(37995),n(73828),n(32344)),R=n(85269),T=n(10064),M=n(98928),S=n(16889),P=n(87422),b=n(44070),U=n(8548),A=n(371),E=n(45412),L=n(30308),O=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this)).elementView=e,r.isWrapAround=!1,r._vertices=new Float32Array(20),r._handles=[],r._handles.push((0,x.YP)((function(){return r.elementView.element.opacity}),(function(e){return r.opacity=e}),x.nn),(0,x.YP)((function(){return[r.elementView.coords]}),(function(){r.requestRender()}),x.nn),(0,x.gx)((function(){return r.elementView.element.loaded}),(function(){var e=r.elementView.element;r.ready(),"video"===e.type&&(0,m.pC)(e.content)&&r._handles.push((0,M.on)(e.content,"play",(function(){return r.requestRender()})))}),x.nn)),e.element.load().catch((function(t){y.Z.getLogger("esri.views.2d.layers.MediaLayerView2D").error(new T.Z("element-load-error","Element cannot be displayed",{element:e,error:t}))})),r}return(0,u.Z)(n,[{key:"destroy",value:function(){var e;this._handles.forEach((function(e){return e.remove()})),null!==(e=this.texture)&&void 0!==e&&e.dispose(),this.texture=null}},{key:"dvsMat3",get:function(){return this.parent.dvsMat3}},{key:"beforeRender",value:function(e){var t=e.context,r=this.elementView.element.content;if((0,m.pC)(r)){var i=r instanceof HTMLImageElement,a=r instanceof HTMLVideoElement,s=i?r.naturalWidth:a?r.videoWidth:r.width,o=i?r.naturalHeight:a?r.videoHeight:r.height;this.texture?a&&!r.paused&&(this.texture.setData(r),this.requestRender(),((0,L.Z)(t.gl)||(0,S.wt)(s)&&(0,S.wt)(o))&&this.texture.generateMipmap()):(this.texture=new A.x(t,{pixelFormat:U.VI.RGBA,dataType:U.Br.UNSIGNED_BYTE,samplingMode:U.cw.LINEAR,wrapMode:U.e8.CLAMP_TO_EDGE,width:s,height:o},r),((0,L.Z)(t.gl)||(0,S.wt)(s)&&(0,S.wt)(o))&&this.texture.generateMipmap(),a&&!r.paused&&this.requestRender())}(0,l.Z)((0,h.Z)(n.prototype),"beforeRender",this).call(this,e)}},{key:"_createTransforms",value:function(){return null}},{key:"updateDrawCoords",value:function(e,t){var n=this.elementView.coords;if(!(0,m.Wi)(n)){var i=(0,r.Z)(n.rings[0],4),a=i[0],s=i[1],o=i[2],u=i[3],l=this._vertices,h=e.x,c=e.y,f=0!==t;f?l.set([s[0]-h,s[1]-c,a[0]-h,a[1]-c,o[0]-h,o[1]-c,u[0]-h,u[1]-c,u[0]-h,u[1]-c,s[0]+t-h,s[1]-c,s[0]+t-h,s[1]-c,a[0]+t-h,a[1]-c,o[0]+t-h,o[1]-c,u[0]+t-h,u[1]-c]):l.set([s[0]-h,s[1]-c,a[0]-h,a[1]-c,o[0]-h,o[1]-c,u[0]-h,u[1]-c]),this.isWrapAround=f}}},{key:"getVAO",value:function(e,t,n){if((0,m.Wi)(this.elementView.coords))return null;var r=this._vertices;if(this._vao)this._geometryVbo.setData(r);else{this._geometryVbo=b.f.createVertex(e,U.l1.DYNAMIC_DRAW,r);var i=b.f.createVertex(e,U.l1.STATIC_DRAW,new Uint16Array([0,0,0,1,1,0,1,1,1,1,0,0,0,0,0,1,1,0,1,1]));this._vao=new E.U(e,n,t,{geometry:this._geometryVbo,tex:i})}return this._vao}}]),n}(P.s),B=n(93433),V=n(17842),D=n(22753),W=n(23588),q=n(15245),G=n(8229),J=n(50689),N=n(92975),H=n(86226),j=n(53628),z=n(80613),X=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments))._localOrigin=(0,V.vW)(0,0),e._viewStateId=-1,e._dvsMat3=(0,W.c)(),e.requiresDedicatedFBO=!1,e}return(0,u.Z)(n,[{key:"dvsMat3",get:function(){return this._dvsMat3}},{key:"beforeRender",value:function(e){this._updateMatrices(e),this._updateOverlays(e,this.children);var t,n=(0,s.Z)(this.children);try{for(n.s();!(t=n.n()).done;){t.value.beforeRender(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"prepareRenderPasses",value:function(e){var t=this,r=e.registerRenderPass({name:"overlay",brushes:[j.U.overlay],target:function(){return t.children},drawPhase:z.jx.MAP});return[].concat((0,B.Z)((0,l.Z)((0,h.Z)(n.prototype),"prepareRenderPasses",this).call(this,e)),[r])}},{key:"_updateMatrices",value:function(e){var t=e.state,n=t.id,r=t.size,i=t.pixelRatio,a=t.resolution,s=t.rotation,o=t.viewpoint,u=t.displayMat3;if(this._viewStateId!==n){var l=Math.PI/180*s,h=i*r[0],c=i*r[1],f=o.targetGeometry,v=f.x,d=f.y,y=(0,J.or)(v,t.spatialReference);this._localOrigin.x=y,this._localOrigin.y=d;var p=a*h,m=a*c,_=(0,D.b)(this._dvsMat3);(0,D.m)(_,_,u),(0,D.c)(_,_,(0,q.f)(h/2,c/2)),(0,D.d)(_,_,(0,G.f)(h/p,-c/m,1)),(0,D.r)(_,_,-l),this._viewStateId=n}}},{key:"_updateOverlays",value:function(e,t){var n=e.state,i=n.rotation,a=n.spatialReference,o=n.worldScreenWidth,u=n.size,l=n.viewpoint,h=this._localOrigin,c=0;if(a.isWrappable){var f=u[0],v=u[1],d=180/Math.PI*i,y=Math.abs(Math.cos(d)),p=Math.abs(Math.sin(d)),_=Math.round(f*y+v*p),x=(0,r.Z)((0,N.C5)(a).valid,2),g=x[0],Z=x[1],w=(0,H.ut)(a),k=l.targetGeometry,C=k.x,I=[C,k.y],R=[0,0];n.toScreen(R,I);var T,M=[0,0];T=_>o?.5*o:.5*_;var S=Math.floor((C+.5*w)/w),P=g+S*w,b=Z+S*w,U=[R[0]+T,0];n.toMap(M,U),M[0]>b&&(c=w),U[0]=R[0]-T,n.toMap(M,U),M[0]<P&&(c=-w);var A,E=(0,s.Z)(t);try{for(E.s();!(A=E.n()).done;){var L=A.value,O=L.elementView.bounds;if(!(0,m.Wi)(O)){var B=(0,r.Z)(O,3),V=B[0],D=B[2];V<g&&D>g?L.updateDrawCoords(h,w):D>Z&&V<Z?L.updateDrawCoords(h,-w):L.updateDrawCoords(h,c)}}}catch(G){E.e(G)}finally{E.f()}}else{var W,q=(0,s.Z)(t);try{for(q.s();!(W=q.n()).done;){W.value.updateDrawCoords(h,c)}}catch(G){q.e(G)}finally{q.f()}}}}]),n}(n(64510).Z),Y=n(95986),F=n(67581),Q=n(53866),$=function(e){(0,c.Z)(n,e);var t=(0,f.Z)(n);function n(){var e;return(0,o.Z)(this,n),(e=t.apply(this,arguments))._overlayContainer=null,e._fetchQueue=null,e._tileStrategy=null,e._elementReferences=new Map,e.layer=null,e.elements=new d.Z,e}return(0,u.Z)(n,[{key:"attach",value:function(){var e=this;this.handles.add((0,x.on)((function(){return e.layer.source}),"refresh",(function(){var t,n=(0,s.Z)(e._tileStrategy.tiles);try{for(n.s();!(t=n.n()).done;){var r=t.value;e._updateTile(r)}}catch(i){n.e(i)}finally{n.f()}e.requestUpdate()}))),this._overlayContainer=new X,this.container.addChild(this._overlayContainer),this._fetchQueue=new I.Z({tileInfoView:this.view.featuresTilingScheme,concurrency:10,process:function(t,n){return e._queryElements(t,n)}}),this._tileStrategy=new R.Z({cachePolicy:"purge",resampling:!0,acquireTile:function(t){return e._acquireTile(t)},releaseTile:function(t){return e._releaseTile(t)},tileInfoView:this.view.featuresTilingScheme}),this.requestUpdate()}},{key:"detach",value:function(){this.handles.removeAll(),this.elements.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.destroy(),this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this._elementReferences.clear()}},{key:"supportsSpatialReference",value:function(e){return!0}},{key:"moveStart",value:function(){this.requestUpdate()}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"update",value:function(e){this._tileStrategy.update(e)}},{key:"hitTest",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,u,l,h,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[t.x,t.y],o=(0,s.Z)(this.elements);try{for(o.s();!(u=o.n()).done;)h=u.value,c=null===(l=(0,m.Wg)(h.georeference))||void 0===l?void 0:l.coords,(0,m.pC)(c)&&(0,k.wP)(c.rings,a)&&r.push({type:"media",element:h,layer:this.layer,mapPoint:t})}catch(n){o.e(n)}finally{o.f()}return e.abrupt("return",r.reverse());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){return null!=this.layer.source&&(0,l.Z)((0,h.Z)(n.prototype),"canResume",this).call(this)}},{key:"doRefresh",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_acquireTile",value:function(e){var t=new ee(e.clone());return this._updateTile(t),t}},{key:"_updateTile",value:function(e){var t=this;this.updatingHandles.addPromise(this._fetchQueue.push(e.key).then((function(n){var i=e.setElements(n),a=(0,r.Z)(i,2),s=a[0],o=a[1];t._acquireElements(e,s),t._releaseElements(e,o),t.requestUpdate()}),(function(e){(0,_.D_)(e)||y.Z.getLogger(t.declaredClass).error(e)})))}},{key:"_releaseTile",value:function(e){this._fetchQueue.abort(e.key.id),e.elements&&this._releaseElements(e,e.elements),this.requestUpdate()}},{key:"_queryElements",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.layer.source,!(0,m.Wi)(r)){e.next=3;break}return e.abrupt("return",[]);case 3:return this.view.featuresTilingScheme.getTileBounds(K,t,!0),a=new Q.Z({xmin:K[0],ymin:K[1],xmax:K[2],ymax:K[3],spatialReference:this.view.spatialReference}),e.abrupt("return",r.queryElements(a,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_acquireElements",value:function(e,t){var n=this,r=this.layer.source,i=this.view.spatialReference;if(!(0,m.Wi)(r)){var a,o=(0,s.Z)(t);try{var u=function(){var t=a.value;(0,p.s1)(n._elementReferences,t.uid,(function(){var e=new C.L({element:t,spatialReference:i}),r=new O(e);return n._overlayContainer.addChild(r),n.elements.add(t),{tiles:new Set,projectedElement:e,overlay:r}})).tiles.add(e)};for(o.s();!(a=o.n()).done;)u()}catch(l){o.e(l)}finally{o.f()}}}},{key:"_releaseElements",value:function(e,t){var n,r=(0,s.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=this._elementReferences.get(i.uid);a.tiles.delete(e),a.tiles.size||(this._overlayContainer.removeChild(a.overlay),a.overlay.destroy(),a.projectedElement.destroy(),this._elementReferences.delete(i.uid),this.elements.remove(i))}}catch(o){r.e(o)}finally{r.f()}}}]),n}((0,Y.y)(F.Z));(0,v._)([(0,g.Cb)()],$.prototype,"_fetchQueue",void 0),(0,v._)([(0,g.Cb)()],$.prototype,"layer",void 0),(0,v._)([(0,g.Cb)({readOnly:!0})],$.prototype,"elements",void 0),$=(0,v._)([(0,Z.j)("esri.views.2d.layers.MediaLayerView2D")],$);var K=(0,w.Ue)(),ee=function(){function e(t){(0,o.Z)(this,e),this.key=t,this.elements=null,this.isReady=!1,this.visible=!0}return(0,u.Z)(e,[{key:"setElements",value:function(e){var t=[],n=new Set(this.elements);this.elements=e;var r,i=(0,s.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.has(a)?n.delete(a):t.push(a)}}catch(o){i.e(o)}finally{i.f()}return this.isReady=!0,[t,Array.from(n)]}}]),e}(),te=$}}]);
//# sourceMappingURL=5139.86ba4818.chunk.js.map