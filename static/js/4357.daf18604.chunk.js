"use strict";(self.webpackChunkuums_front_end=self.webpackChunkuums_front_end||[]).push([[4357],{54357:function(e,t,n){n.r(t),n.d(t,{SceneLayerSnappingSourceWorker:function(){return b},default:function(){return y}});var i=n(37762),r=n(74165),o=n(15861),s=n(15671),a=n(43144),u=n(27366),c=n(92026),d=n(66978),h=(n(32718),n(25243),n(63780),n(93169),n(75366),n(69912)),p=n(11186),f=n(71353),v=n(85981),m=n(23470),g=n(92536),l=n(78329),_=n(13475),b=function(){function e(){(0,s.Z)(this,e),this._idToComponent=new Map,this._components=new l.Z((function(e){return e.bounds})),this._edges=new l.Z((function(e){return e.bounds})),this._tmpLineSegment=(0,v.Ue)(),this._tmpP1=(0,f.c)(),this._tmpP2=(0,f.c)(),this._tmpP3=(0,f.c)(),this.remoteClient=null}return(0,a.Z)(e,[{key:"fetchCandidates",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:return(0,d.k_)(n),e.next=5,this._ensureEdgeLocations(t,n);case 5:return i=[],e.abrupt("return",(this._edges.forEachNeighbor((function(e){return o._addCandidates(t,e,i)}),t.bounds),{result:{candidates:i}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_ensureEdgeLocations",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var o,s,a,u,d,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=[],this._components.forEachNeighbor((function(e){if((0,c.Wi)(e.info)){var t=e.id,n=e.uid;o.push({id:t,uid:n})}}),t.bounds),o.length){e.next=3;break}return e.abrupt("return");case 3:return s={components:o},e.next=6,this.remoteClient.invoke("fetchAllEdgeLocations",s,(0,c.Pt)(n,{}));case 6:a=e.sent,u=(0,i.Z)(a.components);try{for(u.s();!(d=u.n()).done;)h=d.value,this._setFetchEdgeLocations(h)}catch(r){u.e(r)}finally{u.f()}case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new k(t.id,t.bounds),e.abrupt("return",(this._idToComponent.set(n.id,n),this._components.add([n]),{result:{}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this._idToComponent.get(t.id))&&(i=[],this._edges.forEachNeighbor((function(e){e.component===n&&i.push(e)}),n.bounds),this._edges.remove(i),this._components.remove([n]),this._idToComponent.delete(n.id)),e.abrupt("return",{result:{}});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_setFetchEdgeLocations",value:function(e){var t=this._idToComponent.get(e.id);if(!(0,c.Wi)(t)&&e.uid===t.uid){for(var n=_.extractComponentsEdgeLocationsLayout.createView(e.locations),i=new Array(n.count),r=(0,f.c)(),o=(0,f.c)(),s=0;s<n.count;s++){var a=(0,m.c)(),u=(0,m.g)(a);n.position0.getVec(s,r),n.position1.getVec(s,o),(0,p.C)(u,u,r,.5),(0,p.C)(u,u,o,.5),(0,p.a)(u,u,e.origin),a[3]=(0,p.i)(u,r);var d=new Z(t,s,a);i[s]=d}this._edges.add(i);var h=e.objectIds,v=e.origin;t.info={locations:n,objectIds:h,origin:v}}}},{key:"_addCandidates",value:function(e,t,n){var i=t.component.info,r=i.locations,o=i.origin,s=i.objectIds,a=r.position0.getVec(t.index,this._tmpP1),u=r.position1.getVec(t.index,this._tmpP2);(0,p.a)(a,a,o),(0,p.a)(u,u,o);var c=s[r.componentIndex.get(t.index)];this._addEdgeCandidate(e,c,a,u,n),this._addVertexCandidate(e,c,a,n),this._addVertexCandidate(e,c,u,n)}},{key:"_addEdgeCandidate",value:function(e,t,n,i,r){if(e.types&g.r.EDGE){var o=(0,m.g)(e.bounds),s=(0,v.zk)(n,i,this._tmpLineSegment),a=(0,v.nF)(s,o,this._tmpP3);if(!(0,m.m)(e.bounds,a))return null;r.push({type:"edge",objectId:t,target:(0,f.a)(a),distance:(0,p.i)(o,a),start:(0,f.a)(n),end:(0,f.a)(i)})}}},{key:"_addVertexCandidate",value:function(e,t,n,i){if(e.types&g.r.VERTEX){var r=(0,m.g)(e.bounds);if(!(0,m.m)(e.bounds,n))return null;i.push({type:"vertex",objectId:t,target:(0,f.a)(n),distance:(0,p.i)(r,n)})}}}]),e}();function y(){return new b}b=(0,u._)([(0,h.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],b);var k=(0,a.Z)((function e(t,n){(0,s.Z)(this,e),this.id=t,this.bounds=n,this.info=null,this.uid=++e.uid}));k.uid=0;var Z=(0,a.Z)((function e(t,n,i){(0,s.Z)(this,e),this.component=t,this.index=n,this.bounds=i}))}}]);
//# sourceMappingURL=4357.daf18604.chunk.js.map